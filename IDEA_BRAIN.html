<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><span class=\"ib-logo\">IDEA BRAIN</span></title>

  <!-- Fonts (Noto Sans KR only) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">

  <style>
    /* ==== Design Tokens ==== */
    :root{
      --font-family:'Noto Sans KR','Noto Sans KR',sans-serif;
      --fs-12:.75rem;--fs-13:.8125rem;--fs-14:.875rem;--fs-16:1rem;--fs-18:1.125rem;--fs-22:1.375rem;--fs-28:1.75rem;
      --r-xs:10px;--r-sm:12px;--r-md:14px;--r-lg:16px;--r-xl:20px;
      --sp-4:.25rem;--sp-6:.375rem;--sp-8:.5rem;--sp-10:.625rem;--sp-12:.75rem;--sp-14:.875rem;--sp-16:1rem;--sp-20:1.25rem;--sp-24:1.5rem;
      --bg:#0b0b0c;--bg-elev:#121316;--text:#e5e7eb;--muted:#9aa3b2;--hairline:rgba(255,255,255,.06);
      --card:linear-gradient(180deg,rgba(24,26,31,.86),rgba(16,18,22,.86));--glass:blur(18px);
      --accent-1:#6d79ff;--accent-2:#8a5cff;--accent-3:#f093fb;--accent-grad:linear-gradient(135deg,var(--accent-1),var(--accent-2) 55%,var(--accent-3));
      --shadow-sm:0 4px 14px rgba(0,0,0,.25);--shadow-md:0 10px 24px rgba(0,0,0,.28);--shadow-lg:0 18px 40px rgba(0,0,0,.32);
      --ctl-40:40px;--ctl-48:48px;--fab:56px;--ease:cubic-bezier(.4,0,.2,1);--dur-1:.18s;--dur-2:.28s;--dur-3:.44s;
      --ico-stroke:2;--ico-size:20px;
      --skip-bg:#000;--skip-bd:#000;--skip-fg:#fff;
    }
    html.light{
      --bg:#f8f9fb;--bg-elev:rgba(255,255,255,.92);--text:#1c212b;--muted:#697386;--hairline:rgba(0,0,0,.08);
      --card:linear-gradient(180deg,rgba(255,255,255,.98),rgba(248,249,252,.95));
    }
    @media(prefers-color-scheme:light){
      :root:not(.light):not(.dark){
        --bg:#f8f9fb;--bg-elev:rgba(255,255,255,.92);--text:#1c212b;--muted:#697386;--hairline:rgba(0,0,0,.08);
        --card:linear-gradient(180deg,rgba(255,255,255,.98),rgba(248,249,252,.95));
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:400 var(--fs-14)/1.55 var(--font-family);color:var(--text);background:var(--bg);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    :where(html,body,header,main,nav,section,article,div,span,a,strong,em,small,mark,h1,h2,h3,h4,h5,h6,p,ul,ol,li,dl,dt,dd,table,th,td,caption,blockquote,code,pre,figure,figcaption,button,input,textarea,select,label,.btn,.vbtn,.gnb-btn,.icon-btn,.brand,.splash-logo,.splash-sub,.cal-title,.cal-dow,.cal-day,.meta,.tag){font-family:var(--font-family) !important}
    ::placeholder{font-family:var(--font-family)}
    .ql-snow *{font-family:var(--font-family) !important}

    .ico{width:var(--ico-size);height:var(--ico-size);stroke:currentColor;stroke-width:var(--ico-stroke);fill:none;stroke-linecap:round;stroke-linejoin:round;display:inline-block}

    header{position:sticky;top:0;z-index:50;backdrop-filter:var(--glass);background:color-mix(in srgb,var(--bg-elev) 88%,transparent);border-bottom:1px solid var(--hairline);transition:transform .3s var(--ease)}
    header.scrolled{transform:translateY(-2px);box-shadow:var(--shadow-md)}
    .wrap{max-width:1040px;margin:0 auto;padding:var(--sp-12) var(--sp-16)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:var(--sp-10)}
    .brand{font-weight:900;letter-spacing:-.035em;line-height:1;font-size:clamp(2.2rem,4.4vw,2.7rem);background:var(--accent-grad);-webkit-background-clip:text;background-clip:text;color:transparent;transition:all .3s cubic-bezier(.34,1.56,.64,1);cursor:pointer;position:relative}
    .brand::after{content:'';position:absolute;inset:0;background:var(--accent-grad);opacity:0;filter:blur(12px);transition:opacity .3s ease;z-index:-1}
    .brand:hover{filter:brightness(1.15);transform:scale(1.02)}
    .brand:hover::after{opacity:.3}
    .brand:active{transform:scale(.98)}
    .brand-wrap{display:flex;flex-direction:column;line-height:1}
    .brand-sub{margin-top:2px;font-weight:900;letter-spacing:.08em;font-size:11px;text-transform:uppercase;color:color-mix(in srgb,var(--muted) 85%, transparent)}
    html.dark .brand-sub{color:rgba(226,232,240,.88)}
    .brand-sub.logo{color:#fff;letter-spacing:.09em;opacity:.96;text-shadow:0 1px 0 rgba(0,0,0,.12)}
    .toolbar{display:flex;align-items:center;gap:var(--sp-8)}
    .icon-btn{width:40px;height:40px;display:inline-flex;align-items:center;justify-content:center;border:none;border-radius:50%;background:color-mix(in srgb,var(--bg-elev) 95%,transparent);transition:all .25s cubic-bezier(.2,.8,.2,1);cursor:pointer;color:var(--muted);position:relative;overflow:hidden}
    .icon-btn::before{content:'';position:absolute;inset:0;background:color-mix(in srgb,var(--accent-1) 12%,transparent);opacity:0;transition:all .25s cubic-bezier(.2,.8,.2,1);border-radius:50%;transform:scale(.7)}
    .icon-btn .ico{transition:all .25s cubic-bezier(.2,.8,.2,1);position:relative;z-index:1;stroke-width:2}
    .icon-btn:hover{color:var(--accent-1);transform:scale(1.08)}
    .icon-btn:hover::before{opacity:1;transform:scale(1)}
    .icon-btn:active{transform:scale(.92)}
    .icon-btn:active::before{transform:scale(.9)}
    html.dark .icon-btn,html.dark .cal-btn{background:rgba(255,255,255,.08);color:rgba(255,255,255,.7)}
    html.light .icon-btn,html.light .cal-btn{background:rgba(0,0,0,.06);color:rgba(0,0,0,.6)}
    html.dark .icon-btn:hover,html.light .icon-btn:hover{color:var(--accent-1)}
    .icon-btn:focus-visible,.cal-btn:focus-visible,.vbtn:focus-visible,.btn:focus-visible{outline:3px solid color-mix(in srgb,var(--accent-1) 45%,transparent);outline-offset:2px}

    /* Search - Enhanced */
    .search{margin-top:var(--sp-10);position:relative}
    .search input{width:100%;height:var(--ctl-48);background:color-mix(in srgb,var(--bg-elev) 85%,transparent);border:1px solid var(--hairline);border-radius:var(--r-lg);padding:0 var(--sp-16) 0 48px;color:var(--text);outline:none;transition:all var(--dur-2) var(--ease)}
    .search input:focus{box-shadow:0 0 0 4px color-mix(in srgb,var(--accent-1) 18%,transparent),0 8px 24px rgba(0,0,0,.15);border-color:color-mix(in srgb,var(--accent-1) 38%,var(--hairline));transform:translateY(-1px)}
    .search-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);pointer-events:none;color:var(--muted);transition:color .2s var(--ease)}
    .search input:focus ~ .search-icon{color:var(--accent-1)}
    .search-results{position:absolute;left:0;right:0;top:calc(100% + 8px);background:var(--card);border:1px solid var(--hairline);border-radius:16px;box-shadow:var(--shadow-lg);display:none;max-height:50vh;overflow:auto;animation:slideDown .2s var(--ease)}
    @keyframes slideDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
    .search-item{display:flex;align-items:center;gap:.6rem;padding:.8rem 1rem;cursor:pointer;transition:all .15s var(--ease);border-radius:12px;margin:4px}
    .search-item:hover{background:color-mix(in srgb,var(--accent-1) 12%,transparent);transform:translateX(4px)}
    .search-empty{padding:1.5rem;color:var(--muted);font-size:var(--fs-13);text-align:center} 
    mark{background:color-mix(in srgb,var(--accent-2) 25%,transparent);color:inherit;padding:2px 4px;border-radius:4px}

    .viewbar{display:flex;gap:var(--sp-6);margin:var(--sp-12) 0 var(--sp-16);padding:var(--sp-4);border-radius:var(--r-lg);background:color-mix(in srgb,var(--bg-elev) 90%,transparent);width:max-content;box-shadow:0 2px 8px rgba(0,0,0,.08)}
    .vbtn{display:flex;align-items:center;gap:var(--sp-6);border:none;border-radius:var(--r-md);padding:var(--sp-8) var(--sp-14);font-weight:800;cursor:pointer;transition:all .25s cubic-bezier(.2,.8,.2,1);color:var(--accent-1);position:relative;overflow:hidden;background:transparent}
    .vbtn::before{content:'';position:absolute;inset:0;background:var(--accent-grad);opacity:0;transition:all .25s cubic-bezier(.2,.8,.2,1);border-radius:var(--r-md)}
    html.dark .vbtn{color:var(--accent-1)}
    html.light .vbtn{color:var(--accent-1)}
    .vbtn .ico{transition:all .25s cubic-bezier(.2,.8,.2,1);position:relative;z-index:1;fill:currentColor}
    .vbtn:hover:not(.active){transform:scale(1.02)}
    .vbtn:hover:not(.active) .ico{transform:scale(1.1)}
    .vbtn:active:not(.active){transform:scale(.95)}
    .vbtn.active{color:#fff;transform:scale(1)}
    .vbtn.active::before{opacity:1}
    .vbtn.active .ico{transform:scale(1);fill:#fff}

    main{max-width:1040px;margin:0 auto;padding:var(--sp-16);padding-bottom:8.5rem}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--sp-16)}
    .list{display:flex;flex-direction:column;gap:var(--sp-16)}

    .card{background:var(--card);border:1px solid var(--hairline);border-radius:var(--r-xl);padding:var(--sp-16);box-shadow:var(--shadow-md);transition:all var(--dur-2) var(--ease);cursor:pointer;position:relative;overflow:hidden}
    .card::before{content:'';position:absolute;inset:0;background:var(--accent-grad);opacity:0;transition:opacity .3s var(--ease)}
    .card:hover::before{opacity:.03}
    .card:hover{transform:translateY(-6px) scale(1.01);box-shadow:var(--shadow-lg),0 0 0 1px color-mix(in srgb,var(--accent-1) 20%,transparent)}
    .card:active{transform:translateY(-2px) scale(.99)}
    .thumb{overflow:hidden;border-radius:var(--r-lg);margin-bottom:var(--sp-12);position:relative}
    .thumb::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 60%,rgba(0,0,0,.3));pointer-events:none}
    .thumb img{width:100%;height:200px;object-fit:cover;display:block;transition:transform .4s var(--ease)}
    .card:hover .thumb img{transform:scale(1.05)}
    .title{font-size:var(--fs-18);font-weight:900;letter-spacing:-.02em;margin-bottom:var(--sp-10);position:relative;z-index:1}
    .preview{color:var(--muted);font-size:var(--fs-13);line-height:1.6;margin-bottom:var(--sp-12);position:relative;z-index:1}
    .meta{display:flex;gap:var(--sp-14);color:var(--muted);font-size:var(--fs-12);font-weight:600;position:relative;z-index:1}

    .tags{display:flex;flex-wrap:wrap;gap:var(--sp-8);margin-bottom:var(--sp-12)}
    .tag{display:inline-flex;align-items:center;gap:var(--sp-6);padding:var(--sp-6) var(--sp-10);border-radius:var(--r-sm);border:1px solid var(--hairline);background:color-mix(in srgb,var(--accent-1) 8%,transparent);color:inherit;font-weight:700;font-size:var(--fs-12);transition:all var(--dur-1) var(--ease);position:relative;z-index:1}
    .tag:hover{transform:translateY(-2px);background:color-mix(in srgb,var(--accent-1) 15%,transparent);box-shadow:var(--shadow-sm)}

    .cal-card{background:var(--card);border:1px solid var(--hairline);border-radius:var(--r-xl);padding:var(--sp-16);box-shadow:var(--shadow-md)}
    .cal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:var(--sp-14)}
    .cal-title{font-size:var(--fs-18);font-weight:900;letter-spacing:-.02em}
    .cal-btn{width:40px;height:40px;border-radius:50%;border:none;background:color-mix(in srgb,var(--bg-elev) 95%,transparent);color:var(--muted);cursor:pointer;transition:all .25s cubic-bezier(.2,.8,.2,1);display:inline-flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .cal-btn::before{content:'';position:absolute;inset:0;background:color-mix(in srgb,var(--accent-1) 12%,transparent);opacity:0;transition:all .25s cubic-bezier(.2,.8,.2,1);border-radius:50%;transform:scale(.7)}
    .cal-btn:hover{color:var(--accent-1);transform:scale(1.08)}
    .cal-btn:hover::before{opacity:1;transform:scale(1)}
    .cal-btn:active{transform:scale(.92)}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:var(--sp-8)}
    .cal-dow{text-align:center;font-weight:700;font-size:var(--fs-12);color:var(--muted);padding:var(--sp-8)}
    .cal-day{aspect-ratio:1;display:flex;align-items:center;justify-content:center;border-radius:var(--r-sm);cursor:pointer;font-weight:700;transition:all var(--dur-1) var(--ease);position:relative}
    .cal-day::before{content:'';position:absolute;inset:0;background:var(--accent-grad);border-radius:var(--r-sm);opacity:0;transition:opacity .2s var(--ease)}
    .cal-day:hover::before{opacity:.12}
    .cal-day:hover{transform:scale(1.12)}
    .cal-day:active{transform:scale(.95)}
    .has-idea{background:var(--accent-grad);color:#fff;box-shadow:var(--shadow-sm)}
    .has-idea::before{opacity:.2}

    .empty{text-align:center;padding:4.5rem 1rem;color:var(--muted);animation:fadeInUp .5s var(--ease)}
    @keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .empty .ico{font-size:3.75rem;background:var(--accent-grad);-webkit-background-clip:text;background-clip:text;color:transparent;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:.8;transform:scale(1)}50%{opacity:1;transform:scale(1.05)}}
    .empty h3{font-size:var(--fs-18);color:var(--text);margin:var(--sp-10) 0 var(--sp-8)}

    /* iOS Style Bottom Navigation - Clean & Minimal */
    .gnb{position:fixed;left:0;right:0;bottom:0;z-index:60;backdrop-filter:saturate(180%) blur(20px);background:linear-gradient(135deg,#6d79ff,#8a5cff 55%,#b06bff);border-top:1px solid rgba(255,255,255,.15);padding:calc(env(safe-area-inset-bottom) + 8px) 0 8px;box-shadow:0 -4px 24px rgba(109,121,255,.4)}
    .gnb-inner{max-width:1040px;margin:0 auto;display:flex;justify-content:space-around;align-items:center;gap:8px;padding:0 16px}
    .gnb-btn{min-width:56px;height:56px;display:flex;align-items:center;justify-content:center;border:none;border-radius:14px;background:transparent;cursor:pointer;transition:all .25s cubic-bezier(.2,.8,.2,1);position:relative;padding:0;flex:1;max-width:72px}
    .gnb-btn::before{content:'';position:absolute;inset:6px;background:rgba(255,255,255,.15);border-radius:10px;opacity:0;transform:scale(.8);transition:all .25s cubic-bezier(.2,.8,.2,1)}
    .gnb-btn-add::before{background:rgba(255,255,255,.25)}
    .gnb-ico{width:28px;height:28px;transition:all .25s cubic-bezier(.2,.8,.2,1);position:relative;z-index:1;color:rgba(255,255,255,.75)}
    .gnb-btn .label{display:none}
    .gnb-btn:active{transform:scale(.92)}
    .gnb-btn:active::before{transform:scale(.88)}
    .gnb-btn:active .gnb-ico{transform:scale(.88)}
    .gnb-btn.active::before{opacity:1;transform:scale(1)}
    .gnb-btn.active .gnb-ico{color:#fff;transform:scale(1.05);filter:drop-shadow(0 2px 8px rgba(0,0,0,.3))}
    .gnb-btn-add.active .gnb-ico{color:#fff}
    html.dark .gnb{background:linear-gradient(135deg,#6d79ff,#8a5cff 55%,#b06bff);border-top-color:rgba(255,255,255,.15)}
    html.light .gnb{background:linear-gradient(135deg,#6d79ff,#8a5cff 55%,#b06bff);border-top-color:rgba(255,255,255,.15)}
    html.dark .gnb-ico{color:rgba(255,255,255,.75)}
    html.light .gnb-ico{color:rgba(255,255,255,.75)}
    html.dark .gnb-btn.active .gnb-ico{color:#fff}
    html.light .gnb-btn.active .gnb-ico{color:#fff}
    @media (hover: hover){
      .gnb-btn:hover:not(.active)::before{opacity:.6;transform:scale(.95)}
      .gnb-btn:hover:not(.active) .gnb-ico{color:rgba(255,255,255,.95);transform:scale(1.12)}
    }

    /* Drag preview toast - Enhanced */
    .drag-toast{position:fixed;top:0;left:0;transform:translate(-9999px,-9999px);pointer-events:none;padding:10px 14px;border-radius:14px;background:var(--card);border:1px solid var(--hairline);box-shadow:var(--shadow-lg);font-size:12px;display:flex;align-items:center;gap:10px;z-index:70;backdrop-filter:blur(12px)}
    .drag-toast .tt{font-weight:800}
    .drag-toast .tg{opacity:.75;padding:2px 8px;background:color-mix(in srgb,var(--accent-1) 15%,transparent);border-radius:6px}

    /* iOS Style FAB */
    .fab{position:fixed;right:1.5rem;bottom:5.5rem;width:56px;height:56px;border-radius:50%;background:var(--accent-grad);color:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 24px rgba(109,121,255,.35);cursor:pointer;transition:all .25s cubic-bezier(.2,.8,.2,1);border:none;z-index:55}
    .fab:hover{transform:scale(1.12);box-shadow:0 12px 32px rgba(109,121,255,.45)}
    .fab:active{transform:scale(.95)}
    .fab .ico{transition:all .25s cubic-bezier(.2,.8,.2,1);position:relative;z-index:2}
    .fab:hover .ico{transform:rotate(90deg)}
    .fab:active .ico{transform:rotate(135deg) scale(.9)}

    /* Modal & Overlay - Enhanced */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(8px);display:none;align-items:flex-start;justify-content:center;padding:var(--sp-16);z-index:1000;overflow:auto;animation:fadeIn .3s var(--ease)}
    .modal{width:min(760px,100%);max-height:100dvh;background:var(--card);border:1px solid var(--hairline);border-radius:24px;box-shadow:var(--shadow-lg);display:flex;flex-direction:column;overflow:hidden;animation:modalSlideUp .3s var(--ease)}
    @keyframes modalSlideUp{from{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}
    .modal-head{position:sticky;top:0;z-index:1;display:flex;align-items:center;justify-content:space-between;padding:var(--sp-16) var(--sp-20);border-bottom:1px solid var(--hairline);background:inherit;backdrop-filter:blur(8px)}
    .modal-title{font-size:var(--fs-18);font-weight:900;letter-spacing:-.02em}
    .modal-body{padding:var(--sp-20);overflow:auto;-webkit-overflow-scrolling:touch}
    .modal-actions{position:sticky;bottom:0;display:flex;gap:var(--sp-12);padding:var(--sp-16) var(--sp-20);background:linear-gradient(180deg,color-mix(in srgb,var(--bg-elev) 90%,transparent),color-mix(in srgb,var(--bg-elev) 98%,transparent));border-top:1px solid var(--hairline)}
    .label{display:block;margin-bottom:var(--sp-8);font-weight:800;font-size:var(--fs-13);color:var(--muted);letter-spacing:.02em}
    .input,.drop{width:100%;min-height:var(--ctl-48);border-radius:var(--r-lg);padding:0 var(--sp-16);background:color-mix(in srgb,var(--bg-elev) 85%,transparent);border:1px solid var(--hairline);color:var(--text);outline:none;transition:all var(--dur-2) var(--ease)}
    .input:focus,.drop:focus{box-shadow:0 0 0 4px color-mix(in srgb,var(--accent-1) 16%,transparent);border-color:color-mix(in srgb,var(--accent-1) 38%,var(--hairline));transform:translateY(-1px)}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:var(--sp-8);padding:var(--sp-12) var(--sp-16);border-radius:var(--r-lg);font-weight:800;cursor:pointer;border:1px solid transparent;transition:all .2s var(--ease);position:relative;overflow:hidden}
    .btn::before{content:'';position:absolute;inset:0;background:rgba(255,255,255,.15);opacity:0;transition:opacity .2s var(--ease)}
    .btn:hover::before{opacity:1}
    .btn:active{transform:scale(.97)}
    .btn-primary{background:var(--accent-grad);color:#fff;box-shadow:var(--shadow-md)}
    .btn-primary:hover{box-shadow:var(--shadow-lg)}
    .btn-ghost{background:transparent;color:var(--muted);border-color:var(--hairline)}
    .btn-ghost:hover{background:color-mix(in srgb,var(--bg-elev) 95%,transparent);color:var(--text)}
    .btn-danger{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;box-shadow:var(--shadow-md)}
    .btn-danger:hover{box-shadow:0 8px 24px rgba(239,68,68,.4)}

    html.dark .modal{border-color:rgba(255,255,255,.85)} html.dark .modal-head{border-bottom-color:rgba(255,255,255,.6)}

    #editor{min-height:300px;border-radius:var(--r-lg);overflow:hidden}
    .ql-toolbar.ql-snow{border:none !important;border-bottom:1px solid var(--hairline) !important;border-radius:var(--r-lg) var(--r-lg) 0 0 !important;background:color-mix(in srgb,var(--bg-elev) 92%,transparent) !important;padding:var(--sp-12) !important;display:flex;flex-wrap:wrap;gap:4px}
    .ql-toolbar.ql-snow .ql-formats{margin-right:8px !important;margin-bottom:4px}
    .ql-container.ql-snow{border:none !important;border-radius:0 0 var(--r-lg) var(--r-lg) !important;background:color-mix(in srgb,var(--bg-elev) 95%,transparent) !important}
    .ql-editor{font-family:var(--font-family) !important;font-size:var(--fs-14);line-height:1.6;color:var(--text);padding:var(--sp-16) !important;min-height:300px}
    .ql-snow .ql-picker{color:var(--text) !important}
    .ql-snow .ql-stroke{stroke:var(--text) !important}
    .ql-snow .ql-fill{fill:var(--text) !important}
    .ql-snow .ql-picker-options{background:var(--bg-elev) !important;border:1px solid var(--hairline) !important;border-radius:8px !important;box-shadow:var(--shadow-lg) !important}
    .ql-snow .ql-picker-item:hover,.ql-snow .ql-picker-item.ql-selected{color:var(--accent-1) !important}
    .ql-snow.ql-toolbar button:hover,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar button.ql-active,.ql-snow .ql-toolbar button.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item.ql-selected{color:var(--accent-1) !important}
    .ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter{stroke:var(--accent-1) !important}
    .ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill{fill:var(--accent-1) !important}
    .ql-editor table{border-collapse:collapse;width:100%;margin:12px 0}
    .ql-editor table td,.ql-editor table th{border:1px solid var(--hairline);padding:8px;min-width:50px}
    .ql-editor table th{background:color-mix(in srgb,var(--accent-1) 10%,transparent);font-weight:700}
    .ql-editor table tr:hover{background:color-mix(in srgb,var(--accent-1) 5%,transparent)}
    .ql-editor hr{border:none;border-top:2px solid var(--hairline);margin:20px 0;opacity:.6}
    .ql-editor pre.ql-syntax{background:color-mix(in srgb,var(--bg-elev) 95%,transparent) !important;color:var(--text) !important;border-radius:8px;padding:12px;overflow-x:auto;border:1px solid var(--hairline)}
    .ql-editor blockquote{border-left:4px solid var(--accent-1);padding-left:16px;margin:12px 0;color:var(--muted);font-style:italic}
    .ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{font-weight:900;margin:16px 0 8px;line-height:1.3}
    .ql-editor h1{font-size:2em;color:var(--text)}
    .ql-editor h2{font-size:1.5em;color:var(--text)}
    .ql-editor h3{font-size:1.25em;color:var(--text)}
    .ql-editor img{max-width:100%;height:auto;border-radius:8px;margin:12px 0;box-shadow:var(--shadow-sm)}
    .ql-editor .ql-video{width:100%;height:400px;border-radius:8px;box-shadow:var(--shadow-sm)}
    .ql-editor ul,.ql-editor ol{padding-left:1.5em}
    .ql-editor li{margin:4px 0}
    .ql-editor .ql-align-center{text-align:center}
    .ql-editor .ql-align-right{text-align:right}
    .ql-editor .ql-align-justify{text-align:justify}

    @media (prefers-reduced-motion:reduce){*{animation:none !important;transition-duration:.01ms !important}}

    /* DnD states - Enhanced */
    .card[draggable="true"]{cursor:grab}
    .card[draggable="true"]:active{cursor:grabbing;opacity:.8}
    .cal-day.drop-hover{outline:3px dashed color-mix(in srgb,var(--accent-1) 55%, transparent); outline-offset:2px;transform:scale(1.08);background:color-mix(in srgb,var(--accent-1) 10%,transparent)}
    .cal-day.drop-success{animation:dropSuccess .7s var(--ease)}
    @keyframes dropSuccess{
      0%{box-shadow:0 0 0 0 rgba(109,121,255,.7);background:var(--accent-grad);transform:scale(1)}
      50%{box-shadow:0 0 0 12px rgba(109,121,255,.0);transform:scale(1.15)}
      100%{box-shadow:0 0 0 0 rgba(109,121,255,.0);transform:scale(1)}
    }

    /* Enhanced Splash Screen */
    .splash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:10000;overflow:hidden;background:linear-gradient(135deg,#5b2cff,#b06bff 60%,#f093fb);animation:splashFadeIn var(--dur-3) var(--ease)}
    .splash.hide{opacity:0;pointer-events:none;transition:opacity .6s var(--ease)}
    .splash::before,.splash::after{content:"";position:absolute;width:600px;height:600px;background:radial-gradient(circle,rgba(255,255,255,.2),transparent 70%);border-radius:50%;filter:blur(40px);animation:orbit 15s linear infinite}
    .splash::before{top:-10%;left:-10%}
    .splash::after{bottom:-10%;right:-10%;animation-duration:20s;animation-direction:reverse}
    @keyframes orbit{0%{transform:translate(0,0) rotate(0deg)}25%{transform:translate(50px,50px) rotate(90deg)}50%{transform:translate(0,100px) rotate(180deg)}75%{transform:translate(-50px,50px) rotate(270deg)}100%{transform:translate(0,0) rotate(360deg)}}
    @keyframes splashFadeIn{from{opacity:0}to{opacity:1}}
    @keyframes subfade{from{opacity:0;transform:translateY(8px)}to{opacity:.95;transform:none}}
    .splash-card{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;animation:splashZoom .8s var(--ease)}
    @keyframes splashZoom{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}
    .splash-logo{font-weight:900;font-size:calc(2.0 * var(--fs-28));letter-spacing:-.035em;color:#fff;text-align:center;text-shadow:0 4px 24px rgba(0,0,0,.3);animation:logoFloat 3s ease-in-out infinite}
    @keyframes logoFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    .splash-sub{animation:subfade .6s var(--ease) .3s backwards}
    .splash-icon{animation:iconSpin 1s var(--ease) .2s backwards, iconFloat 3s ease-in-out .8s infinite}
    @keyframes iconSpin{from{opacity:0;transform:rotate(-180deg) scale(.5)}to{opacity:1;transform:rotate(0) scale(1)}}
    @keyframes iconFloat{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-12px) rotate(5deg)}}
    .skip-btn{margin-top:16px;padding:10px 18px;border-radius:16px;border:1px solid var(--skip-bd);background:var(--skip-bg);color:var(--skip-fg);font-weight:900;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,.35);transition:all .2s var(--ease);animation:subfade .6s var(--ease) .5s backwards}
    .skip-btn:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,0,0,.4)}
    .skip-btn:active{transform:translateY(0)}
    html[data-skip="auto"].dark{--skip-bg:#fff;--skip-bd:#fff;--skip-fg:#000}
    html[data-skip="auto"].light{--skip-bg:#000;--skip-bd:#000;--skip-fg:#fff}

    /* iOS Style Scroll to top button */
    .scroll-top{position:fixed;right:1.5rem;bottom:8rem;width:48px;height:48px;border-radius:50%;background:color-mix(in srgb,var(--bg-elev) 92%,transparent);backdrop-filter:saturate(180%) blur(20px);border:none;color:var(--muted);display:none;align-items:center;justify-content:center;cursor:pointer;transition:all .25s cubic-bezier(.2,.8,.2,1);z-index:54;box-shadow:0 4px 16px rgba(0,0,0,.15)}
    .scroll-top.show{display:flex;animation:fadeInUp .3s var(--ease)}
    .scroll-top:hover{transform:scale(1.08);background:var(--accent-grad);color:#fff;border-color:transparent;box-shadow:0 8px 24px rgba(109,121,255,.35)}
    .scroll-top:active{transform:scale(.92)}

    /* Loading state for search */
    .search-loading{padding:1.5rem;text-align:center;color:var(--muted);font-size:var(--fs-13)}
    .search-loading::after{content:'...';animation:dots 1.5s steps(4,end) infinite}
    @keyframes dots{0%,20%{content:'.'}40%{content:'..'}60%,100%{content:'...'}}
  
/* --- Fix: High-contrast text on active purple tab; ensure text above overlay --- */
.viewbar .vbtn > * { position: relative; z-index: 1; }
.viewbar .vbtn { color: var(--accent-1) !important; }
.viewbar .vbtn .ico { color: var(--accent-1) !important; fill: var(--accent-1) !important; }
.viewbar .vbtn.active,
html.dark .viewbar .vbtn.active,
html.light .viewbar .vbtn.active { color: #fff !important; }
.viewbar .vbtn.active .ico { stroke: #fff !important; fill: #fff !important; color: #fff !important; }


/* --- GNB Icon-only design --- */
.gnb-btn{ position:relative; display:flex; align-items:center; justify-content:center; padding:10px; border-radius:14px; transition:transform .22s var(--ease), background .22s var(--ease); }
.gnb-btn .gnb-ico{ width:28px; height:28px; transition:transform .22s var(--ease), opacity .22s var(--ease), filter .22s var(--ease); }
.gnb-btn .label{ display:none !important; }
.gnb-btn.active{ background:rgba(255,255,255,.15); }
.gnb-btn.active .gnb-ico{ transform:scale(1.08); }
@keyframes gnbPop { 0%{transform:scale(1);} 60%{transform:scale(1.15);} 100%{transform:scale(1.08);} }
.gnb-btn.active .gnb-ico{ animation: gnbPop .28s var(--ease); }


/* --- Icon-only viewbar (Material-like) --- */
.viewbar .vbtn .ico{ width:28px; height:28px; stroke:none !important; fill:currentColor !important; border-radius:6px; }
.viewbar .vbtn{ padding:8px 10px; }


/* --- Larger, Material-like filled GNB icons --- */
.gnb-btn .gnb-ico{ width:32px !important; height:32px !important; stroke:none !important; fill:currentColor !important; }



/* === Stronger icon contrast & auto inversion on colored backgrounds === */
.icon-contrast, .toolbar .icon-btn, .viewbar .vbtn .ico, .gnb-ico {
  color: currentColor !important;
}
html.dark .toolbar .icon-btn { color: rgba(255,255,255,.9) !important; }
html.light .toolbar .icon-btn { color: rgba(0,0,0,.82) !important; }
/* Active view buttons are always white on accent background */
.viewbar .vbtn.active { color:#fff !important; }
.viewbar .vbtn.active .ico { fill:#fff !important; stroke:none !important; }
/* Improve icon rendering sharpness */
svg { shape-rendering: geometricPrecision; text-rendering: optimizeLegibility; image-rendering: optimizeQuality; }

/* === Material Symbols Rounded setup === */
.msr {
  font-family: 'Material Symbols Rounded';
  font-weight: 500;
  font-style: normal;
  font-size: 24px; /* default */
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
  font-variation-settings: 'FILL' 1, 'wght' 600, 'GRAD' 0, 'opsz' 24;
}

/* Remove rounded square overlay from bottom nav icons */
.gnb-btn::before{ display:none !important; }
.gnb-btn.active{ background: transparent !important; }

/* Material icon sizes for bottom GNB and viewbar */
.gnb-btn .gnb-ico { font-size: 32px !important; } /* slightly bigger per request */
.viewbar .vbtn .msr { font-size: 26px !important; }

/* Ensure inversion (white) when active over purple tab */
.viewbar .vbtn.active .msr { color: #fff !important; }

/* Strengthen default contrast for icons */
html.dark .msr { color: rgba(255,255,255,.88); }
html.light .msr { color: rgba(0,0,0,.82); }


/* === Bootstrap Icons sizing & contrast === */
.gnb-btn .gnb-ico { font-size: 32px !important; line-height: 1; }
.viewbar .vbtn i { font-size: 26px !important; line-height: 1; }

/* default tone */
html.dark i.bi { color: rgba(255,255,255,.9); }
html.light i.bi { color: rgba(0,0,0,.85); }

/* active over purple -> force white */
.viewbar .vbtn.active i.bi { color: #fff !important; }

/* remove any pseudo backgrounds previously applied */
.gnb-btn::before { display:none !important; }
.gnb-btn.active { background: transparent !important; }


/* === Embossed White Icon Style (GNB) === */
.gnb-btn .gnb-ico { 
  color: #ffffff !important;
  font-size: 32px !important;
  line-height: 1;
  /* layered shadows for volume */
  text-shadow:
    0 1px 0 rgba(255,255,255,0.35),   /* top highlight */
    0 2px 3px rgba(0,0,0,0.32),       /* core drop */
    0 8px 16px rgba(0,0,0,0.18);      /* soft spread */
  filter: drop-shadow(0 1px 0 rgba(0,0,0,0.12));
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.gnb-btn:hover .gnb-ico,
.gnb-btn:focus-visible .gnb-ico {
  transform: translateY(-1px) scale(1.04);
  transition: transform .16s ease, text-shadow .2s ease;
  text-shadow:
    0 1px 0 rgba(255,255,255,0.4),
    0 3px 5px rgba(0,0,0,0.36),
    0 10px 20px rgba(0,0,0,0.2);
}

.gnb-btn.active .gnb-ico {
  transform: translateY(-1px) scale(1.06);
  text-shadow:
    0 1px 0 rgba(255,255,255,0.45),
    0 4px 8px rgba(0,0,0,0.38),
    0 14px 28px rgba(0,0,0,0.22);
}

/* Ensure no background pills remain */
.gnb-btn::before{ display:none !important; }
.gnb-btn{ background: transparent !important; }


/* === Tailwind-esque Interaction Suite ========================= */
/* Targets: buttons, menu items, tabs, chips, GNB, LNB */
button, .btn, .vbtn, .gnb-btn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a {
  position: relative;
  transition: transform .15s ease, box-shadow .2s ease, background-color .2s ease, color .2s ease, opacity .2s ease;
  will-change: transform;
  -webkit-tap-highlight-color: transparent;
}

/* Hover lift */
button:hover, .btn:hover, .vbtn:hover, .gnb-btn:hover, .menu-item:hover, .tab-btn:hover, .chip:hover, .lnb a:hover, .gnb a:hover {
  transform: translateY(-1px);
}

/* Active press */
button:active, .btn:active, .vbtn:active, .gnb-btn:active, .menu-item:active, .tab-btn:active, .chip:active, .lnb a:active, .gnb a:active {
  transform: translateY(0) scale(0.98);
}

/* Focus ring (Tailwind-like) */
button:focus-visible, .btn:focus-visible, .vbtn:focus-visible, .gnb-btn:focus-visible, .menu-item:focus-visible, .tab-btn:focus-visible, .chip:focus-visible, .lnb a:focus-visible, .gnb a:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(99,102,241,.45), 0 1px 1px rgba(0,0,0,.08);
  border-radius: 12px; /* soft rounding */
}

/* Subtle hover bg on non-transparent controls */
html.light button:hover, html.light .btn:hover, html.light .vbtn:hover, html.light .menu-item:hover, html.light .tab-btn:hover, html.light .chip:hover {
  background-color: rgba(17,24,39,0.04);
}
html.dark button:hover, html.dark .btn:hover, html.dark .vbtn:hover, html.dark .menu-item:hover, html.dark .tab-btn:hover, html.dark .chip:hover {
  background-color: rgba(255,255,255,0.06);
}

/* Elevated active states */
button.active, .btn.active, .vbtn.active, .menu-item.active, .tab-btn.active, .lnb a.active, .gnb a.active {
  box-shadow: 0 8px 24px rgba(0,0,0,.18), 0 2px 6px rgba(0,0,0,.12);
}

/* GNB stays backgroundless but still gets micro-interactions */
.gnb-btn:hover { filter: brightness(1.02); }
.gnb-btn:active { filter: brightness(0.98); }

/* Ripple effect */
.fx-ripple {
  overflow: hidden;
}
.fx-ripple .rpl {
  position: absolute;
  border-radius: 9999px;
  pointer-events: none;
  inset: auto;
  width: 12px; height: 12px;
  transform: translate(-50%, -50%) scale(0);
  opacity: .25;
  background: currentColor;
  animation: rpl .6s ease-out forwards;
}
@keyframes rpl {
  to { transform: translate(-50%, -50%) scale(18); opacity: 0; }
}

/* Motion preference */
@media (prefers-reduced-motion: reduce) {
  button, .btn, .vbtn, .gnb-btn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a { transition: none; }
  .rpl { animation: none !important; opacity: 0 !important; }
}
/* === End Tailwind-esque Interaction Suite ===================== */


/* === Modern Brand Logo ========================= */
.ib-logo{
  font-family: 'Plus Jakarta Sans', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: .18em;
  display:inline-block;
  line-height:1.1;
  transform: translateZ(0); /* avoid blurriness */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* Default sizing: slightly smaller than before */
.header .ib-logo{ font-size: clamp(16px, 3.2vw, 22px); }
.splash .ib-logo{ font-size: clamp(20px, 5.2vw, 28px); } /* splash also smaller than prior */
html.light .ib-logo{ color: #0f172a; }  /* slate-900 */
html.dark .ib-logo{ color: #ffffff; }

/* Subtle modern depth */
.ib-logo{
  text-shadow:
    0 1px 0 rgba(255,255,255,0.22),
    0 10px 24px rgba(0,0,0,0.08);
}
html.dark .ib-logo{
  text-shadow:
    0 1px 0 rgba(255,255,255,0.08),
    0 10px 24px rgba(0,0,0,0.28);
}

/* === Tailwind-ish Mobile Smoothness ========= */
:root{
  --ease-spring: cubic-bezier(.2,.8,.2,1);
  --dur-fast: .15s;
  --dur-med: .24s;
  --dur-slow: .38s;
}

/* Apply smoother easing globally to interactive elements */
button, .btn, .vbtn, .gnb-btn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a {
  transition-timing-function: var(--ease-spring);
}

/* Header subtle elevation on scroll */
.header, .topbar{
  transition: box-shadow var(--dur-med) var(--ease-spring), backdrop-filter var(--dur-med) var(--ease-spring);
  backdrop-filter: none;
}
.scrolled .header, .scrolled .topbar{
  box-shadow: 0 8px 24px rgba(0,0,0,.06);
  backdrop-filter: saturate(1.1) blur(4px);
}

/* Page/content enter motion (first paint) */
@keyframes ib-fade-slide-in {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}
.main, .content, .grid, .list, .view {
  animation: ib-fade-slide-in var(--dur-slow) var(--ease-spring) both;
}

/* Bottom GNB slight spring on reveal */
.gnb{
  transition: transform var(--dur-med) var(--ease-spring), box-shadow var(--dur-med) var(--ease-spring);
}
.gnb.show { transform: translateY(0); }
.gnb.hide { transform: translateY(6px); }

/* Cards / list rows gentle hover & active for touch */
.card, .list-item{
  transition: transform var(--dur-med) var(--ease-spring), box-shadow var(--dur-med) var(--ease-spring), background-color var(--dur-med) var(--ease-spring);
}
.card:active, .list-item:active{ transform: scale(.99); }
html.light .card:hover, html.light .list-item:hover{ background-color: rgba(15,23,42,.03); }
html.dark .card:hover, html.dark .list-item:hover{ background-color: rgba(255,255,255,.04); }

/* Respect reduce motion */
@media (prefers-reduced-motion: reduce){
  .main, .content, .grid, .list, .view{ animation: none !important; }
}


/* === Logo glossy ink highlight (subtle 1–2%) ===================== */
.ib-logo{ position: relative; }
.ib-logo::after{
  content: attr(data-text);
  position: absolute; inset: 0;
  pointer-events: none;
  /* subtle ink gloss: very light gradient, blended */
  background: linear-gradient(to bottom, rgba(255,255,255,.14) 0%, rgba(255,255,255,0) 22%, rgba(0,0,0,0) 78%, rgba(0,0,0,.06) 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  mix-blend-mode: soft-light;
  opacity: .28;
  transform: translateZ(0);
}

/* === Sticky-Compress section headers ============================= */
.sticky-compress{
  position: sticky;
  top: var(--sticky-top, 56px); /* adjust if your header height differs */
  z-index: 5;
  background: inherit;
  transform-origin: top;
  transition: background-color .2s var(--ease-spring);
  will-change: transform, background-color;
  padding-top: .35rem; padding-bottom: .25rem;
}
html.light .sticky-compress{ background-color: rgba(255,255,255,.72); backdrop-filter: blur(4px); }
html.dark .sticky-compress{ background-color: rgba(17,24,39,.5); backdrop-filter: blur(4px); }

/* default scale; JS updates via --compress-ratio to between 0.92~1 */
.sticky-compress{ transform: scaleY(var(--compress-scale, 1)); }

/* === FAB bounce (elastic 1.06 -> 1.0) ============================ */
@keyframes ib-bounce {
  0% { transform: translateY(-1px) scale(1.00); }
  30% { transform: translateY(-1px) scale(1.06); }
  100% { transform: translateY(0) scale(1.00); }
}
.fab-bounce{ animation: ib-bounce .28s var(--ease-spring); }

/* Optional: make FAB slightly elevated by default */
#navAdd.gnb-btn .gnb-ico{ filter: drop-shadow(0 4px 10px rgba(0,0,0,.18)); }


/* === Fine-tuning Variables ===================================== */
:root{
  /* Compress range (1.00 -> between 0.94~0.98) */
  --compress-min: 0.96;  /* settable within 0.94~0.98 */
  --compress-max: 0.98;
  --sticky-top: 56px;     /* header height / sticky anchor */
  --fab-dur: .26s;        /* 0.22s ~ 0.34s */
  /* Logo gloss controls */
  --logo-gloss-angle: 180deg;  /* top-to-bottom by default */
  --logo-gloss-top: 16%;       /* 10% ~ 20% suggested */
}

/* Update sticky-compress to use CSS var */
.sticky-compress{
  top: var(--sticky-top);
  transform: scaleY(var(--compress-scale, 1));
}

/* FAB bounce duration adjustable */
@keyframes ib-bounce {
  0% { transform: translateY(-1px) scale(1.00); }
  30% { transform: translateY(-1px) scale(1.06); }
  100% { transform: translateY(0) scale(1.00); }
}
.fab-bounce{ animation: ib-bounce var(--fab-dur) var(--ease-spring); }

/* Logo glossy ink highlight using angle & top stop */
.ib-logo::after{
  background: linear-gradient(var(--logo-gloss-angle),
    rgba(255,255,255,.14) 0%,
    rgba(255,255,255,0) var(--logo-gloss-top),
    rgba(0,0,0,0) calc(100% - 22%),
    rgba(0,0,0,.06) 100%
  );
  opacity: .26; /* slightly softened after tuning */
}

/* === Platform-specific touch pressure =========================== */
.platform-ios button:active,
.platform-ios .btn:active,
.platform-ios .vbtn:active,
.platform-ios .menu-item:active,
.platform-ios .tab-btn:active,
.platform-ios .chip:active,
.platform-ios .lnb a:active,
.platform-ios .gnb a:active {
  transform: translateY(0) scale(0.985); /* lighter press on iOS */
  transition-duration: .16s;
}

.platform-android button:active,
.platform-android .btn:active,
.platform-android .vbtn:active,
.platform-android .menu-item:active,
.platform-android .tab-btn:active,
.platform-android .chip:active,
.platform-android .lnb a:active,
.platform-android .gnb a:active {
  transform: translateY(0) scale(0.98);  /* slightly deeper press */
  transition-duration: .18s;
}


/* === Brand size tuned to 2/3 =================================== */
.brand{ font-size: clamp(1.47rem, 2.933vw, 1.8rem) !important; }
.splash .splash-logo{ font-size: calc(1.3333 * var(--fs-28)) !important; } /* 2/3 of previous 2.0*fs-28 */


/* === Smooth, Modern Interactions ================================ */
:root{
  --fx-ease: cubic-bezier(.22,.9,.2,1);
  --fx-fast: .16s;
  --fx-med: .24s;
  --fx-slow: .36s;
}
button, .btn, .vbtn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a {
  transition:
    transform var(--fx-fast) var(--fx-ease),
    background-color var(--fx-med) var(--fx-ease),
    color var(--fx-med) var(--fx-ease),
    box-shadow var(--fx-slow) var(--fx-ease),
    opacity var(--fx-fast) var(--fx-ease);
  will-change: transform;
  -webkit-tap-highlight-color: transparent;
}
button:hover, .btn:hover, .vbtn:hover, .menu-item:hover, .tab-btn:hover, .chip:hover, .lnb a:hover, .gnb a:hover { transform: translateY(-1px); }
button:active, .btn:active, .vbtn:active, .menu-item:active, .tab-btn:active, .chip:active, .lnb a:active, .gnb a:active { transform: translateY(0) scale(0.985); }
button:focus-visible, .btn:focus-visible, .vbtn:focus-visible, .menu-item:focus-visible, .tab-btn:focus-visible, .chip:focus-visible, .lnb a:focus-visible, .gnb a:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(99,102,241,.45), 0 1px 1px rgba(0,0,0,.08);
  border-radius: 12px;
}
/* page/section mount */
@keyframes fx-in { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:none} }
.main, .content, .grid, .list, section { animation: fx-in var(--fx-slow) var(--fx-ease) both; }
@media (prefers-reduced-motion: reduce){
  button, .btn, .vbtn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a { transition: none; }
  .main, .content, .grid, .list, section { animation: none !important; }
}
/* subtle hover backdrop */
html.light button:hover, html.light .btn:hover, html.light .vbtn:hover, html.light .menu-item:hover, html.light .tab-btn:hover, html.light .chip:hover {
  background-color: rgba(17,24,39,0.04);
}
html.dark button:hover, html.dark .btn:hover, html.dark .vbtn:hover, html.dark .menu-item:hover, html.dark .tab-btn:hover, html.dark .chip:hover {
  background-color: rgba(255,255,255,0.06);
}
/* ripple */
.fx-ripple{ overflow: hidden; position: relative; }
.fx-ripple .rpl{
  position: absolute; border-radius: 9999px; pointer-events: none;
  width: 12px; height: 12px; opacity: .22; background: currentColor;
  transform: translate(-50%,-50%) scale(0);
  animation: rpl .6s var(--fx-ease) forwards;
}
@keyframes rpl{ to{ transform: translate(-50%,-50%) scale(18); opacity: 0; } }

</style>

  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@200..700,FILL@0..1,GRAD@-50..200,opsz@20..48&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet">
</head>



<body>
  <!-- Enhanced Splash Screen -->
  <div id="splash" class="splash" aria-hidden="true">
    <div class="splash-card">
      <!-- Modern Brain Icon with Animation -->
      <svg class="splash-icon" aria-hidden="true" width="160" height="160" viewBox="0 0 256 256" style="display:block;margin:0 auto 24px auto">
        <defs>
          <linearGradient id="brainGlow" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#ffb3bd"/>
            <stop offset="50%" stop-color="#ff8ea1"/>
            <stop offset="100%" stop-color="#ff6b8a"/>
          </linearGradient>
          <filter id="glow">
            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>
        <g fill="url(#brainGlow)" stroke="#fff" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" filter="url(#glow)">
          <path d="M122 36c-22-10-49-2-62 18-10 15-9 33-2 46-17 5-30 23-28 41 2 20 18 35 38 37-4 14 2 30 16 39 15 10 34 8 46-3V58c0-9-4-18-8-22Z"/>
          <path d="M134 36c22-10 49-2 62 18 10 15 9 33 2 46 17 5 30 23 28 41-2 20-18 35-38 37 4 14-2 30-16 39-15 10-34 8-46-3V58c0-9 4-18 8-22Z"/>
          <path d="M80 82c-12 6-18 22-8 34m8 28c-10 8-12 22-2 32m98-94c12 6 18 22 8 34m-8 28c10 8 12 22 2 32" fill="none"/>
          <path d="M128 52v152" fill="none" stroke-width="10"/>
        </g>
      </svg>
      <div class="splash-logo"><span class=\"ib-logo\">IDEA BRAIN</span></div>
      <div class="brand-sub logo"> 20 FEVER, 21 CREATIVE </div>
      <button id="skipSplash" class="skip-btn" type="button" aria-label="Skip to main">START</button>
    </div>
  </div>

  <header id="header" class="header">
    <div class="wrap">
      <div class="row">
        <div class="brand-wrap">
          <div class="brand"><span class=\"ib-logo\">IDEA BRAIN</span></div>
        </div>
        <div class="toolbar">
          <button class="icon-btn" id="themeBtn" title="테마 전환" aria-label="테마 전환">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </button>
          <button class="icon-btn" id="calBtn" title="캘린더 보기" aria-label="캘린더 보기">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
          </button>
          <button class="icon-btn" id="searchBtn" title="검색 (⌘/Ctrl+K)" aria-label="검색">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"/>
              <line x1="21" y1="21" x2="16.65" y2="16.65"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="search" id="searchBar" style="display:none">
        <input id="searchInput" type="text" placeholder="아이디어 검색… (제목·태그·내용)" autocomplete="off" />
        <svg class="ico search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <div id="searchResults" class="search-results"></div>
      </div>
    </div>
  </header>

  <main>
    <div class="viewbar" id="viewBar">
      <button class="vbtn active" id="listBtn" aria-pressed="true"><i class="bi bi-list"></i></button>
      <button class="vbtn" id="gridBtn" aria-pressed="false"><i class="bi bi-grid-3x3-gap-fill"></i></button>
    </div>

    <section id="ideas" class="list"></section>

    <section id="calendarWrap" style="display:none">
      <div class="cal-card">
        <div class="cal-head">
          <button class="cal-btn" id="prevMonth" aria-label="이전 달">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
          <div class="cal-title" id="calTitle">YYYY.MM</div>
          <button class="cal-btn" id="nextMonth" aria-label="다음 달">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
        </div>
        <div class="cal-grid" style="margin-bottom:var(--sp-8);">
          <div class="cal-dow" style="color:#ef4444">일</div><div class="cal-dow">월</div><div class="cal-dow">화</div><div class="cal-dow">수</div><div class="cal-dow">목</div><div class="cal-dow">금</div><div class="cal-dow" style="color:#3b82f6">토</div>
        </div>
        <div class="cal-grid" id="calDays"></div>
      </div>
    </section>

    <div id="empty" class="empty" style="display:none">
      <div class="ico" aria-hidden="true" style="width:56px;height:56px">
        <svg class="ico" viewBox="0 0 24 24" style="width:56px;height:56px" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
      </div>
      <h3>아직 아이디어가 없습니다</h3>
      <div>오른쪽 아래 <b>+</b> 버튼으로 첫 아이디어를 추가해보세요</div>
    </div>
  </main>

  <!-- Enhanced FAB -->
  <button class="fab" id="fab" title="새 아이디어" aria-label="새 아이디어">
    <svg class="ico" viewBox="0 0 24 24" style="width:28px;height:28px" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
      <line x1="12" y1="5" x2="12" y2="19"/>
      <line x1="5" y1="12" x2="19" y2="12"/>
    </svg>
  </button>

  <!-- Scroll to Top Button -->
  <button class="scroll-top" id="scrollTop" title="맨 위로" aria-label="맨 위로">
    <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M18 15l-6-6-6 6"/>
    </svg>
  </button>

  <!-- Drag Preview Toast -->
  <div id="dragToast" class="drag-toast" aria-hidden="true">
    <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="8" y1="6" x2="21" y2="6"/>
      <line x1="8" y1="12" x2="21" y2="12"/>
      <line x1="8" y1="18" x2="21" y2="18"/>
      <line x1="3" y1="6" x2="3.01" y2="6"/>
      <line x1="3" y1="12" x2="3.01" y2="12"/>
      <line x1="3" y1="18" x2="3.01" y2="18"/>
    </svg>
    <span class="tt"></span>
    <span class="tg"></span>
  </div>

  <!-- Enhanced Bottom GNB with iOS Style Icons -->
  <nav class="gnb" role="navigation" aria-label="하단 내비게이션">
    <div class="gnb-inner">
      <button class="gnb-btn active" id="navHome" aria-label="홈"><i class="bi bi-house-door-fill gnb-ico" aria-hidden="true"></i></button>
      <button class="gnb-btn" id="navCalendar" aria-label="캘린더"><i class="bi bi-calendar3-event gnb-ico" aria-hidden="true"></i></button>
      <button class="gnb-btn gnb-btn-add" id="navAdd" aria-label="추가"><i class="bi bi-plus-circle-fill gnb-ico" aria-hidden="true"></i></button>
      <button class="gnb-btn" id="navSearch" aria-label="검색"><i class="bi bi-search gnb-ico" aria-hidden="true"></i></button>
      <button class="gnb-btn" id="navSettings" aria-label="설정"><i class="bi bi-gear-fill gnb-ico" aria-hidden="true"></i></button>
    </div>
  </nav>

  <!-- Enhanced Modal -->
  <div class="overlay" id="overlay">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-head">
        <div class="modal-title" id="modalTitle">새 아이디어</div>
        <button class="icon-btn" id="closeModal" aria-label="닫기">
          <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div style="margin-bottom:var(--sp-16)">
          <label class="label" for="title">제목</label>
          <input id="title" class="input" type="text" placeholder="아이디어 제목을 입력하세요" />
        </div>
        <div style="margin-bottom:var(--sp-16)">
          <label class="label">태그</label>
          <div id="tags" class="tags" style="margin-bottom:var(--sp-10)"></div>
          <div class="row" style="display:flex;gap:var(--sp-10);align-items:center;flex-wrap:nowrap">
            <input id="tagInput" class="input" type="text" placeholder="태그 입력 후 Enter (예: UX/Flow, UX/Token)" />
            <button id="addTag" class="btn btn-primary" style="flex-shrink:0">
              <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>추가
            </button>
          </div>
        </div>
        <div style="margin-bottom:var(--sp-16)">
          <label class="label">이미지</label>
          <input id="imageInput" type="file" accept="image/*" style="display:none" />
          <button id="imagePick" class="drop" style="display:flex;align-items:center;justify-content:center;gap:var(--sp-10);height:130px;cursor:pointer">
            <svg class="ico" viewBox="0 0 24 24" style="width:28px;height:28px" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <path d="M21 15l-5-5L5 21"/>
            </svg>
            <span>이미지 업로드</span>
          </button>
          <div id="imagePreview" style="display:none;margin-top:var(--sp-12);position:relative;">
            <img id="previewImg" style="width:100%;border-radius:var(--r-lg);box-shadow:var(--shadow-md)" alt="미리보기" />
            <button id="removeImage" class="icon-btn" style="position:absolute;top:var(--sp-12);right:var(--sp-12);background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;width:44px;height:44px">
              <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
        </div>
        <div style="margin-bottom:var(--sp-16)">
          <label class="label">마감일 (Due Date)</label>
          <input id="dueInput" class="input" type="date" />
        </div>
        <div style="margin-bottom:var(--sp-16)">
          <label class="label">내용</label>
          <div id="editor"></div>
          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
            <button type="button" class="btn btn-ghost" id="insertTable" style="font-size:12px;padding:6px 12px">
              <svg class="ico" viewBox="0 0 24 24" style="width:16px;height:16px" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <line x1="3" y1="9" x2="21" y2="9"/>
                <line x1="3" y1="15" x2="21" y2="15"/>
                <line x1="12" y1="3" x2="12" y2="21"/>
              </svg>
              테이블 삽입
            </button>
            <button type="button" class="btn btn-ghost" id="insertDivider" style="font-size:12px;padding:6px 12px">
              <svg class="ico" viewBox="0 0 24 24" style="width:16px;height:16px" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"/>
              </svg>
              구분선
            </button>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="deleteBtn" class="btn btn-danger" style="display:none;flex:1">
          <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            <line x1="10" y1="11" x2="10" y2="17"/>
            <line x1="14" y1="11" x2="14" y2="17"/>
          </svg>
          삭제
        </button>
        <button id="saveBtn" class="btn btn-primary" style="flex:1">
          <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/>
            <polyline points="7 3 7 8 15 8"/>
          </svg>
          저장
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>
  <script>
    // Enhanced Splash Screen with Auto-hide
    (function(){
      const splash=document.getElementById('splash');
      const skip=document.getElementById('skipSplash');
      if(!splash) return;
      function hideSplash(){
        if(!splash || splash.classList.contains('hide')) return;
        splash.classList.add('hide');
        setTimeout(()=>{ splash.style.display='none'; }, 600);
      }
      let t=setTimeout(hideSplash, 3200);
      if(skip){ skip.addEventListener('click', ()=>{ clearTimeout(t); hideSplash(); }); }
    })();
  </script>
  <script>
    // ===== State
    let quill; 
    let editingId=null; 
    let tags=[]; 
    let imageData=null; 
    let view='list'; 
    let calDate=new Date();
    const $=s=>document.querySelector(s); 
    const $$=s=>document.querySelectorAll(s); 
    const ideasKey='ideas';
    
    function getIdeas(){ try{return JSON.parse(localStorage.getItem(ideasKey)||'[]')}catch{return[]} }
    function setIdeas(data){ localStorage.setItem(ideasKey,JSON.stringify(data)) }

    // Theme
    function loadTheme(){ 
      const t=localStorage.getItem('theme')||'dark'; 
      document.documentElement.className=t; 
    }
    function toggleTheme(){ 
      const c=document.documentElement.classList; 
      const t=c.contains('light')?'dark':'light'; 
      document.documentElement.className=t; 
      localStorage.setItem('theme',t); 
    }

    // Render ideas
    function renderIdeas(list){
      const data=list||getIdeas(); 
      const cnt=$('#ideas'); 
      const empty=$('#empty');
      if(!data.length){ 
        cnt.innerHTML=''; 
        empty.style.display=''; 
        return; 
      }
      empty.style.display='none';
      cnt.innerHTML=data.map(i=>{
        const d=new Date(i.createdAt);
        const date=d.toLocaleDateString('ko-KR');
        const preview=i.content?.replace(/<[^>]*>/g,'').slice(0,120)+'...';
        const imgHtml=i.image?`<div class="thumb"><img src="${i.image}" alt=""></div>`:'';
        const tagsHtml=i.tags&&i.tags.length?`<div class="tags">${i.tags.map(t=>renderTag(t)).join('')}</div>`:'';
        const dueHtml=i.dueAt?`<span>📅 ${new Date(i.dueAt).toLocaleDateString('ko-KR')}</span>`:'';
        return `<div class="card" onclick="openModal(${i.id})" data-id="${i.id}" data-title="${i.title||''}" data-tags="${(i.tags||[]).join(',')}">
          ${imgHtml}
          ${tagsHtml}
          <div class="title">${i.title||'제목 없음'}</div>
          <div class="preview">${preview||'내용 없음'}</div>
          <div class="meta"><span>📝 ${date}</span>${dueHtml}</div>
        </div>`;
      }).join('');
      addCalendarDnD();
    }
    
    function renderTag(t){ 
      return `<span class="tag">#${t}</span>`; 
    }

    // Search - Enhanced
    let searchTimeout;
    function search(q){
      const results=$('#searchResults');
      if(!q.trim()){ 
        results.style.display='none'; 
        return; 
      }
      
      clearTimeout(searchTimeout);
      results.innerHTML='<div class="search-loading">검색 중</div>';
      results.style.display='block';
      
      searchTimeout = setTimeout(()=>{
        const list=getIdeas().filter(i=>{
          const titleMatch=i.title?.toLowerCase().includes(q.toLowerCase());
          const tagMatch=i.tags?.some(t=>t.toLowerCase().includes(q.toLowerCase()));
          const contentMatch=i.content?.toLowerCase().includes(q.toLowerCase());
          return titleMatch||tagMatch||contentMatch;
        });
        
        if(!list.length){ 
          results.innerHTML='<div class="search-empty">검색 결과가 없습니다</div>'; 
          return; 
        }
        
        results.innerHTML=list.map(i=>{
          const highlight=(text)=>text.replace(new RegExp(q,'gi'),m=>`<mark>${m}</mark>`);
          return `<div class="search-item" onclick="openModal(${i.id}); closeSearch()">
            <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="16"/>
              <line x1="8" y1="12" x2="16" y2="12"/>
            </svg>
            <div><div style="font-weight:700">${highlight(i.title||'제목 없음')}</div>
            <div style="font-size:12px;color:var(--muted);margin-top:2px">${i.tags?i.tags.map(t=>'#'+t).join(' '):''}</div></div>
          </div>`;
        }).join('');
      }, 300);
    }

    function closeSearch(){
      $('#searchBar').style.display='none';
      $('#searchInput').value='';
      $('#searchResults').style.display='none';
    }

    // Calendar
    function renderCalendar(){
      const y=calDate.getFullYear(); 
      const m=calDate.getMonth(); 
      const first=new Date(y,m,1).getDay(); 
      const last=new Date(y,m+1,0).getDate();
      $('#calTitle').textContent=`${y}.${String(m+1).padStart(2,'0')}`;
      const days=$('#calDays'); 
      days.innerHTML=''; 
      const list=getIdeas(); 
      const set=new Set();
      list.forEach(i=>{
        const t=new Date(i.createdAt); 
        if(t.getFullYear()===y&&t.getMonth()===m){ 
          set.add(`${y}-${m}-${t.getDate()}`); 
        }
      });
      for(let i=0;i<first;i++) days.innerHTML+=`<div></div>`;
      for(let day=1;day<=last;day++){
        const key=`${y}-${m}-${day}`; 
        const today=new Date(); 
        const isToday=today.toDateString()===new Date(y,m,day).toDateString();
        const todayStyle=isToday?'box-shadow:0 0 0 3px var(--accent-1);transform:scale(1.1)':'';
        days.innerHTML+=`<div class="cal-day ${set.has(key)?'has-idea':''}" data-y="${y}" data-m="${m}" data-d="${day}" style="${todayStyle}" onclick="filterByDate(${y},${m},${day})">${day}</div>`;
      }
      addCalendarDnD();
    }
    
    function filterByDate(y,m,d){
      const list=getIdeas().filter(i=>{
        const t=new Date(i.createdAt);
        return t.getFullYear()===y&&t.getMonth()===m&&t.getDate()===d
      });
      $('#calendarWrap').style.display='none'; 
      $('#ideas').style.display=''; 
      $('#viewBar').style.display=''; 
      renderIdeas(list);
    }

    // Modal
    function openModal(id){
      editingId=id??null; 
      $('#overlay').style.display='flex';
      $('#modalTitle').textContent=id?'아이디어 수정':'새 아이디어';
      if(id){ 
        const i=getIdeas().find(x=>x.id===id); 
        if(i){
          $('#title').value=i.title||''; 
          quill.root.innerHTML=i.content||''; 
          tags=[...(i.tags||[])]; 
          imageData=i.image||null; 
          paintTags();
          if(imageData){ 
            showImage(imageData); 
            $('#removeImage').style.display=''; 
          }
          $('#deleteBtn').style.display='inline-flex';
          $('#dueInput').value=i.dueAt? new Date(i.dueAt).toISOString().slice(0,10):'';
        }
      } else { 
        resetModal(); 
      }
    }
    
    function closeModal(){ 
      $('#overlay').style.display='none'; 
    }
    
    function resetModal(){ 
      editingId=null; 
      $('#title').value=''; 
      quill?.setText(''); 
      tags=[]; 
      imageData=null; 
      paintTags(); 
      hideImage(); 
      $('#deleteBtn').style.display='none'; 
      $('#dueInput').value=''; 
    }

    // Tags
    function paintTags(){
      const html=tags.map(t=>`${renderTag(t)}<button onclick="removeTag('${t.replace(/"/g,'&quot;')}')" class="icon-btn" style="width:28px;height:28px;border-radius:50%;margin-left:4px">
        <svg class="ico" viewBox="0 0 24 24" style="width:16px;height:16px" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>`).join('');
      $('#tags').innerHTML=html;
    }
    
    function addTag(){ 
      const v=$('#tagInput').value.trim(); 
      if(v&&!tags.includes(v)){ 
        tags.push(v); 
        paintTags(); 
      } 
      $('#tagInput').value=''; 
    }
    
    function removeTag(t){ 
      tags=tags.filter(x=>x!==t); 
      paintTags(); 
    }

    // Image
    function showImage(src){ 
      $('#imagePreview').style.display='block'; 
      $('#previewImg').src=src; 
    }
    
    function hideImage(){ 
      $('#imagePreview').style.display='none'; 
      $('#previewImg').src=''; 
    }

    // Save/Delete
    function save(){
      const title=$('#title').value.trim(); 
      if(!title) return alert('제목을 입력해주세요');
      const content=quill.root.innerHTML; 
      const data=getIdeas(); 
      const now=new Date().toISOString(); 
      const dueVal=$('#dueInput')?.value? new Date($('#dueInput').value+'T12:00:00').toISOString():null;
      if(editingId){ 
        const idx=data.findIndex(i=>i.id===editingId); 
        if(idx>-1){ 
          const orig=data[idx]; 
          data[idx]={...orig,title,content,tags:[...tags],image:imageData,updatedAt:now,dueAt:dueVal}; 
        } 
      } else{ 
        data.unshift({id:Date.now(),title,content,tags:[...tags],image:imageData,createdAt:now,updatedAt:now,dueAt:dueVal}); 
      }
      setIdeas(data); 
      renderIdeas(); 
      renderCalendar(); 
      closeModal();
    }
    
    function remove(){ 
      if(!confirm('정말 삭제하시겠습니까?')) return; 
      const data=getIdeas().filter(i=>i.id!==editingId); 
      setIdeas(data); 
      renderIdeas(); 
      renderCalendar(); 
      closeModal(); 
    }

    // Calendar DnD + Toast
    function addCalendarDnD(){
      const toast=$('#dragToast'); 
      const tt=toast.querySelector('.tt'); 
      const tg=toast.querySelector('.tg');
      $$('#ideas .card').forEach(el=>{
        el.setAttribute('draggable','true');
        el.addEventListener('dragstart',e=>{
          const t=el.dataset.title||''; 
          const tags=(el.dataset.tags||'').split(',').filter(Boolean);
          tt.textContent=t; 
          tg.textContent=tags.length?`#${tags[0]}`:'';
          toast.style.display='flex';
          toast.style.transform=`translate(${e.pageX+12}px,${e.pageY+12}px)`;
        });
        el.addEventListener('drag',e=>{
          if(e.pageX===0 && e.pageY===0) return;
          toast.style.transform=`translate(${e.pageX+12}px,${e.pageY+12}px)`;
        });
        el.addEventListener('dragend',()=>{ 
          toast.style.transform='translate(-9999px,-9999px)'; 
          toast.style.display='none';
        });
      });
      $$('#calDays .cal-day').forEach(d=>{
        d.addEventListener('dragover',e=>{ 
          e.preventDefault(); 
          d.classList.add('drop-hover'); 
        });
        d.addEventListener('dragleave',()=> d.classList.remove('drop-hover'));
        d.addEventListener('drop',e=>{
          e.preventDefault(); 
          d.classList.remove('drop-hover'); 
          d.classList.add('drop-success'); 
          setTimeout(()=>d.classList.remove('drop-success'),700);
          const y=+d.dataset.y, m=+d.dataset.m, day=+d.dataset.d; 
          const dt=new Date(y,m,day,12,0,0);
          const dragging = document.querySelector('#ideas .card[draggable="true"]:active, #ideas .card[draggable="true"]');
          if(!dragging) return;
          const id=+dragging.getAttribute('data-id'); 
          const list=getIdeas(); 
          const idx=list.findIndex(i=>i.id===id); 
          if(idx<0) return;
          if(e.shiftKey){ 
            // duplicate
            const dup={...list[idx], id:Date.now(), createdAt:dt.toISOString(), updatedAt:dt.toISOString()}; 
            list.unshift(dup);
          } else if(e.altKey){ 
            // branch → Due
            list[idx]={...list[idx], dueAt:dt.toISOString(), updatedAt:new Date().toISOString()};
          } else{ 
            // move
            list[idx]={...list[idx], createdAt:dt.toISOString(), updatedAt:new Date().toISOString()};
          }
          setIdeas(list); 
          renderIdeas(); 
          renderCalendar();
        });
      });
    }

    // View toggles / Nav
    function showList(){ 
      view='list'; 
      $('#ideas').className='list'; 
      $('#listBtn').classList.add('active'); 
      $('#gridBtn').classList.remove('active'); 
    }
    
    function showGrid(){ 
      view='grid'; 
      $('#ideas').className='grid'; 
      $('#gridBtn').classList.add('active'); 
      $('#listBtn').classList.remove('active'); 
    }

    // Scroll to top functionality
    function updateScrollTop(){
      const scrollTop = $('#scrollTop');
      if(window.pageYOffset > 300){
        scrollTop.classList.add('show');
      } else {
        scrollTop.classList.remove('show');
      }
    }

    // Header scroll effect
    let lastScroll = 0;
    function updateHeader(){
      const header = $('#header');
      const currentScroll = window.pageYOffset;
      if(currentScroll > 50){
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
      lastScroll = currentScroll;
    }

    // Init
    window.addEventListener('DOMContentLoaded',()=>{
      loadTheme();
      quill=
new Quill('#editor',{
  theme:'snow',
  placeholder:'아이디어를 자유롭게 작성하세요...',
  modules:{
    toolbar:[
      [{ 'header':[1,2,3,4,5,6,false] }],
      [{ 'font':[] }],
      [{ 'size':['small',false,'large','huge'] }],
      ['bold','italic','underline','strike'],
      [{ 'color':[] },{ 'background':[] }],
      [{ 'script':'sub' },{ 'script':'super' }],
      [{ 'list':'ordered' },{ 'list':'bullet' },{ 'list':'check' }],
      [{ 'indent':'-1' },{ 'indent':'+1' }],
      [{ 'align':[] }],
      ['blockquote','code-block'],
      ['link','image','video'],
      ['clean']
    ],
    history:{ delay:400, maxStack:300, userOnly:true },
    keyboard:{
      bindings:{
        tab:{ key:9, handler:function(range, ctx){ this.quill.format('indent','+1'); return false; } },
        shift_tab:{ key:9, shiftKey:true, handler:function(range, ctx){ this.quill.format('indent','-1'); return false; } },
        save:{ key:'S', shortKey:true, handler:function(){ document.getElementById('saveBtn')?.click(); return false; } }
      }
    }
  }
});


      renderIdeas(); 
      renderCalendar();

      // View buttons
      $('#listBtn').addEventListener('click',showList);
      $('#gridBtn').addEventListener('click',showGrid);
      
      // Navigation buttons
      $('#calBtn').addEventListener('click',()=>{ 
        $('#calendarWrap').style.display=''; 
        $('#ideas').style.display='none'; 
        $('#viewBar').style.display='none'; 
      });
      
      $('#navHome').addEventListener('click',()=>{ 
        $('#calendarWrap').style.display='none'; 
        $('#ideas').style.display=''; 
        $('#viewBar').style.display=''; 
        renderIdeas();
        // Update active state
        $$('.gnb-btn').forEach(btn => btn.classList.remove('active'));
        $('#navHome').classList.add('active');
      });
      
      $('#navCalendar').addEventListener('click',()=>{ 
        $('#calendarWrap').style.display=''; 
        $('#ideas').style.display='none'; 
        $('#viewBar').style.display='none'; 
        // Update active state
        $$('.gnb-btn').forEach(btn => btn.classList.remove('active'));
        $('#navCalendar').classList.add('active');
      });

      // Modal controls
      $('#fab').addEventListener('click',()=>openModal());
      $('#navAdd').addEventListener('click',()=>openModal());
      $('#closeModal').addEventListener('click',closeModal);
      $('#overlay').addEventListener('click',(e)=>{
        if(e.target === $('#overlay')) closeModal();
      });

      // Tag controls
      $('#addTag').addEventListener('click',addTag);
      $('#tagInput').addEventListener('keydown',e=>{ 
        if(e.key==='Enter'){ 
          e.preventDefault(); 
          addTag(); 
        } 
      });

      // Image controls
      $('#imagePick').addEventListener('click',()=>$('#imageInput').click());
      $('#imageInput').addEventListener('change',e=>{
        const f=e.target.files[0]; 
        if(f){
          const r=new FileReader(); 
          r.onload=ev=>{ 
            imageData=ev.target.result; 
            showImage(imageData); 
            $('#removeImage').style.display=''; 
          }; 
          r.readAsDataURL(f);
        }
      });
      $('#removeImage').addEventListener('click',()=>{ 
        imageData=null; 
        hideImage(); 
        $('#removeImage').style.display='none'; 
      });

      // Save/Delete buttons
      $('#saveBtn').addEventListener('click',save);
      $('#deleteBtn').addEventListener('click',remove);

      // Calendar navigation
      $('#prevMonth').addEventListener('click',()=>{ 
        calDate.setMonth(calDate.getMonth()-1); 
        renderCalendar(); 
      });
      $('#nextMonth').addEventListener('click',()=>{ 
        calDate.setMonth(calDate.getMonth()+1); 
        renderCalendar(); 
      });

      // Theme toggle
      $('#themeBtn').addEventListener('click',toggleTheme);

      // Search functionality
      $('#searchBtn').addEventListener('click',()=>{
        const searchBar = $('#searchBar');
        if(searchBar.style.display === 'none' || searchBar.style.display === ''){
          searchBar.style.display = 'block';
          $('#searchInput').focus();
        } else {
          closeSearch();
        }
      });
      
      $('#navSearch').addEventListener('click',()=>{
        $('#searchBar').style.display='block';
        $('#searchInput').focus();
        // Update active state
        $$('.gnb-btn').forEach(btn => btn.classList.remove('active'));
        $('#navSearch').classList.add('active');
      });
      
      $('#searchInput').addEventListener('input',e=>search(e.target.value));
      
      // Close search on Escape
      document.addEventListener('keydown',e=>{
        if(e.key==='Escape'){
          if($('#searchBar').style.display !== 'none'){
            closeSearch();
          } else if($('#overlay').style.display === 'flex'){
            closeModal();
          }
        }
      });

      // Keyboard shortcut for search (Cmd/Ctrl + K)
      document.addEventListener('keydown',e=>{
        if((e.metaKey || e.ctrlKey) && e.key === 'k'){
          e.preventDefault();
          $('#searchBar').style.display='block';
          $('#searchInput').focus();
        }
      });

      // Scroll to top button
      $('#scrollTop').addEventListener('click',()=>{
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });

      // Scroll events
      window.addEventListener('scroll', ()=>{
        updateScrollTop();
        updateHeader();
      });

      // Settings button (placeholder)
      $('#navSettings').addEventListener('click',()=>{
        alert('설정 기능은 곧 추가됩니다! 🎉');
        $$('.gnb-btn').forEach(btn => btn.classList.remove('active'));
        $('#navSettings').classList.add('active');
      });

      // Table insert functionality
      $('#insertTable').addEventListener('click',()=>{
        const rows = prompt('행 수를 입력하세요 (예: 3):', '3');
        const cols = prompt('열 수를 입력하세요 (예: 3):', '3');
        if(rows && cols){
          const r = parseInt(rows);
          const c = parseInt(cols);
          if(r > 0 && c > 0 && r <= 20 && c <= 10){
            let tableHTML = '<table><tbody>';
            for(let i = 0; i < r; i++){
              tableHTML += '<tr>';
              for(let j = 0; j < c; j++){
                const tag = i === 0 ? 'th' : 'td';
                tableHTML += `<${tag}>${i === 0 ? '제목' : '내용'}</${tag}>`;
              }
              tableHTML += '</tr>';
            }
            tableHTML += '</tbody></table><p><br></p>';
            const range = quill.getSelection(true);
            quill.clipboard.dangerouslyPasteHTML(range.index, tableHTML);
          } else {
            alert('행은 1-20, 열은 1-10 사이로 입력해주세요.');
          }
        }
      });

      // Divider insert functionality
      $('#insertDivider').addEventListener('click',()=>{
        const range = quill.getSelection(true);
        quill.clipboard.dangerouslyPasteHTML(range.index, '<hr><p><br></p>');
      });

      // Initial scroll state
      updateScrollTop();
      updateHeader();
    });

    // Handle browser back/forward
    window.addEventListener('popstate', ()=>{
      renderIdeas();
      renderCalendar();
    });
  </script>

<script>
// /* MATERIAL SAFETY TOGGLE */
(function(){
  const listBtn = document.getElementById('listBtn');
  const gridBtn = document.getElementById('gridBtn');
  const ideas = document.getElementById('ideas');
  if(listBtn && gridBtn && ideas){
    const activate = (btnOn, btnOff, modeOn, modeOff) => {
      btnOn.classList.add('active'); btnOn.setAttribute('aria-pressed','true');
      btnOff.classList.remove('active'); btnOff.setAttribute('aria-pressed','false');
      ideas.classList.add(modeOn); ideas.classList.remove(modeOff);
      // force repaint for icon contrast
      requestAnimationFrame(()=>{});
    };
    listBtn.addEventListener('click', ()=>activate(listBtn, gridBtn, 'list', 'grid'));
    gridBtn.addEventListener('click', ()=>activate(gridBtn, listBtn, 'grid', 'list'));
  }
})();
</script>

<script>
// Tailwind-ish Ripple for all interactive elements
(function(){
  const selector = 'button, .btn, .vbtn, .gnb-btn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a';
  const addRipple = (el) => {
    if(!el.classList.contains('fx-ripple')) el.classList.add('fx-ripple');
    el.addEventListener('click', function(e){
      const r = document.createElement('span');
      r.className = 'rpl';
      const rect = this.getBoundingClientRect();
      r.style.left = (e.clientX - rect.left) + 'px';
      r.style.top  = (e.clientY - rect.top) + 'px';
      this.appendChild(r);
      setTimeout(()=>r.remove(), 650);
    });
  };
  document.querySelectorAll(selector).forEach(addRipple);

  // Observe DOM for dynamically added buttons (e.g., modal actions)
  const obs = new MutationObserver((muts)=>{
    muts.forEach(m=>{
      m.addedNodes.forEach(n=>{
        if(!(n instanceof HTMLElement)) return;
        if(n.matches && n.matches(selector)) addRipple(n);
        n.querySelectorAll && n.querySelectorAll(selector).forEach(addRipple);
      });
    });
  });
  obs.observe(document.documentElement, {childList:true, subtree:true});
})();
</script>


<script>
// Header elevation on scroll & GNB slight translation
(function(){
  let lastY = 0;
  const onScroll = () => {
    const y = window.scrollY || document.documentElement.scrollTop;
    document.documentElement.classList.toggle('scrolled', y > 8);
    // optional gnb show/hide micro-shift
    const gnb = document.querySelector('.gnb');
    if(!gnb) return;
    if (y > lastY + 2) gnb.classList.add('hide'), gnb.classList.remove('show');
    else gnb.classList.add('show'), gnb.classList.remove('hide');
    lastY = y;
  };
  window.addEventListener('scroll', onScroll, {passive:true});
  onScroll();
})();
</script>


<script>
(function(){
  // 2.1 Logo: duplicate text into data-text for glossy overlay
  document.querySelectorAll('.ib-logo').forEach(el=>{
    el.setAttribute('data-text', el.textContent.trim());
  });

  // 2.2 Sticky-Compress: find likely section headers and mark them
  const candidates = Array.from(document.querySelectorAll('.section-header, .list h2, .list .section-title, .content h2, .content .section-title'));
  candidates.forEach(h => h.classList.add('sticky-compress'));

  // Scroll-driven compression
  const updateCompress = () => {
    const viewportTop = (document.scrollingElement || document.documentElement).scrollTop;
    candidates.forEach(h => {
      const rect = h.getBoundingClientRect();
      // distance from top; when near the top, compress gently to 0.92
      const d = Math.max(0, 1 - Math.min(1, (rect.top - (parseInt(getComputedStyle(h).top)||56)) / 48));
      const scale = 1 - (0.08 * d); // 1 -> 0.92
      h.style.setProperty('--compress-scale', scale.toFixed(3));
    });
  };
  window.addEventListener('scroll', updateCompress, {passive:true});
  window.addEventListener('resize', updateCompress);
  setTimeout(updateCompress, 0);

  // 2.3 FAB bounce: target add button
  const fab = document.getElementById('navAdd');
  if(fab){
    fab.addEventListener('click', ()=>{
      fab.classList.remove('fab-bounce');
      // restart animation
      void fab.offsetWidth;
      fab.classList.add('fab-bounce');
    });
  }
})();
</script>


<script>
(function(){
  // Platform detection for pressure tuning
  const ua = navigator.userAgent || navigator.vendor || window.opera || "";
  const isAndroid = /Android/i.test(ua);
  const isIOS = /iPhone|iPad|iPod/i.test(ua);
  if(isIOS) document.documentElement.classList.add('platform-ios');
  else if(isAndroid) document.documentElement.classList.add('platform-android');

  // Compression logic uses --compress-min/max
  const root = document.documentElement;
  const getVar = name => parseFloat(getComputedStyle(root).getPropertyValue(name));
  const minC = () => parseFloat(getComputedStyle(root).getPropertyValue('--compress-min')) || 0.96;
  const maxC = () => parseFloat(getComputedStyle(root).getPropertyValue('--compress-max')) || 0.98;

  const candidates = Array.from(document.querySelectorAll('.sticky-compress'));
  const updateCompress = () => {
    const maxScale = maxC(), minScale = minC();
    candidates.forEach(h => {
      const rect = h.getBoundingClientRect();
      const topPx = parseInt(getComputedStyle(h).top) || 56;
      // d: 0 (far) -> 1 (stuck)
      const d = Math.max(0, 1 - Math.min(1, (rect.top - topPx) / 48));
      const scale = maxScale - (maxScale - minScale) * d;
      h.style.setProperty('--compress-scale', scale.toFixed(3));
    });
  };
  window.addEventListener('scroll', updateCompress, {passive:true});
  window.addEventListener('resize', updateCompress);
  setTimeout(updateCompress, 0);

  // Utility to tweak at runtime from console if needed
  window.IBUX = {
    setCompressRange(min=0.96, max=0.98){
      root.style.setProperty('--compress-min', min);
      root.style.setProperty('--compress-max', max);
      updateCompress();
    },
    setStickyTop(px=56){
      root.style.setProperty('--sticky-top', px+'px');
      updateCompress();
    },
    setFabDuration(sec=.26){
      root.style.setProperty('--fab-dur', sec+'s');
    },
    setLogoGloss(angle='180deg', top='16%'){
      root.style.setProperty('--logo-gloss-angle', angle);
      root.style.setProperty('--logo-gloss-top', top);
    }
  };
})();
</script>


<script>
(function(){
  if(window.__rippleInit) return; window.__rippleInit = true;
  const selector = 'button, .btn, .vbtn, .menu-item, .tab-btn, .chip, .lnb a, .gnb a';
  function addRipple(el){
    if(!el.classList.contains('fx-ripple')) el.classList.add('fx-ripple');
    el.addEventListener('click', function(e){
      const r = document.createElement('span');
      r.className = 'rpl';
      const rect = this.getBoundingClientRect();
      r.style.left = (e.clientX - rect.left) + 'px';
      r.style.top  = (e.clientY - rect.top)  + 'px';
      this.appendChild(r);
      setTimeout(()=>r.remove(), 650);
    }, {passive:true});
  }
  document.querySelectorAll(selector).forEach(addRipple);
  const obs = new MutationObserver(muts => muts.forEach(m => {
    m.addedNodes.forEach(n => {
      if(!(n instanceof HTMLElement)) return;
      if(n.matches && n.matches(selector)) addRipple(n);
      n.querySelectorAll && n.querySelectorAll(selector).forEach(addRipple);
    });
  }));
  obs.observe(document.documentElement, {childList:true, subtree:true});
})();
</script>

</body>

</html>