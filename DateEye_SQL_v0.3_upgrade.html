<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DateEye SQL Professional - v1.0 Advanced Validation Engine</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #f5f7fa;
            color: #2d3748;
            height: 100vh;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò ÌÇ§ÌîÑÎ†àÏûÑ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Î¶¨Ìîå Ìö®Í≥º */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(33, 150, 243, 0.4);
            transform: scale(0);
            animation: ripple 0.6s ease-out;
            pointer-events: none;
        }

        /* Îã§ÌÅ¨Î™®Îìú Ïä§ÌÉÄÏùº - ÏôÑÎ≤ΩÌïú Î∞òÏ†Ñ */
        body.dark-mode {
            background-color: #000000;
            color: #ffffff;
        }

        body.dark-mode .menu-bar,
        body.dark-mode .toolbar,
        body.dark-mode .sidebar,
        body.dark-mode .editor-area,
        body.dark-mode .result-panel,
        body.dark-mode .properties-panel,
        body.dark-mode .status-bar {
            background: #000000;
            color: #ffffff;
            border-color: #3a3a3a;
        }

        body.dark-mode .menu-item,
        body.dark-mode .dropdown-item,
        body.dark-mode .tree-item {
            color: #ffffff;
        }

        body.dark-mode .menu-item:hover,
        body.dark-mode .dropdown-item:hover,
        body.dark-mode .tree-item:hover {
            background: #1a1a1a;
        }

        body.dark-mode .toolbar-btn {
            background: #0a0a0a;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .toolbar-btn:hover {
            background: #1a1a1a;
            border-color: #2196F3;
        }

        body.dark-mode .editor,
        body.dark-mode .result-grid,
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea {
            background: #000000;
            color: #ffffff;
            border-color: #3a3a3a;
        }

        body.dark-mode .tab {
            background: #000000;
            color: #999999;
            border-color: #3a3a3a;
        }

        body.dark-mode .tab.active {
            background: #0a0a0a;
            color: #2196F3;
            border-bottom-color: #2196F3;
        }

        body.dark-mode .tab:hover {
            background: #0a0a0a;
        }

        body.dark-mode .tab-bar {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .line-numbers {
            background: #0a0a0a;
            color: #666666;
            border-color: #3a3a3a;
        }

        body.dark-mode .result-grid th {
            background: #0a0a0a;
            color: #ffffff;
        }

        body.dark-mode .result-grid td,
        body.dark-mode .result-grid th {
            border-color: #3a3a3a;
        }

        body.dark-mode .result-grid tr:hover {
            background: #0a0a0a;
        }

        body.dark-mode .result-tabs {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .result-tab {
            color: #999999;
        }

        body.dark-mode .result-tab.active {
            color: #2196F3;
            border-bottom-color: #2196F3;
        }

        body.dark-mode .result-content {
            background: #000000;
        }

        body.dark-mode .sidebar-header,
        body.dark-mode .properties-header {
            background: #0a0a0a;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .search-container {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .search-input {
            background: #0a0a0a;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .search-icon,
        body.dark-mode .clear-search {
            color: #666666;
        }

        body.dark-mode .tree-item.selected {
            background: #1a1a1a;
            color: #2196F3;
        }

        body.dark-mode .dropdown-menu {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .context-menu {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .context-menu-item {
            color: #ffffff;
        }

        body.dark-mode .context-menu-item:hover {
            background: #1a1a1a;
        }

        body.dark-mode .context-menu-separator {
            background: #3a3a3a;
        }

        body.dark-mode .property-label {
            color: #999999;
        }

        body.dark-mode .property-value {
            color: #ffffff;
        }

        body.dark-mode .property-item {
            border-color: #1a1a1a;
        }

        body.dark-mode .dark-mode-toggle {
            background: #0a0a0a;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .dark-mode-toggle:hover {
            background: #1a1a1a;
        }

        body.dark-mode .modal-content {
            background: #000000;
            color: #ffffff;
        }

        body.dark-mode .modal-header,
        body.dark-mode .modal-footer {
            border-color: #3a3a3a;
        }

        body.dark-mode .modal-title {
            color: #ffffff;
        }

        body.dark-mode .modal-close {
            color: #999999;
        }

        body.dark-mode .modal-close:hover {
            background: #1a1a1a;
            color: #ffffff;
        }

        body.dark-mode .form-label {
            color: #ffffff;
        }

        body.dark-mode .form-control {
            background: #0a0a0a;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .designer-table th {
            background: #0a0a0a;
            color: #ffffff;
        }

        body.dark-mode .designer-table td,
        body.dark-mode .designer-table th {
            border-color: #3a3a3a;
        }

        body.dark-mode .designer-table input[type="text"],
        body.dark-mode .designer-table select {
            background: #000000;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        body.dark-mode .btn-secondary {
            background: #0a0a0a;
            color: #ffffff;
            border-color: #3a3a3a;
        }

        body.dark-mode .btn-secondary:hover {
            background: #1a1a1a;
        }

        body.dark-mode .dropdown-separator {
            background: #3a3a3a;
        }

        body.dark-mode .toolbar-separator {
            background: #3a3a3a;
        }

        body.dark-mode .shortcut {
            color: #666666;
        }

        body.dark-mode .tab-close {
            color: #666666;
        }

        body.dark-mode .tab-close:hover {
            background: #1a1a1a;
            color: #ffffff;
        }

        body.dark-mode .folder-icon {
            color: #2196F3;
        }

        /* Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà */
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* ÏÉÅÎã® Î©îÎâ¥Î∞î */
        .menu-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0;
            display: flex;
            align-items: center;
            height: 30px;
            position: relative;
            z-index: 9999;
        }

        .menu-item {
            padding: 5px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            position: relative;
            color: #4a5568;
            z-index: 10000;
        }

        .menu-item:hover {
            background: #f7fafc;
            color: #2b6cb0;
            transform: translateY(-1px);
        }

        /* ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥ */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #cbd5e0;
            min-width: 200px;
            display: none;
            z-index: 99999;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 8px;
            animation: slideDown 0.2s ease-out;
        }

        .menu-item:hover .dropdown-menu {
            display: block;
        }

        .dropdown-item {
            padding: 8px 15px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #2d3748;
            transition: all 0.2s ease;
        }

        .dropdown-item:hover {
            background: #f7fafc;
            color: #2b6cb0;
            padding-left: 20px;
        }

        .shortcut {
            font-size: 11px;
            color: #a0aec0;
            margin-left: 20px;
        }

        .dropdown-separator {
            height: 1px;
            background: #e2e8f0;
            margin: 5px 0;
        }

        /* Ìà¥Î∞î */
        .toolbar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 8px 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            flex-wrap: wrap;
            position: relative;
            z-index: 10;
        }

        .toolbar-btn {
            background: white;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 5px;
            color: #4a5568;
            position: relative;
            overflow: hidden;
        }

        .toolbar-btn:hover {
            background: #f7fafc;
            border-color: #2b6cb0;
            color: #2b6cb0;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .toolbar-btn:active {
            transform: translateY(0);
        }

        .toolbar-separator {
            width: 1px;
            height: 24px;
            background: #e2e8f0;
            margin: 0 5px;
        }

        .dark-mode-toggle {
            background: white;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            margin-left: auto;
        }

        body.dark-mode .dark-mode-toggle {
            background: #000000;
            border-color: #3a3a3a;
            color: #ffffff;
        }

        /* Î©îÏù∏ Ïª®ÌÖêÏ∏† ÏòÅÏó≠ */
        .workspace {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 12px 15px;
            background: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            font-size: 13px;
            color: #2d3748;
        }

        .search-container {
            padding: 10px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-icon {
            position: absolute;
            left: 10px;
            color: #a0aec0;
            font-size: 18px;
        }

        .search-input {
            width: 100%;
            padding: 6px 30px 6px 35px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 13px;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
            transform: scale(1.01);
        }

        .clear-search {
            position: absolute;
            right: 10px;
            cursor: pointer;
            color: #a0aec0;
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .clear-search:hover {
            color: #4a5568;
            transform: scale(1.2);
        }

        .tree-view {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .tree-item {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            user-select: none;
            border-radius: 6px;
            margin-bottom: 2px;
            color: #2d3748;
            transition: all 0.2s ease;
        }

        .tree-item:hover {
            background: #f7f7f7;
            padding-left: 16px;
            transform: translateX(2px);
        }

        .tree-item.selected {
            background: #f7f7f7;
            color: #2b6cb0;
            font-weight: 500;
        }

        .folder-icon {
            width: 22px;
            height: 22px;
            color: #2B6CB0;
            flex-shrink: 0;
        }

        .folder-icon-svg {
            fill: currentColor;
        }

        .tree-item.collapsed::before {
            content: '+';
            font-weight: bold;
            margin-right: 5px;
        }

        .tree-item.expanded::before {
            content: '‚àí';
            font-weight: bold;
            margin-right: 5px;
        }

        .tree-children {
            margin-left: 20px;
            display: none;
        }

        .tree-children.show {
            display: block;
        }

        /* ÏóêÎîîÌÑ∞ ÏòÅÏó≠ */
        .editor-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f5f7fa;
            min-width: 0;
        }

        .tab-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            overflow-x: auto;
            position: relative;
            z-index: 50;
        }

        .tab {
            padding: 10px 30px 10px 15px;
            background: white;
            border-right: 1px solid #e2e8f0;
            cursor: pointer;
            font-size: 13px;
            white-space: nowrap;
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #718096;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #f7f7f7;
            border-bottom: 2px solid #2b6cb0;
            color: #2b6cb0;
            font-weight: 500;
        }

        .tab:hover {
            background: #f7f7f7;
            transform: translateY(-2px);
        }

        .tab-close {
            position: absolute;
            right: 8px;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            font-size: 16px;
            color: #a0aec0;
            transition: all 0.2s ease;
        }

        .tab-close:hover {
            background: #e2e8f0;
            color: #2b6cb0;
            transform: scale(1.2);
        }

        .tab-name {
            cursor: pointer;
        }

        .tab-name:hover {
            text-decoration: underline;
        }

        /* ÏóêÎîîÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà - Ïä§ÌÅ¨Î°§ Î≤ÑÍ∑∏ ÏàòÏ†ï */
        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: row;
            overflow: hidden;
            min-height: 0;
        }

        /* v0.6: ÎùºÏù∏ ÎÑòÎ≤Ñ ÏôÑÎ≤Ω Ï†ïÎ†¨ */
        .line-numbers {
            width: 50px;
            background: #f7fafc;
            border-right: 1px solid #e2e8f0;
            padding-top: 16px;
            padding-bottom: 16px;
            padding-left: 5px;
            padding-right: 5px;
            text-align: right;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 22.4px;
            color: #a0aec0;
            user-select: none;
            overflow: hidden;
        }

        .line-numbers div {
            height: 22.4px;
            line-height: 22.4px;
        }

        /* Ïä§ÌÅ¨Î°§ Î≤ÑÍ∑∏ ÏàòÏ†ï: editorÏóê Î™ÖÏãúÏ†Å ÌÅ¨Í∏∞ Î∞è Ïä§ÌÅ¨Î°§ ÏÑ§Ï†ï */
        .editor {
            flex: 1;
            min-width: 0;
            border: none;
            padding: 16px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 22.4px;
            resize: none;
            outline: none;
            background: white;
            color: #2d3748;
            overflow-y: scroll !important;
            overflow-x: auto;
            height: 100%;
            width: 100%;
        }

        /* Í≤ÄÏ¶ù Ìå®ÎÑê */
        .validation-panel {
            display: none;
            max-height: 150px;
            overflow-y: auto;
            border-top: 1px solid #e2e8f0;
            background: #f7fafc;
        }

        .validation-result {
            padding: 8px 12px;
        }

        .validation-item {
            padding: 6px 10px;
            margin: 4px 0;
            border-radius: 4px;
            font-size: 12px;
            border-left: 3px solid;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .validation-item.error {
            background: #fff5f5;
            border-color: #fc8181;
            color: #c53030;
        }

        .validation-item.warning {
            background: #fffaf0;
            border-color: #f6ad55;
            color: #c05621;
        }

        .validation-item.success {
            background: #f0fff4;
            border-color: #68d391;
            color: #276749;
        }

        .validation-item.info {
            background: #ebf8ff;
            border-color: #63b3ed;
            color: #2c5282;
        }

        body.dark-mode .validation-panel {
            background: #0a0a0a;
            border-color: #3a3a3a;
        }

        body.dark-mode .validation-item.error {
            background: #2e0a0a;
            border-color: #5e1a1a;
        }

        body.dark-mode .validation-item.warning {
            background: #2e1a0a;
            border-color: #5e3a1a;
        }

        body.dark-mode .validation-item.success {
            background: #0a2e0a;
            border-color: #1a5e1a;
        }

        body.dark-mode .validation-item.info {
            background: #0a0a2e;
            border-color: #1a1a5e;
        }

        body.dark-mode .validation-panel {
            background: #0a0a0a;
            border-color: #3a3a3a;
        }

        body.dark-mode .validation-item.error {
            background: #2e0a0a;
            border-color: #5e1a1a;
            color: #ff6b6b;
        }

        body.dark-mode .validation-item.warning {
            background: #2e1a0a;
            border-color: #5e3a1a;
            color: #ffa94d;
        }

        body.dark-mode .validation-item.success {
            background: #0a2e0a;
            border-color: #1a5e1a;
            color: #51cf66;
        }

        body.dark-mode .validation-item.info {
            background: #0a0a2e;
            border-color: #1a1a5e;
            color: #4dabf7;
        }

        /* Í≤∞Í≥º Ìå®ÎÑê */
        .result-panel {
            height: 300px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .result-tabs {
            display: flex;
            background: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 8px;
        }

        .result-tab {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 13px;
            border-bottom: 2px solid transparent;
            color: #718096;
            transition: all 0.3s ease;
        }

        .result-tab.active {
            color: #2b6cb0;
            border-bottom-color: #2b6cb0;
            font-weight: 500;
        }

        .result-tab:hover {
            color: #2d3748;
            transform: translateY(-2px);
        }

        .result-content {
            flex: 1;
            overflow: auto;
            padding: 12px;
        }

        /* v0.6: Í≤∞Í≥º Ï†ïÎ≥¥ Ìå®ÎÑê */
        .result-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 6px;
            padding: 10px 15px;
            margin-bottom: 15px;
            font-size: 13px;
            display: none;
        }

        .result-info.show {
            display: block;
        }

        .result-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .result-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .result-info-label {
            font-weight: 600;
            color: #0369a1;
        }

        .result-info-value {
            color: #075985;
        }

        body.dark-mode .result-info {
            background: #0a0a0a;
            border-color: #3a3a3a;
        }

        body.dark-mode .result-info-label {
            color: #4dabf7;
        }

        body.dark-mode .result-info-value {
            color: #74c0fc;
        }

        body.dark-mode .result-info-item .material-icons {
            color: #4dabf7;
        }

        .result-grid {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .result-grid th {
            background: #f7fafc;
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            color: #4a5568;
        }

        .result-grid td {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }

        .result-grid tr {
            transition: all 0.2s ease;
        }

        .result-grid tr:hover {
            background: #f7fafc;
            transform: scale(1.005);
        }

        /* ÏÜçÏÑ± Ìå®ÎÑê */
        .properties-panel {
            width: 250px;
            background: white;
            border-left: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .properties-header {
            padding: 12px 15px;
            background: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            font-size: 13px;
            color: #2d3748;
        }

        .properties-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .property-item {
            padding: 8px 0;
            border-bottom: 1px solid #f7fafc;
            transition: all 0.2s ease;
        }

        .property-item:hover {
            transform: translateX(-4px);
            background: #f9fafb;
        }

        .property-label {
            font-size: 12px;
            color: #718096;
            margin-bottom: 4px;
            transition: color 0.2s ease;
        }

        .property-item:hover .property-label {
            color: #2b6cb0;
        }

        .property-value {
            font-size: 13px;
            color: #2d3748;
            font-weight: 500;
        }

        body.dark-mode .property-label {
            color: #999999;
        }

        body.dark-mode .property-value {
            color: #ffffff;
        }

        /* ÏÉÅÌÉúÎ∞î */
        .status-bar {
            height: 25px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 20px;
            font-size: 12px;
            color: #718096;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Ïä§ÌÅ¨Î°§Î∞î */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        body.dark-mode ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        body.dark-mode ::-webkit-scrollbar-thumb {
            background: #3a3a3a;
        }

        /* Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ */
        .context-menu {
            position: fixed;
            background: white;
            border: 1px solid #cbd5e0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 8px;
            min-width: 180px;
            z-index: 10000;
            display: none;
            animation: scaleIn 0.15s ease-out;
        }

        .context-menu-item {
            padding: 8px 15px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #2d3748;
            transition: all 0.2s ease;
        }

        .context-menu-item:hover {
            background: #f7fafc;
            color: #2b6cb0;
            padding-left: 20px;
        }

        .context-menu-separator {
            height: 1px;
            background: #e2e8f0;
            margin: 5px 0;
        }

        body.dark-mode .context-menu {
            background: #000000;
            border-color: #3a3a3a;
        }

        body.dark-mode .context-menu-item {
            color: #ffffff;
        }

        body.dark-mode .context-menu-item:hover {
            background: #1a1a1a;
        }

        /* Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: scaleIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
        }

        .modal-close {
            cursor: pointer;
            font-size: 24px;
            color: #718096;
            background: none;
            border: none;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: #f7fafc;
            color: #2d3748;
            transform: scale(1.1) rotate(90deg);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: #2196F3;
            color: white;
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .btn-secondary:active {
            transform: translateY(0);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 13px;
            color: #2d3748;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
            transform: scale(1.01);
        }

        .designer-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .designer-table th,
        .designer-table td {
            padding: 8px;
            border: 1px solid #e2e8f0;
            font-size: 13px;
        }

        .designer-table th {
            background: #f7fafc;
            font-weight: 600;
            text-align: left;
            white-space: nowrap;
        }

        .designer-table input[type="text"],
        .designer-table select {
            width: 100%;
            padding: 4px 8px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-size: 13px;
        }

        /* Ï∂îÍ∞Ä Îã§ÌÅ¨Î™®Îìú Ïä§ÌÉÄÏùº */
        body.dark-mode .editor::placeholder,
        body.dark-mode .search-input::placeholder,
        body.dark-mode .form-control::placeholder {
            color: #666666;
        }

        body.dark-mode .workspace {
            background: #000000;
        }

        body.dark-mode #editorContainer {
            background: #000000;
        }

        body.dark-mode .editor-container {
            background: #000000;
        }

        body.dark-mode p {
            color: #999999;
        }

        body.dark-mode h3 {
            color: #ffffff;
        }
    
        /* ===== Easy Mode ===== */
        body.easy-mode .easy-hide {
            display: none !important;
        }
        body.easy-mode .toolbar-btn.primary-action {
            border-color: #2b6cb0;
            box-shadow: 0 0 0 2px rgba(43,108,176,0.15);
        }
        /* Emphasize the Execute button in Easy mode */
        body.easy-mode #executeBtn {
            background: #2196F3;
            color: #ffffff;
            border-color: #2196F3;
        }
        body.easy-mode #executeBtn:hover {
            background: #1976D2;
        }
        /* Slightly calmer canvas for easy mode */
        body.easy-mode .editor-area { background: #f8fafc; }

    </style>
</head>
<body>
    <div class="main-container">
        <!-- Î©îÎâ¥Î∞î -->
        <div class="menu-bar">
            <div class="menu-item">
                ÌååÏùº
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="newQuery()">
                        <span>ÏÉà ÏøºÎ¶¨</span>
                        <span class="shortcut">Ctrl+N</span>
                    </div>
                    <div class="dropdown-item" onclick="openQuery()">
                        <span>ÏøºÎ¶¨ Ïó¥Í∏∞</span>
                        <span class="shortcut">Ctrl+O</span>
                    </div>
                    <div class="dropdown-item" onclick="saveQuery()">
                        <span>ÏøºÎ¶¨ Ï†ÄÏû•</span>
                        <span class="shortcut">Ctrl+S</span>
                    </div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" onclick="exportResults()">
                        <span>Í≤∞Í≥º ÎÇ¥Î≥¥ÎÇ¥Í∏∞</span>
                        <span class="shortcut">Ctrl+Shift+E</span>
                    </div>
                </div>
            </div>
            <div class="menu-item">
                Ìé∏Ïßë
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="document.execCommand('undo')">
                        <span>Ïã§Ìñâ Ï∑®ÏÜå</span>
                        <span class="shortcut">Ctrl+Z</span>
                    </div>
                    <div class="dropdown-item" onclick="document.execCommand('redo')">
                        <span>Îã§Ïãú Ïã§Ìñâ</span>
                        <span class="shortcut">Ctrl+Y</span>
                    </div>
                </div>
            </div>
            <div class="menu-item">
                ÏøºÎ¶¨
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="executeQuery()">
                        <span>Ïã§Ìñâ</span>
                        <span class="shortcut">F5</span>
                    </div>
                    <div class="dropdown-item" onclick="formatSQL()">
                        <span>SQL Ìè¨Îß∑</span>
                        <span class="shortcut">Ctrl+Shift+F</span>
                    </div>
                    <div class="dropdown-item" onclick="validateQuery()">
                        <span>ÏøºÎ¶¨ Í≤ÄÏ¶ù</span>
                        <span class="shortcut">Ctrl+Shift+V</span>
                    </div>
                </div>
            </div>
            <div class="menu-item">
                ÎèÑÍµ¨
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="showTableDesigner()">
                        <span>ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà</span>
                    </div>
                </div>
            </div>
            <div class="menu-item">
                Î≥¥Í∏∞
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="toggleSidebar()">
                        <span>DB ÌÉêÏÉâÍ∏∞</span>
                    </div>
                    <div class="dropdown-item" onclick="toggleProperties()">
                        <span>ÏÜçÏÑ± Ìå®ÎÑê</span>
                    </div>
                </div>
            </div>
            <div class="menu-item">
                ÎèÑÏõÄÎßê
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="showAbout()">
                        <span>Ï†ïÎ≥¥</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ìà¥Î∞î -->
        <div class="toolbar">
            <button class="toolbar-btn" onclick="newQuery()" title="ÏÉà ÏøºÎ¶¨ (Ctrl+N)">
                <span class="material-icons">note_add</span>
                <span>ÏÉàÎ°ú ÎßåÎì§Í∏∞</span>
            </button>
            <button class="toolbar-btn" onclick="openQuery()" title="ÏøºÎ¶¨ Ïó¥Í∏∞ (Ctrl+O)">
                <span class="material-icons">folder_open</span>
                <span>Ïó¥Í∏∞</span>
            </button>
            <button class="toolbar-btn" onclick="saveQuery()" title="ÏøºÎ¶¨ Ï†ÄÏû• (Ctrl+S)">
                <span class="material-icons">save</span>
                <span>Ï†ÄÏû•</span>
            </button>
            
            <div class="toolbar-separator"></div>
            
            <button class="toolbar-btn" onclick="executeQuery()" title="Ïã§Ìñâ (F5)">
                <span class="material-icons">play_arrow</span>
                <span>Ïã§Ìñâ</span>
            </button>
            <button class="toolbar-btn" onclick="formatSQL()" title="SQL Ìè¨Îß∑ (Ctrl+Shift+F)">
                <span class="material-icons">format_align_left</span>
                <span>Ìè¨Îß∑</span>
            </button>
            <button class="toolbar-btn" onclick="validateQuery()" title="ÏøºÎ¶¨ Í≤ÄÏ¶ù (Ctrl+Shift+V)">
                <span class="material-icons">check_circle</span>
                <span>Í≤ÄÏ¶ù</span>
            </button>
            <button class="toolbar-btn" onclick="clearEditor()" title="ÏøºÎ¶¨Ï∞Ω ÏßÄÏö∞Í∏∞ (Ctrl+Shift+C)">
                <span class="material-icons">delete_sweep</span>
                <span>ÏßÄÏö∞Í∏∞</span>
            </button>
            
            <div class="toolbar-separator"></div>
            
            <button class="toolbar-btn" onclick="showTableDesigner()" title="ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà">
                <span class="material-icons">table_chart</span>
                <span>ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà</span>
            </button>
            
            
            <button class="toolbar-btn" id="modeToggleBtn" onclick="toggleUIMode()" title="Î™®Îìú Ï†ÑÌôò (easy mode / default mode)">
                <span class="material-icons">tune</span>
                <span id="modeToggleLabel">easy mode</span>
            </button>
<button class="dark-mode-toggle" onclick="toggleDarkMode()" title="Îã§ÌÅ¨Î™®Îìú Ï†ÑÌôò">
                <span class="material-icons" id="darkModeIcon">dark_mode</span>
            </button>
        </div>

        <!-- ÏûëÏóÖ Í≥µÍ∞Ñ -->
        <div class="workspace">
            <!-- ÏôºÏ™Ω ÏÇ¨Ïù¥ÎìúÎ∞î -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÌÉêÏÉâÍ∏∞</div>
                
                <div class="search-container">
                    <div class="search-wrapper">
                        <span class="material-icons search-icon">search</span>
                        <input type="text" 
                               class="search-input" 
                               id="dbSearchInput" 
                               placeholder="Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í≤ÄÏÉâ..." 
                               oninput="filterDatabaseTree(this.value)">
                        <span class="material-icons clear-search" onclick="clearSearch()">close</span>
                    </div>
                </div>
                
                <div class="tree-view">
                    <div class="tree-item collapsed" onclick="toggleTreeItem(this)">
                        <svg class="folder-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path class="folder-icon-svg" d="M12,3C7.58,3 4,4.79 4,7C4,9.21 7.58,11 12,11C16.42,11 20,9.21 20,7C20,4.79 16.42,3 12,3M4,9V12C4,14.21 7.58,16 12,16C16.42,16 20,14.21 20,12V9C20,11.21 16.42,13 12,13C7.58,13 4,11.21 4,9M4,14V17C4,19.21 7.58,21 12,21C16.42,21 20,19.21 20,17V14C20,16.21 16.42,18 12,18C7.58,18 4,16.21 4,14Z"/>
                        </svg>
                        <span>ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§</span>
                    </div>
                    <div class="tree-children">
                        <div class="tree-item collapsed" onclick="toggleTreeItem(this)">
                            <svg class="folder-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path class="folder-icon-svg" d="M12,3C7.58,3 4,4.79 4,7C4,9.21 7.58,11 12,11C16.42,11 20,9.21 20,7C20,4.79 16.42,3 12,3M4,9V12C4,14.21 7.58,16 12,16C16.42,16 20,14.21 20,12V9C20,11.21 16.42,13 12,13C7.58,13 4,11.21 4,9M4,14V17C4,19.21 7.58,21 12,21C16.42,21 20,19.21 20,17V14C20,16.21 16.42,18 12,18C7.58,18 4,16.21 4,14Z"/>
                            </svg>
                            <span>ÌÖåÏù¥Î∏î</span>
                        </div>
                        <div class="tree-children">
                            <div class="tree-item" onclick="selectItem(this, 'users')">
                                <span style="width: 22px; text-align: center;">‚îî</span>
                                <span>users</span>
                            </div>
                            <div class="tree-item" onclick="selectItem(this, 'orders')">
                                <span style="width: 22px; text-align: center;">‚îî</span>
                                <span>orders</span>
                            </div>
                            <div class="tree-item" onclick="selectItem(this, 'products')">
                                <span style="width: 22px; text-align: center;">‚îî</span>
                                <span>products</span>
                            </div>
                        </div>
                        <div class="tree-item collapsed" onclick="toggleTreeItem(this)">
                            <svg class="folder-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path class="folder-icon-svg" d="M12,3C7.58,3 4,4.79 4,7C4,9.21 7.58,11 12,11C16.42,11 20,9.21 20,7C20,4.79 16.42,3 12,3M4,9V12C4,14.21 7.58,16 12,16C16.42,16 20,14.21 20,12V9C20,11.21 16.42,13 12,13C7.58,13 4,11.21 4,9M4,14V17C4,19.21 7.58,21 12,21C16.42,21 20,19.21 20,17V14C20,16.21 16.42,18 12,18C7.58,18 4,16.21 4,14Z"/>
                            </svg>
                            <span>Î∑∞</span>
                        </div>
                        <div class="tree-children">
                            <div class="tree-item" onclick="selectItem(this, 'user_orders')">
                                <span style="width: 22px; text-align: center;">‚îî</span>
                                <span>user_orders</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ï§ëÏïô ÏóêÎîîÌÑ∞ ÏòÅÏó≠ -->
            <div class="editor-area">
                <div class="tab-bar" id="tabBar">
                    <!-- ÌÉ≠Îì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê® -->
                </div>

                <div id="editorContainer" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; min-height: 0;">
                    <!-- ÏóêÎîîÌÑ∞Îì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê® -->
                </div>

                <!-- Í≤∞Í≥º Ìå®ÎÑê -->
                <div class="result-panel" id="resultPanel">
                    <div class="result-tabs">
                        <div class="result-tab active" data-tab="data" onclick="switchResultTab('data')">Îç∞Ïù¥ÌÑ∞</div>
                        <div class="result-tab" data-tab="messages" onclick="switchResultTab('messages')">Î©îÏãúÏßÄ</div>
                        <div class="result-tab" data-tab="history" onclick="switchResultTab('history')">Ïã§Ìñâ Í∏∞Î°ù</div>
                    </div>
                    <div class="result-content" id="resultContent">
                        <!-- Í≤∞Í≥º Ï†ïÎ≥¥ Ìå®ÎÑê -->
                        <div class="result-info" id="resultInfo">
                            <div class="result-info-grid">
                                <div class="result-info-item">
                                    <span class="material-icons" style="font-size: 16px;">table_rows</span>
                                    <span class="result-info-label">Ìñâ Ïàò:</span>
                                    <span class="result-info-value" id="infoRowCount">-</span>
                                </div>
                                <div class="result-info-item">
                                    <span class="material-icons" style="font-size: 16px;">view_column</span>
                                    <span class="result-info-label">Ïó¥ Ïàò:</span>
                                    <span class="result-info-value" id="infoColumnCount">-</span>
                                </div>
                                <div class="result-info-item">
                                    <span class="material-icons" style="font-size: 16px;">schedule</span>
                                    <span class="result-info-label">Ïã§Ìñâ ÏãúÍ∞Ñ:</span>
                                    <span class="result-info-value" id="infoExecutionTime">-</span>
                                </div>
                                <div class="result-info-item">
                                    <span class="material-icons" style="font-size: 16px;">memory</span>
                                    <span class="result-info-label">Î©îÎ™®Î¶¨:</span>
                                    <span class="result-info-value" id="infoMemoryUsage">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <div id="resultGrid">
                            <p style="color: #a0aec0; text-align: center; margin-top: 50px;">ÏøºÎ¶¨Î•º Ïã§ÌñâÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ïò§Î•∏Ï™Ω ÏÜçÏÑ± Ìå®ÎÑê -->
            <div class="properties-panel" id="propertiesPanel">
                <div class="properties-header">ÏÜçÏÑ±</div>
                <div class="properties-content">
                    <div class="property-item">
                        <div class="property-label">Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§</div>
                        <div class="property-value">ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§</div>
                    </div>
                    <div class="property-item">
                        <div class="property-label">Ïó∞Í≤∞ ÏÉÅÌÉú</div>
                        <div class="property-value">üü¢ Ïó∞Í≤∞Îê®</div>
                    </div>
                    <div class="property-item">
                        <div class="property-label">ÏÑúÎ≤Ñ</div>
                        <div class="property-value">localhost:3306</div>
                    </div>
                    <div class="property-item">
                        <div class="property-label">ÏÇ¨Ïö©Ïûê</div>
                        <div class="property-value">admin</div>
                    </div>
                    <div class="property-item">
                        <div class="property-label">Î¨∏Ïûê ÏßëÌï©</div>
                        <div class="property-value">utf8mb4</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏÉÅÌÉúÎ∞î -->
        <div class="status-bar">
            <div class="status-item">
                <span>Ï§Ñ: <span id="lineNumber">1</span></span>
            </div>
            <div class="status-item">
                <span>Ïó¥: <span id="columnNumber">1</span></span>
            </div>
            <div class="status-item">
                <span>ÏÑ†ÌÉù: <span id="selectionInfo">0</span></span>
            </div>
            <div class="status-item">
                <span id="statusMessage">Ï§ÄÎπÑ</span>
            </div>
        </div>
    </div>

    <!-- Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="executeQuery()">
            <span>Ïã§Ìñâ</span>
            <span class="shortcut">F5</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="formatSQL()">
            <span>SQL Ìè¨Îß∑</span>
            <span class="shortcut">Ctrl+Shift+F</span>
        </div>
        <div class="context-menu-item" onclick="validateQuery()">
            <span>ÏøºÎ¶¨ Í≤ÄÏ¶ù</span>
            <span class="shortcut">Ctrl+Shift+V</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="commentCode()">
            <span>Ï£ºÏÑù Ï≤òÎ¶¨</span>
            <span class="shortcut">Ctrl+/</span>
        </div>
    </div>

    <!-- ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà Î™®Îã¨ -->
    <div class="modal" id="tableDesignerModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà</div>
                <button class="modal-close" onclick="closeModal('tableDesignerModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÌÖåÏù¥Î∏î Ïù¥Î¶Ñ</label>
                    <input type="text" class="form-control" id="tableName" placeholder="Ïòà: users">
                </div>
                <table class="designer-table">
                    <thead>
                        <tr>
                            <th>Ïª¨ÎüºÎ™Ö</th>
                            <th>Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ</th>
                            <th>Í∏∏Ïù¥</th>
                            <th>Null ÌóàÏö©</th>
                            <th>Í∏∞Î≥∏Í∞í</th>
                            <th>PK</th>
                        </tr>
                    </thead>
                    <tbody id="columnDesigner">
                        <tr>
                            <td><input type="text" placeholder="id" value="id"></td>
                            <td>
                                <select>
                                    <option>INT</option>
                                    <option>BIGINT</option>
                                    <option>SMALLINT</option>
                                    <option>TINYINT</option>
                                    <option>VARCHAR</option>
                                    <option>CHAR</option>
                                    <option>TEXT</option>
                                    <option>MEDIUMTEXT</option>
                                    <option>LONGTEXT</option>
                                    <option>DATE</option>
                                    <option>DATETIME</option>
                                    <option>TIMESTAMP</option>
                                    <option>TIME</option>
                                    <option>BOOLEAN</option>
                                    <option>DECIMAL</option>
                                    <option>FLOAT</option>
                                    <option>DOUBLE</option>
                                    <option>BLOB</option>
                                    <option>JSON</option>
                                </select>
                            </td>
                            <td><input type="text" placeholder="11" value="11"></td>
                            <td style="text-align: center;"><input type="checkbox"></td>
                            <td><input type="text" placeholder="Ïòà: 0, 'value', NULL"></td>
                            <td style="text-align: center;"><input type="checkbox" checked></td>
                        </tr>
                    </tbody>
                </table>
                <button class="btn btn-secondary" onclick="addColumn()" style="margin-top: 10px;">
                    <span class="material-icons" style="font-size: 16px; vertical-align: middle;">add</span>
                    Ïª¨Îüº Ï∂îÍ∞Ä
                </button>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('tableDesignerModal')">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="generateCreateTable()">SQL ÏÉùÏÑ±</button>
            </div>
        </div>
    </div>

    <script>
        // ===== Ï†ÑÏó≠ Î≥ÄÏàò =====
        let tabs = {};
        let tabCounter = 0;
        let activeTabId = null;
        let isDarkMode = false;
        let queryHistory = [];

        // ===== Î¶¨Ìîå Ìö®Í≥º Ìï®Ïàò =====
        function createRipple(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            ripple.classList.add('ripple');
            
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            
            button.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 600);
        }

        // ===== Ï¥àÍ∏∞Ìôî =====
        window.onload = function() {
            newQuery();
            setupKeyboardShortcuts();
            
            // Î™®Îì† Î≤ÑÌäºÏóê Î¶¨Ìîå Ìö®Í≥º Ï∂îÍ∞Ä
            document.querySelectorAll('.toolbar-btn, .btn, .btn-primary, .btn-secondary').forEach(button => {
                button.addEventListener('click', createRipple);
            });
        };

        // ===== ÌÉ≠ Í¥ÄÎ¶¨ =====
        function newQuery() {
            tabCounter++;
            const tabId = tabCounter;
            const tabName = `Query ${tabCounter}`;
            
            tabs[tabId] = {
                name: tabName,
                content: '',
                saved: true
            };
            
            // ÌÉ≠ ÏÉùÏÑ±
            const tabBar = document.getElementById('tabBar');
            const tab = document.createElement('div');
            tab.className = 'tab active';
            tab.dataset.tabId = tabId;
            tab.innerHTML = `
                <span class="material-icons">description</span>
                <span class="tab-name" ondblclick="renameTab(${tabId})">${tabName}</span>
                <span class="material-icons tab-close" onclick="closeTab(event, ${tabId})">close</span>
            `;
            tab.onclick = function(e) {
                if (!e.target.classList.contains('tab-close') && !e.target.classList.contains('material-icons')) {
                    switchTab(tabId);
                }
            };
            tabBar.appendChild(tab);
            
            // ÏóêÎîîÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const editorContainer = document.getElementById('editorContainer');
            const editorWrapper = document.createElement('div');
            editorWrapper.id = `editor-wrapper-${tabId}`;
            editorWrapper.style.display = 'none';
            editorWrapper.style.flex = '1';
            editorWrapper.style.flexDirection = 'column';
            editorWrapper.style.minHeight = '0';
            editorWrapper.style.overflow = 'hidden';
            editorWrapper.innerHTML = `
                <div class="editor-container">
                    <div class="line-numbers" id="line-numbers-${tabId}">
                        <div>1</div>
                    </div>
                    <textarea 
                        class="editor" 
                        id="editor-${tabId}" 
                        placeholder="Ïó¨Í∏∞Ïóê SQL ÏøºÎ¶¨Î•º ÏûëÏÑ±ÌïòÏÑ∏Ïöî...

ÏòàÏ†ú:
SELECT * FROM users;
SELECT column1, column2 FROM table_name WHERE condition;
INSERT INTO table_name (column1, column2) VALUES (value1, value2);"
                        oninput="markTabAsUnsaved(${tabId}); syncLineNumbers(${tabId}); updateCursorPosition();"
                        onscroll="syncScroll(${tabId})"
                        onkeydown="handleEditorKeydown(event, ${tabId})"
                        oncontextmenu="showContextMenu(event)"
                    ></textarea>
                </div>
                <div class="validation-panel" id="validation-${tabId}"></div>
            `;
            editorContainer.appendChild(editorWrapper);
            
            switchTab(tabId);
        }

        function switchTab(tabId) {
            // Î™®Îì† ÌÉ≠ ÎπÑÌôúÏÑ±Ìôî
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Î™®Îì† ÏóêÎîîÌÑ∞ Ïà®Í∏∞Í∏∞
            document.querySelectorAll('[id^="editor-wrapper-"]').forEach(wrapper => {
                wrapper.style.display = 'none';
            });
            
            // ÏÑ†ÌÉùÌïú ÌÉ≠ ÌôúÏÑ±Ìôî
            const selectedTab = document.querySelector(`[data-tab-id="${tabId}"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Ìï¥Îãπ ÏóêÎîîÌÑ∞ ÌëúÏãú
            const editorWrapper = document.getElementById(`editor-wrapper-${tabId}`);
            if (editorWrapper) {
                editorWrapper.style.display = 'flex';
            }
            
            const editor = document.getElementById(`editor-${tabId}`);
            if (editor) {
                editor.value = tabs[tabId].content;
                editor.focus();
                // Ïä§ÌÅ¨Î°§ Í∞ïÏ†ú Ïû¨Í≥ÑÏÇ∞
                forceEditorReflow(editor);
            }
            
            activeTabId = tabId;
            syncLineNumbers(tabId);
            updateCursorPosition();
        }

        // Ïä§ÌÅ¨Î°§ Î≤ÑÍ∑∏ ÏàòÏ†ï: ÏóêÎîîÌÑ∞ reflow Í∞ïÏ†ú Ïã§Ìñâ
        function forceEditorReflow(editor) {
            if (!editor) return;
            setTimeout(() => {
                editor.scrollTop = editor.scrollTop;
                editor.style.overflowY = 'scroll';
            }, 0);
        }

        function closeTab(event, tabId) {
            event.stopPropagation();
            
            if (!tabs[tabId].saved) {
                if (!confirm('Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùÄ Î≥ÄÍ≤ΩÏÇ¨Ìï≠Ïù¥ ÏûàÏäµÎãàÎã§. Îã´ÏúºÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    return;
                }
            }
            
            const tab = document.querySelector(`[data-tab-id="${tabId}"]`);
            const editorWrapper = document.getElementById(`editor-wrapper-${tabId}`);
            
            if (tab) tab.remove();
            if (editorWrapper) editorWrapper.remove();
            delete tabs[tabId];
            
            const remainingTabs = Object.keys(tabs);
            if (remainingTabs.length === 0) {
                newQuery();
            } else if (activeTabId === tabId) {
                switchTab(parseInt(remainingTabs[0]));
            }
        }

        function renameTab(tabId) {
            const tab = document.querySelector(`[data-tab-id="${tabId}"]`);
            const nameSpan = tab.querySelector('.tab-name');
            const currentName = nameSpan.textContent;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentName;
            input.style.cssText = 'border: 1px solid #2196F3; padding: 2px 5px; border-radius: 3px; font-size: 13px; width: 100px;';
            
            nameSpan.replaceWith(input);
            input.focus();
            input.select();
            
            input.onkeydown = function(e) {
                if (e.key === 'Enter') {
                    saveTabName(tabId, input, currentName);
                } else if (e.key === 'Escape') {
                    cancelTabRename(tabId, input, currentName);
                }
            };
            
            input.onblur = function() {
                setTimeout(() => {
                    if (input.parentNode) {
                        saveTabName(tabId, input, currentName);
                    }
                }, 100);
            };
        }

        function saveTabName(tabId, input, fallbackName) {
            const newName = input.value.trim() || fallbackName;
            if (tabs[tabId]) tabs[tabId].name = newName;
            
            const span = document.createElement('span');
            span.className = 'tab-name';
            span.ondblclick = function() { renameTab(tabId); };
            span.textContent = newName;
            
            input.replaceWith(span);
        }

        function cancelTabRename(tabId, input, originalName) {
            const span = document.createElement('span');
            span.className = 'tab-name';
            span.ondblclick = function() { renameTab(tabId); };
            span.textContent = originalName;
            
            input.replaceWith(span);
        }

        function markTabAsUnsaved(tabId) {
            tabs[tabId].saved = false;
            const tab = document.querySelector(`[data-tab-id="${tabId}"]`);
            if (tab) {
                const nameSpan = tab.querySelector('.tab-name');
                if (nameSpan && !nameSpan.textContent.endsWith('*')) {
                    nameSpan.textContent = nameSpan.textContent + ' *';
                }
            }
        }

        // ===== ÎùºÏù∏ ÎÑòÎ≤Ñ ÎèôÍ∏∞Ìôî =====
        function syncLineNumbers(tabId) {
            const editor = document.getElementById(`editor-${tabId}`);
            const lineNumbers = document.getElementById(`line-numbers-${tabId}`);
            
            if (!editor || !lineNumbers) return;
            
            const text = editor.value;
            const lines = text.split('\n').length;
            const currentLines = lineNumbers.children.length;
            
            if (lines !== currentLines) {
                let html = '';
                for (let i = 1; i <= lines; i++) {
                    html += `<div>${i}</div>`;
                }
                lineNumbers.innerHTML = html;
            }
        }

        function syncScroll(tabId) {
            const editor = document.getElementById(`editor-${tabId}`);
            const lineNumbers = document.getElementById(`line-numbers-${tabId}`);
            
            if (!editor || !lineNumbers) return;
            
            lineNumbers.scrollTop = editor.scrollTop;
        }

        function handleEditorKeydown(event, tabId) {
            if (event.key === 'Tab') {
                event.preventDefault();
                const editor = event.target;
                const start = editor.selectionStart;
                const end = editor.selectionEnd;
                
                editor.value = editor.value.substring(0, start) + '    ' + editor.value.substring(end);
                editor.selectionStart = editor.selectionEnd = start + 4;
                
                syncLineNumbers(tabId);
            }
        }

        function updateCursorPosition() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            if (!editor) return;
            
            const text = editor.value.substring(0, editor.selectionStart);
            const lines = text.split('\n');
            const lineNumber = lines.length;
            const columnNumber = lines[lines.length - 1].length + 1;
            
            document.getElementById('lineNumber').textContent = lineNumber;
            document.getElementById('columnNumber').textContent = columnNumber;
            
            const selectionLength = editor.selectionEnd - editor.selectionStart;
            document.getElementById('selectionInfo').textContent = selectionLength > 0 ? selectionLength : '0';
            
            if (tabs[activeTabId]) {
                tabs[activeTabId].content = editor.value;
            }
        }

        // ===== ÏøºÎ¶¨Ï∞Ω ÏßÄÏö∞Í∏∞ =====
        function clearEditor() {
            if (!activeTabId) return;
            
            if (confirm('ÌòÑÏû¨ ÏøºÎ¶¨Î•º Î™®Îëê ÏßÄÏö∞ÏãúÍ≤†ÏäµÎãàÍπå?')) {
                const editor = document.getElementById(`editor-${activeTabId}`);
                if (editor) {
                    editor.value = '';
                    syncLineNumbers(activeTabId);
                    updateCursorPosition();
                    
                    if (tabs[activeTabId]) {
                        tabs[activeTabId].content = '';
                        markTabAsUnsaved(activeTabId);
                    }
                    
                    const validationPanel = document.getElementById(`validation-${activeTabId}`);
                    if (validationPanel) {
                        validationPanel.style.display = 'none';
                    }
                    
                    updateStatus('statusMessage', 'ÏøºÎ¶¨Í∞Ä ÏßÄÏõåÏ°åÏäµÎãàÎã§.');
                }
            }
        }

        // ===== ÏøºÎ¶¨ Í≤ÄÏ¶ù (Í≥†ÎèÑÌôî Î≤ÑÏ†Ñ) =====
        function validateQuery() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            const query = editor.value.trim();
            
            if (!query) {
                alert('Í≤ÄÏ¶ùÌï† ÏøºÎ¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            
            updateStatus('statusMessage', 'ÏøºÎ¶¨ Í≤ÄÏ¶ù Ï§ë...');
            
            const validation = performAdvancedValidation(query);
            showValidationResults(validation);
            
            if (validation.isValid) {
                updateStatus('statusMessage', '‚úì ÏøºÎ¶¨ Í≤ÄÏ¶ù ÏôÑÎ£å');
            } else {
                updateStatus('statusMessage', '‚úó ÏøºÎ¶¨Ïóê Ïò§Î•òÍ∞Ä ÏûàÏäµÎãàÎã§');
            }
        }

        // ===== Í≥†Í∏â SQL Í≤ÄÏ¶ù ÏóîÏßÑ (SQL Gate/DBeaver ÏàòÏ§Ä) - ÎåÄÌè≠ Í∞ïÌôîÎê® =====
        function performAdvancedValidation(query) {
            const results = {
                isValid: true,
                errors: [],
                warnings: [],
                suggestions: []
            };

            if (!query.trim()) {
                results.errors.push('ÏøºÎ¶¨Í∞Ä ÎπÑÏñ¥ÏûàÏäµÎãàÎã§.');
                results.isValid = false;
                return results;
            }

            // Ï£ºÏÑù Ï†úÍ±∞ (Í≤ÄÏ¶ùÏö©)
            const queryWithoutComments = removeComments(query);
            
            // ÌÜ†ÌÅ∞ Î∂ÑÏÑù
            const tokens = tokenizeSQL(queryWithoutComments);
            
            // 1. Í∏∞Î≥∏ Íµ¨Î¨∏ Í≤ÄÏ¶ù
            validateBasicSyntax(queryWithoutComments, results);
            
            // 2. SELECT Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
            validateSelectStatement(queryWithoutComments, tokens, results);
            
            // 3. INSERT Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
            validateInsertStatement(queryWithoutComments, tokens, results);
            
            // 4. UPDATE Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
            validateUpdateStatement(queryWithoutComments, tokens, results);
            
            // 5. DELETE Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
            validateDeleteStatement(queryWithoutComments, tokens, results);
            
            // 6. JOIN Ï†à Í≥†Í∏â Í≤ÄÏ¶ù
            validateJoinClauses(queryWithoutComments, results);
            
            // 7. WHERE Ï†à Í≥†Í∏â Í≤ÄÏ¶ù
            validateWhereClause(queryWithoutComments, results);
            
            // 8. Í¥ÑÌò∏/Îî∞Ïò¥Ìëú Îß§Ïπ≠ Í≤ÄÏ¶ù
            validateBalancedDelimiters(query, results);
            
            // 9. Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Î∞è Ìï®Ïàò Í≤ÄÏ¶ù
            validateDataTypesAndFunctions(queryWithoutComments, results);
            
            // 10. ÏÑ±Îä• ÏµúÏ†ÅÌôî Ï†úÏïà
            suggestPerformanceOptimizations(queryWithoutComments, results);
            
            // 11. Î≥¥Ïïà Ï∑®ÏïΩÏ†ê Í≤ÄÏÇ¨
            checkSecurityVulnerabilities(queryWithoutComments, results);
            
            // 12. ÏòàÏïΩÏñ¥ Î∞è ÏãùÎ≥ÑÏûê Í≤ÄÏ¶ù
            validateReservedWordsAndIdentifiers(queryWithoutComments, tokens, results);
            
            // ===== Ï∂îÍ∞Ä Í∞ïÌôî Í≤ÄÏ¶ù =====
            
            // 13. ÏøºÎ¶¨ Î≥µÏû°ÎèÑ Î∂ÑÏÑù
            analyzeQueryComplexity(queryWithoutComments, results);
            
            // 14. Ìä∏ÎûúÏû≠ÏÖò ÏïàÏ†ÑÏÑ± Í≤ÄÏ¶ù
            validateTransactionSafety(queryWithoutComments, results);
            
            // 15. Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Î≥Ñ Ìò∏ÌôòÏÑ± Í≤ÄÏÇ¨
            checkDatabaseCompatibility(queryWithoutComments, results);
            
            return results;
        }
        
        // 13. ÏøºÎ¶¨ Î≥µÏû°ÎèÑ Î∂ÑÏÑù (Ïã†Í∑ú)
        function analyzeQueryComplexity(query, results) {
            let complexity = 0;
            
            // JOIN Í∞úÏàò
            const joins = (query.match(/\bJOIN\b/gi) || []).length;
            complexity += joins * 2;
            
            // ÏÑúÎ∏åÏøºÎ¶¨ Í∞úÏàò
            const subqueries = calculateSubqueryDepth(query);
            complexity += subqueries * 3;
            
            // ÏßëÍ≥Ñ Ìï®Ïàò
            const aggregates = (query.match(/\b(COUNT|SUM|AVG|MIN|MAX|GROUP_CONCAT)\s*\(/gi) || []).length;
            complexity += aggregates;
            
            // UNION
            const unions = (query.match(/\bUNION\b/gi) || []).length;
            complexity += unions * 2;
            
            // CASE WHEN
            const cases = (query.match(/\bCASE\b/gi) || []).length;
            complexity += cases;
            
            // CTE
            const ctes = (query.match(/\bWITH\b/gi) || []).length;
            complexity += ctes;
            
            if (complexity > 20) {
                results.warnings.push(`ÏøºÎ¶¨ Î≥µÏû°ÎèÑÍ∞Ä ${complexity}Î°ú Îß§Ïö∞ ÎÜíÏäµÎãàÎã§. ÏøºÎ¶¨Î•º Î∂ÑÎ¶¨ÌïòÎäî Í≤ÉÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÏûÑÏãú ÌÖåÏù¥Î∏îÏù¥ÎÇò Î∑∞Î•º ÏÇ¨Ïö©ÌïòÏó¨ ÏøºÎ¶¨Î•º Îã®ÏàúÌôîÌïòÏÑ∏Ïöî.`);
            } else if (complexity > 10) {
                results.suggestions.push(`ÏøºÎ¶¨ Î≥µÏû°ÎèÑ: ${complexity}. Î≥µÏû°ÎèÑÍ∞Ä ÎÜíÏúºÎ©¥ Ïú†ÏßÄÎ≥¥ÏàòÍ∞Ä Ïñ¥Î†§ÏõåÏßà Ïàò ÏûàÏäµÎãàÎã§.`);
            }
        }
        
        // 14. Ìä∏ÎûúÏû≠ÏÖò ÏïàÏ†ÑÏÑ± Í≤ÄÏ¶ù (Ïã†Í∑ú)
        function validateTransactionSafety(query, results) {
            // Ìä∏ÎûúÏû≠ÏÖò ÌÇ§ÏõåÎìú
            const hasBegin = query.match(/\bBEGIN\b/i);
            const hasCommit = query.match(/\bCOMMIT\b/i);
            const hasRollback = query.match(/\bROLLBACK\b/i);
            
            if (hasBegin && !hasCommit && !hasRollback) {
                results.warnings.push('BEGINÏù¥ ÏûàÏßÄÎßå COMMITÏù¥ÎÇò ROLLBACKÏù¥ ÏóÜÏäµÎãàÎã§. Ìä∏ÎûúÏû≠ÏÖòÏùÑ Î™ÖÏãúÏ†ÅÏúºÎ°ú Ï¢ÖÎ£åÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: COMMIT ÎòêÎäî ROLLBACKÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.');
            }
            
            // ÏúÑÌóòÌïú ÏûëÏóÖ without Ìä∏ÎûúÏû≠ÏÖò
            if ((query.match(/\bUPDATE\b/i) || query.match(/\bDELETE\b/i)) && !hasBegin) {
                results.suggestions.push('Ï§ëÏöîÌïú UPDATE/DELETE ÏûëÏóÖÏùÄ Ìä∏ÎûúÏû≠ÏÖò ÏïàÏóêÏÑú Ïã§ÌñâÌïòÎäî Í≤ÉÏù¥ ÏïàÏ†ÑÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: BEGIN; ... COMMIT; ÏúºÎ°ú Í∞êÏã∏ÏÑ∏Ïöî.');
            }
            
            // AUTOCOMMIT Í≤ΩÍ≥†
            if (query.match(/SET\s+AUTOCOMMIT\s*=\s*0/i)) {
                results.warnings.push('AUTOCOMMITÏùÑ ÎπÑÌôúÏÑ±ÌôîÌñàÏäµÎãàÎã§. Ìä∏ÎûúÏû≠ÏÖòÏùÑ Î™ÖÏãúÏ†ÅÏúºÎ°ú Í¥ÄÎ¶¨Ìï¥Ïïº Ìï©ÎãàÎã§.\nüí° Ï£ºÏùò: Î∞òÎìúÏãú COMMIT ÎòêÎäî ROLLBACKÏùÑ Ìò∏Ï∂úÌïòÏÑ∏Ïöî.');
            }
        }
        
        // 15. Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Î≥Ñ Ìò∏ÌôòÏÑ± Í≤ÄÏÇ¨ (Ïã†Í∑ú)
        function checkDatabaseCompatibility(query, results) {
            // MySQL Ï†ÑÏö© Ìï®Ïàò
            const mysqlFunctions = ['IFNULL', 'CONCAT_WS', 'GROUP_CONCAT', 'UNIX_TIMESTAMP', 'FROM_UNIXTIME', 'DATE_FORMAT'];
            const mysqlSyntax = ['LIMIT \\d+ OFFSET', 'ON DUPLICATE KEY UPDATE', '`\\w+`', 'UNSIGNED', 'AUTO_INCREMENT'];
            
            // PostgreSQL Ï†ÑÏö©
            const postgresFunctions = ['STRING_AGG', 'ARRAY_AGG', 'COALESCE', 'NULLIF', 'GREATEST', 'LEAST'];
            const postgresSyntax = ['OFFSET \\d+ LIMIT', 'RETURNING', '::INTEGER', '::TEXT', '::TIMESTAMP'];
            
            // SQL Server Ï†ÑÏö©
            const sqlserverFunctions = ['ISNULL', 'GETDATE', 'DATEDIFF', 'DATEADD', 'CONVERT'];
            const sqlserverSyntax = ['TOP \\d+', '\\[\\w+\\]', 'IDENTITY\\(', 'WITH \\(NOLOCK\\)'];
            
            let detectedDB = [];
            
            // Í≤ÄÏÇ¨
            mysqlFunctions.concat(mysqlSyntax).forEach(pattern => {
                if (query.match(new RegExp(pattern, 'i'))) {
                    detectedDB.push('MySQL');
                }
            });
            
            postgresFunctions.concat(postgresSyntax).forEach(pattern => {
                if (query.match(new RegExp(pattern, 'i'))) {
                    detectedDB.push('PostgreSQL');
                }
            });
            
            sqlserverFunctions.concat(sqlserverSyntax).forEach(pattern => {
                if (query.match(new RegExp(pattern, 'i'))) {
                    detectedDB.push('SQL Server');
                }
            });
            
            // Ï§ëÎ≥µ Ï†úÍ±∞
            detectedDB = [...new Set(detectedDB)];
            
            if (detectedDB.length > 1) {
                results.warnings.push(`Ïó¨Îü¨ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Ïùò Î¨∏Î≤ïÏù¥ ÌòºÏö©ÎêòÏóàÏäµÎãàÎã§: ${detectedDB.join(', ')}\nüí° ÏàòÏ†ï Ï†úÏïà: Îã®Ïùº Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Ïùò Î¨∏Î≤ïÎßå ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.`);
            } else if (detectedDB.length === 1) {
                results.suggestions.push(`Í∞êÏßÄÎêú Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§: ${detectedDB[0]}`);
            }
        }

        // Ï£ºÏÑù Ï†úÍ±∞ Ìï®Ïàò
        function removeComments(query) {
            // -- Ï£ºÏÑù Ï†úÍ±∞
            query = query.replace(/--[^\n]*/g, '');
            // /* */ Ï£ºÏÑù Ï†úÍ±∞
            query = query.replace(/\/\*[\s\S]*?\*\//g, '');
            return query;
        }

        // SQL ÌÜ†ÌÅ∞Ìôî (Í∞ÑÎã®Ìïú lexer)
        function tokenizeSQL(query) {
            const keywords = /\b(SELECT|FROM|WHERE|JOIN|INNER|LEFT|RIGHT|FULL|OUTER|CROSS|ON|USING|GROUP|BY|HAVING|ORDER|LIMIT|OFFSET|UNION|ALL|DISTINCT|AS|INSERT|INTO|VALUES|UPDATE|SET|DELETE|CREATE|TABLE|ALTER|DROP|INDEX|VIEW|WITH|CASE|WHEN|THEN|ELSE|END|AND|OR|NOT|IN|EXISTS|BETWEEN|LIKE|IS|NULL|COUNT|SUM|AVG|MIN|MAX|CAST|CONVERT|COALESCE|NULLIF|IFNULL|CONCAT|SUBSTRING|TRIM|UPPER|LOWER|LENGTH|ROUND|FLOOR|CEIL|ABS|NOW|CURRENT_DATE|CURRENT_TIMESTAMP|DATE|TIME|DATETIME|YEAR|MONTH|DAY)\b/gi;
            
            const tokens = [];
            let match;
            
            while ((match = keywords.exec(query)) !== null) {
                tokens.push({
                    type: 'KEYWORD',
                    value: match[0].toUpperCase(),
                    position: match.index
                });
            }
            
            return tokens;
        }

        // 1. Í∏∞Î≥∏ Íµ¨Î¨∏ Í≤ÄÏ¶ù
        function validateBasicSyntax(query, results) {
            // SQL ÌÇ§ÏõåÎìúÎ°ú ÏãúÏûëÌïòÎäîÏßÄ ÌôïÏù∏
            const sqlKeywords = /^\s*(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP|TRUNCATE|WITH|EXPLAIN|DESCRIBE|SHOW|GRANT|REVOKE|BEGIN|COMMIT|ROLLBACK|MERGE|CALL|EXEC|USE|SET|COMMENT)/i;
            if (!query.match(sqlKeywords)) {
                results.errors.push('Ïò¨Î∞îÎ•∏ SQL ÌÇ§ÏõåÎìúÎ°ú ÏãúÏûëÌï¥Ïïº Ìï©ÎãàÎã§ (SELECT, INSERT, UPDATE, DELETE, CREATE Îì±)');
                results.isValid = false;
            }

            // ÏÑ∏ÎØ∏ÏΩúÎ°†ÏúºÎ°ú ÎÅùÎÇòÎäîÏßÄ ÌôïÏù∏ (ÏÑ†ÌÉùÏÇ¨Ìï≠Ïù¥ÏßÄÎßå Í∂åÏû•)
            if (!query.trim().endsWith(';')) {
                results.suggestions.push('ÏøºÎ¶¨ ÎÅùÏóê ÏÑ∏ÎØ∏ÏΩúÎ°†(;)ÏùÑ Ï∂îÍ∞ÄÌïòÎäî Í≤ÉÏù¥ Ï¢ãÏäµÎãàÎã§.');
            }

            // Îã§Ï§ë ÏøºÎ¶¨ Í∞êÏßÄ
            const statements = query.split(';').filter(s => s.trim());
            if (statements.length > 1) {
                results.warnings.push(`${statements.length}Í∞úÏùò SQL Î¨∏Ïù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§. Í∞ÅÍ∞Å Î≥ÑÎèÑÎ°ú Ïã§ÌñâÌïòÏÑ∏Ïöî.`);
            }
        }

        // 2. SELECT Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
        function validateSelectStatement(query, tokens, results) {
            if (!query.match(/^\s*SELECT\b/i)) return;

            // SELECT Ï†à Î∂ÑÏÑù
            const selectMatch = query.match(/SELECT\s+(.*?)\s+FROM/is);
            if (!selectMatch) {
                // FROM ÏóÜÏù¥ SELECTÎßå ÏûàÎäî Í≤ΩÏö∞ (Ïòà: SELECT 1, SELECT NOW())
                if (!query.match(/SELECT\s+(?!.*FROM)/is)) {
                    results.errors.push('SELECT Î¨∏Ïóê FROM Ï†àÏù¥ ÌïÑÏöîÌï©ÎãàÎã§ (ÏÉÅÏàò Ï°∞Ìöå Ï†úÏô∏)');
                    results.isValid = false;
                }
                return;
            }

            const selectClause = selectMatch[1];

            // SELECT * Í≤ÄÏÇ¨
            if (selectClause.trim() === '*') {
                results.warnings.push('SELECT *Îäî ÏÑ±Îä• Ï†ÄÌïòÏùò ÏõêÏù∏Ïù¥ Îê† Ïàò ÏûàÏäµÎãàÎã§. ÌïÑÏöîÌïú Ïª¨ÎüºÎßå Î™ÖÏãúÏ†ÅÏúºÎ°ú ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
            }

            // Ïª¨Îüº Î≥ÑÏπ≠ Í≤ÄÏ¶ù
            const aliases = selectClause.match(/\s+AS\s+(['"`]?\w+['"`]?)/gi);
            if (aliases) {
                const aliasNames = aliases.map(a => a.replace(/\s+AS\s+/i, '').trim().replace(/['"`]/g, '').toUpperCase());
                const duplicates = aliasNames.filter((item, index) => aliasNames.indexOf(item) !== index);
                if (duplicates.length > 0) {
                    results.errors.push(`Ï§ëÎ≥µÎêú Ïª¨Îüº Î≥ÑÏπ≠Ïù¥ ÏûàÏäµÎãàÎã§: ${[...new Set(duplicates)].join(', ')}`);
                    results.isValid = false;
                }
            }

            // DISTINCT ÏÇ¨Ïö© Í≤ÄÏ¶ù
            if (query.match(/SELECT\s+DISTINCT\b/i)) {
                results.suggestions.push('DISTINCTÎäî ÏÑ±Îä• ÎπÑÏö©Ïù¥ ÎÜíÏäµÎãàÎã§. GROUP BYÎÇò Ïù∏Îç±Ïä§ ÌôúÏö©ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.');
                
                // DISTINCTÏôÄ ÏßëÍ≥Ñ Ìï®Ïàò ÎèôÏãú ÏÇ¨Ïö© Ï≤¥ÌÅ¨
                if (query.match(/DISTINCT.*?(COUNT|SUM|AVG|MIN|MAX)\s*\(/i)) {
                    results.warnings.push('DISTINCTÏôÄ ÏßëÍ≥Ñ Ìï®ÏàòÎ•º Ìï®Íªò ÏÇ¨Ïö©ÌïòÎ©¥ ÏòàÏÉÅÏπò Î™ªÌïú Í≤∞Í≥ºÍ∞Ä ÎÇòÏò¨ Ïàò ÏûàÏäµÎãàÎã§.');
                }
            }

            // FROM Ï†à Í≤ÄÏ¶ù
            const fromMatch = query.match(/FROM\s+([\w\s,`.()]+?)(?:\s+WHERE|\s+JOIN|\s+GROUP|\s+ORDER|\s+LIMIT|\s+UNION|$)/is);
            if (fromMatch) {
                const fromClause = fromMatch[1].trim();
                
                // FROM Ï†àÏóê ÌÖåÏù¥Î∏îÏù¥ ÏóÜÎäî Í≤ΩÏö∞
                if (!fromClause || fromClause.length === 0) {
                    results.errors.push('FROM Ï†àÏóê ÌÖåÏù¥Î∏îÎ™ÖÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                    results.isValid = false;
                }

                // ÌÖåÏù¥Î∏î Î≥ÑÏπ≠ ÏóÜÏù¥ Ïó¨Îü¨ ÌÖåÏù¥Î∏î Ï∞∏Ï°∞
                const tables = fromClause.split(',');
                if (tables.length > 1) {
                    results.warnings.push('Ïó¨Îü¨ ÌÖåÏù¥Î∏îÏùÑ ÏΩ§ÎßàÎ°ú Íµ¨Î∂ÑÌïòÎäî Í≤ÉÎ≥¥Îã§ Î™ÖÏãúÏ†ÅÏù∏ JOINÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
            }

            // GROUP BY Í≤ÄÏ¶ù
            if (query.match(/\bGROUP\s+BY\b/i)) {
                // SELECT Ï†àÏùò ÎπÑÏßëÍ≥Ñ Ïª¨ÎüºÏù¥ GROUP BYÏóê Ìè¨Ìï®ÎêòÏñ¥Ïïº Ìï®
                const aggregates = ['COUNT', 'SUM', 'AVG', 'MIN', 'MAX', 'STDDEV', 'VARIANCE'];
                const hasAggregates = aggregates.some(agg => query.match(new RegExp(`\\b${agg}\\s*\\(`, 'i')));
                
                if (!hasAggregates) {
                    results.warnings.push('GROUP BYÎ•º ÏÇ¨Ïö©ÌïòÏßÄÎßå ÏßëÍ≥Ñ Ìï®ÏàòÍ∞Ä ÏóÜÏäµÎãàÎã§. ÏùòÎèÑÌïú Í≤ÉÏù¥ ÎßûÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
                }

                // HAVING Ï†à Í≤ÄÏ¶ù
                if (query.match(/\bHAVING\b/i)) {
                    // HAVINGÏóê ÏßëÍ≥Ñ Ìï®ÏàòÍ∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏
                    const havingClause = query.match(/HAVING\s+(.*?)(?:ORDER|LIMIT|$)/is);
                    if (havingClause && !aggregates.some(agg => havingClause[1].match(new RegExp(`\\b${agg}\\s*\\(`, 'i')))) {
                        results.suggestions.push('HAVING Ï†àÏóêÎäî ÏßëÍ≥Ñ Ìï®ÏàòÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî. ÏùºÎ∞ò Ï°∞Í±¥ÏùÄ WHERE Ï†àÏóê ÏûëÏÑ±ÌïòÎäî Í≤ÉÏù¥ Ìö®Ïú®Ï†ÅÏûÖÎãàÎã§.');
                    }
                } else {
                    results.suggestions.push('GROUP BYÏôÄ Ìï®Íªò HAVING Ï†àÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Í∑∏Î£πÌôîÎêú Í≤∞Í≥ºÎ•º ÌïÑÌÑ∞ÎßÅÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                }
            } else if (query.match(/\bHAVING\b/i)) {
                results.errors.push('HAVING Ï†àÏùÄ GROUP BY ÏóÜÏù¥ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.');
                results.isValid = false;
            }

            // ORDER BY Í≤ÄÏ¶ù
            if (query.match(/\bORDER\s+BY\b/i)) {
                const orderByClause = query.match(/ORDER\s+BY\s+(.*?)(?:LIMIT|OFFSET|UNION|;|$)/is);
                if (orderByClause) {
                    // ASC/DESC Î™ÖÏãú Í∂åÏû•
                    if (!orderByClause[1].match(/\b(ASC|DESC)\b/i)) {
                        results.suggestions.push('ORDER BYÏóê ASC ÎòêÎäî DESCÎ•º Î™ÖÏãúÌïòÎ©¥ ÏùòÎèÑÍ∞Ä Îçî Î™ÖÌôïÌï¥ÏßëÎãàÎã§.');
                    }

                    // Ïª¨Îüº Î≤àÌò∏Î°ú Ï†ïÎ†¨ (ÏïàÌã∞Ìå®ÌÑ¥)
                    if (orderByClause[1].match(/\b\d+\b/)) {
                        results.warnings.push('ORDER BYÏóê Ïª¨Îüº Î≤àÌò∏ ÎåÄÏã† Ïª¨ÎüºÎ™ÖÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî. Ïú†ÏßÄÎ≥¥ÏàòÍ∞Ä Ïñ¥Î†§ÏõåÏßà Ïàò ÏûàÏäµÎãàÎã§.');
                    }
                }
            }

            // LIMIT/OFFSET Í≤ÄÏ¶ù
            const limitMatch = query.match(/\bLIMIT\s+(\d+)/i);
            const offsetMatch = query.match(/\bOFFSET\s+(\d+)/i);
            
            if (offsetMatch && !limitMatch) {
                results.warnings.push('OFFSETÏùÄ LIMITÏôÄ Ìï®Íªò ÏÇ¨Ïö©ÌïòÎäî Í≤ÉÏù¥ ÏùºÎ∞òÏ†ÅÏûÖÎãàÎã§.');
            }

            if (limitMatch) {
                const limitValue = parseInt(limitMatch[1]);
                if (limitValue > 10000) {
                    results.warnings.push(`LIMIT ${limitValue}Îäî ÌÅ∞ Í∞íÏûÖÎãàÎã§. ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖòÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.`);
                }
            }

            if (offsetMatch) {
                const offsetValue = parseInt(offsetMatch[1]);
                if (offsetValue > 1000) {
                    results.warnings.push(`OFFSET ${offsetValue}Îäî ÌÅ∞ Í∞íÏûÖÎãàÎã§. ÌÇ§ÏÖã ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò(Keyset Pagination)ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.`);
                }
            }

            // UNION Í≤ÄÏ¶ù
            const unions = query.match(/\bUNION(\s+ALL)?\b/gi);
            if (unions && unions.length > 0) {
                results.suggestions.push(`${unions.length}Í∞úÏùò UNIONÏù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§. Í∞Å SELECTÏùò Ïª¨Îüº Í∞úÏàò, ÏàúÏÑú, ÌÉÄÏûÖÏù¥ ÏùºÏπòÌï¥Ïïº Ìï©ÎãàÎã§.`);
                
                // UNION vs UNION ALL
                const hasUnionAll = query.match(/\bUNION\s+ALL\b/i);
                if (!hasUnionAll && unions.length > 0) {
                    results.suggestions.push('Ï§ëÎ≥µ Ï†úÍ±∞Í∞Ä ÌïÑÏöî ÏóÜÎã§Î©¥ UNION ALLÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ìñ•ÏÉÅÎê©ÎãàÎã§.');
                }
            }

            // ÏÑúÎ∏åÏøºÎ¶¨ Í≤ÄÏ¶ù
            const subqueries = (query.match(/\(\s*SELECT/gi) || []).length;
            if (subqueries > 0) {
                results.suggestions.push(`${subqueries}Í∞úÏùò ÏÑúÎ∏åÏøºÎ¶¨Í∞Ä Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.`);
                
                if (subqueries > 3) {
                    results.warnings.push('ÏÑúÎ∏åÏøºÎ¶¨Í∞Ä ÎßéÏäµÎãàÎã§. JOINÏù¥ÎÇò CTE(WITH Ï†à) ÏÇ¨Ïö©ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.');
                }

                // Ïä§ÏπºÎùº ÏÑúÎ∏åÏøºÎ¶¨ Í≤ÄÏ¶ù
                if (query.match(/SELECT\s+[^,]*\(\s*SELECT[^)]*\)\s*[^,]*/i)) {
                    results.warnings.push('Ïä§ÏπºÎùº ÏÑúÎ∏åÏøºÎ¶¨Îäî ÌñâÎßàÎã§ Ïã§ÌñâÎê©ÎãàÎã§. JOINÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ìñ•ÏÉÅÎê† Ïàò ÏûàÏäµÎãàÎã§.');
                }

                // IN Ï†àÏùò ÏÑúÎ∏åÏøºÎ¶¨
                if (query.match(/\bIN\s*\(\s*SELECT/i)) {
                    results.suggestions.push('IN (SELECT ...)Îäî EXISTSÎ°ú Î≥ÄÍ≤ΩÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ìñ•ÏÉÅÎê† Ïàò ÏûàÏäµÎãàÎã§.');
                }
            }

            // CTE (Common Table Expression) Í≤ÄÏ¶ù
            if (query.match(/^\s*WITH\b/i)) {
                // CTE Íµ¨Î¨∏ Í≤ÄÏ¶ù
                if (!query.match(/WITH\s+\w+\s+AS\s*\(/i)) {
                    results.errors.push('CTE Íµ¨Î¨∏Ïù¥ Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§. "WITH cte_name AS (...)" ÌòïÏãùÏù¥Ïñ¥Ïïº Ìï©ÎãàÎã§.');
                    results.isValid = false;
                } else {
                    results.suggestions.push('CTEÎäî Î≥µÏû°Ìïú ÏøºÎ¶¨Ïùò Í∞ÄÎèÖÏÑ±ÏùÑ ÎÜíÏûÖÎãàÎã§.');
                    
                    // Ïû¨Í∑Ä CTE Í∞êÏßÄ
                    if (query.match(/WITH\s+RECURSIVE/i)) {
                        results.warnings.push('Ïû¨Í∑Ä CTEÎäî Î¨¥Ìïú Î£®ÌîÑÏóê Ï£ºÏùòÌïòÏÑ∏Ïöî. Ï¢ÖÎ£å Ï°∞Í±¥ÏùÑ Î™ÖÌôïÌûà ÌïòÏÑ∏Ïöî.');
                    }
                }
            }
        }

        // 3. INSERT Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
        function validateInsertStatement(query, tokens, results) {
            if (!query.match(/^\s*INSERT\s+INTO\b/i)) return;

            // INSERT INTO ÌÖåÏù¥Î∏îÎ™Ö Í≤ÄÏ¶ù
            const insertMatch = query.match(/INSERT\s+INTO\s+(\w+)/i);
            if (!insertMatch) {
                results.errors.push('INSERT INTO Îã§ÏùåÏóê ÌÖåÏù¥Î∏îÎ™ÖÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                results.isValid = false;
                return;
            }

            // VALUES ÎòêÎäî SELECT Ï†à ÌôïÏù∏
            if (!query.match(/\bVALUES\b/i) && !query.match(/\bSELECT\b/i)) {
                results.errors.push('INSERT Î¨∏ÏóêÎäî VALUES Ï†àÏù¥ÎÇò SELECT Î¨∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                results.isValid = false;
            }

            // Ïª¨Îüº Î™©Î°ù Í≤ÄÏ¶ù
            const columnListMatch = query.match(/INSERT\s+INTO\s+\w+\s*\((.*?)\)\s+VALUES/is);
            if (columnListMatch) {
                const columns = columnListMatch[1].split(',').map(c => c.trim());
                
                // Ï§ëÎ≥µ Ïª¨Îüº Ï≤¥ÌÅ¨
                const duplicates = columns.filter((item, index) => columns.indexOf(item) !== index);
                if (duplicates.length > 0) {
                    results.errors.push(`INSERT Î¨∏Ïóê Ï§ëÎ≥µÎêú Ïª¨ÎüºÏù¥ ÏûàÏäµÎãàÎã§: ${[...new Set(duplicates)].join(', ')}`);
                    results.isValid = false;
                }
            } else if (query.match(/\bVALUES\b/i)) {
                results.warnings.push('Ïª¨Îüº Î™©Î°ùÏùÑ Î™ÖÏãúÌïòÏßÄ ÏïäÏúºÎ©¥ ÌÖåÏù¥Î∏î Íµ¨Ï°∞ Î≥ÄÍ≤Ω Ïãú Ïò§Î•òÍ∞Ä Î∞úÏÉùÌï† Ïàò ÏûàÏäµÎãàÎã§.');
            }

            // VALUES Ï†à Í≤ÄÏ¶ù
            if (query.match(/\bVALUES\b/i)) {
                const valuesMatch = query.match(/VALUES\s*\((.*?)\)/is);
                if (valuesMatch) {
                    const values = valuesMatch[1];
                    
                    // Ïª¨Îüº Í∞úÏàòÏôÄ Í∞í Í∞úÏàò ÎπÑÍµê
                    if (columnListMatch) {
                        const columnCount = columnListMatch[1].split(',').length;
                        const valueCount = values.split(',').length;
                        
                        if (columnCount !== valueCount) {
                            results.errors.push(`Ïª¨Îüº Í∞úÏàò(${columnCount})ÏôÄ Í∞í Í∞úÏàò(${valueCount})Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.`);
                            results.isValid = false;
                        }
                    }
                }

                // Îã§Ï§ë Ìñâ INSERT Í∞êÏßÄ
                const multipleRows = query.match(/VALUES\s*\([^)]+\)\s*,\s*\(/gi);
                if (multipleRows && multipleRows.length > 100) {
                    results.warnings.push(`${multipleRows.length + 1}Í∞úÏùò ÌñâÏùÑ Ìïú Î≤àÏóê INSERTÌï©ÎãàÎã§. Î∞∞Ïπò ÌÅ¨Í∏∞Î•º Ï°∞Ï†àÌïòÍ±∞ÎÇò Ìä∏ÎûúÏû≠ÏÖòÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.`);
                }
            }

            // INSERT ... SELECT Í≤ÄÏ¶ù
            if (query.match(/INSERT\s+INTO.*?SELECT/is)) {
                results.suggestions.push('INSERT ... SELECT ÏÇ¨Ïö© Ïãú SELECT Í≤∞Í≥º Ïª¨ÎüºÍ≥º INSERT Ïª¨ÎüºÏù¥ ÏùºÏπòÌïòÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
            }

            // ON DUPLICATE KEY UPDATE (MySQL)
            if (query.match(/ON\s+DUPLICATE\s+KEY\s+UPDATE/i)) {
                results.suggestions.push('ON DUPLICATE KEY UPDATEÎäî MySQL Ï†ÑÏö© Íµ¨Î¨∏ÏûÖÎãàÎã§. Îã§Î•∏ DBMSÏóêÏÑúÎäî MERGEÎÇò UPSERTÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
        }

        // 4. UPDATE Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
        function validateUpdateStatement(query, tokens, results) {
            if (!query.match(/^\s*UPDATE\b/i)) return;

            // UPDATE ÌÖåÏù¥Î∏îÎ™Ö Í≤ÄÏ¶ù
            const updateMatch = query.match(/UPDATE\s+(\w+)/i);
            if (!updateMatch) {
                results.errors.push('UPDATE Îã§ÏùåÏóê ÌÖåÏù¥Î∏îÎ™ÖÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                results.isValid = false;
                return;
            }

            // SET Ï†à ÌôïÏù∏
            if (!query.match(/\bSET\b/i)) {
                results.errors.push('UPDATE Î¨∏ÏóêÎäî SET Ï†àÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                results.isValid = false;
            }

            // WHERE Ï†à ÌôïÏù∏ (Îß§Ïö∞ Ï§ëÏöî)
            if (!query.match(/\bWHERE\b/i)) {
                results.errors.push('‚ö†Ô∏è ÏúÑÌóò: UPDATE Î¨∏Ïóê WHERE Ï†àÏù¥ ÏóÜÏäµÎãàÎã§! Î™®Îì† ÌñâÏù¥ ÏàòÏ†ïÎê©ÎãàÎã§.');
                results.warnings.push('WHERE Ï†àÏùÑ Ï∂îÍ∞ÄÌïòÏó¨ ÏàòÏ†ï ÎåÄÏÉÅÏùÑ Î™ÖÌôïÌûà ÏßÄÏ†ïÌïòÏÑ∏Ïöî.');
            }

            // SET Ï†à Î∂ÑÏÑù
            const setMatch = query.match(/SET\s+(.*?)(?:\s+WHERE|$)/is);
            if (setMatch) {
                const setClause = setMatch[1];
                const assignments = setClause.split(',');
                
                // ÎèôÏùº Ïª¨Îüº Ï§ëÎ≥µ ÏàòÏ†ï Ï≤¥ÌÅ¨
                const columns = assignments.map(a => {
                    const match = a.trim().match(/^(\w+)\s*=/);
                    return match ? match[1] : null;
                }).filter(c => c);
                
                const duplicates = columns.filter((item, index) => columns.indexOf(item) !== index);
                if (duplicates.length > 0) {
                    results.errors.push(`ÎèôÏùºÌïú Ïª¨ÎüºÏùÑ Ïó¨Îü¨ Î≤à ÏàòÏ†ïÌïòÎ†§Í≥† Ìï©ÎãàÎã§: ${[...new Set(duplicates)].join(', ')}`);
                    results.isValid = false;
                }

                // ÏûêÍ∏∞ ÏûêÏã† Ï∞∏Ï°∞ ÏóÖÎç∞Ïù¥Ìä∏ Ï≤¥ÌÅ¨
                assignments.forEach(assignment => {
                    const parts = assignment.split('=');
                    if (parts.length === 2) {
                        const column = parts[0].trim();
                        const value = parts[1].trim();
                        if (value.includes(column)) {
                            results.suggestions.push(`Ïª¨Îüº ${column}Ïù¥(Í∞Ä) ÏûêÍ∏∞ ÏûêÏã†ÏùÑ Ï∞∏Ï°∞ÌïòÏó¨ ÏóÖÎç∞Ïù¥Ìä∏Îê©ÎãàÎã§. ÏùòÎèÑÌïú Í≤ÉÏù¥ ÎßûÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.`);
                        }
                    }
                });
            }

            // ÏÑúÎ∏åÏøºÎ¶¨ ÏÇ¨Ïö© Ïãú Ï£ºÏùò
            if (query.match(/SET.*?\(\s*SELECT/is)) {
                results.warnings.push('UPDATEÏùò SET Ï†àÏóê ÏÑúÎ∏åÏøºÎ¶¨Î•º ÏÇ¨Ïö©ÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ï†ÄÌïòÎê† Ïàò ÏûàÏäµÎãàÎã§.');
            }
        }

        // 5. DELETE Î¨∏ Í≥†Í∏â Í≤ÄÏ¶ù
        function validateDeleteStatement(query, tokens, results) {
            if (!query.match(/^\s*DELETE\b/i)) return;

            // DELETE FROM Í≤ÄÏ¶ù
            if (!query.match(/DELETE\s+FROM\b/i)) {
                results.errors.push('DELETE Îã§ÏùåÏóê FROM ÌÇ§ÏõåÎìúÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§.');
                results.isValid = false;
            }

            // WHERE Ï†à ÌôïÏù∏ (Îß§Ïö∞ Ï§ëÏöî)
            if (!query.match(/\bWHERE\b/i)) {
                results.errors.push('‚ö†Ô∏è ÏúÑÌóò: DELETE Î¨∏Ïóê WHERE Ï†àÏù¥ ÏóÜÏäµÎãàÎã§! Î™®Îì† ÌñâÏù¥ ÏÇ≠Ï†úÎê©ÎãàÎã§.');
                results.warnings.push('WHERE Ï†àÏùÑ Ï∂îÍ∞ÄÌïòÏó¨ ÏÇ≠Ï†ú ÎåÄÏÉÅÏùÑ Î™ÖÌôïÌûà ÏßÄÏ†ïÌïòÏÑ∏Ïöî.');
            }

            // LIMIT ÏÇ¨Ïö© Í∂åÏû•
            if (!query.match(/\bLIMIT\b/i) && !query.match(/\bTOP\b/i)) {
                results.suggestions.push('ÎåÄÎüâ ÏÇ≠Ï†ú Ïãú LIMITÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Î∞∞ÏπòÎ°ú Ï≤òÎ¶¨ÌïòÎäî Í≤ÉÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.');
            }

            // Ïô∏Îûò ÌÇ§ Ï†úÏïΩ Í≥†Î†§
            results.suggestions.push('Ïô∏Îûò ÌÇ§ Ï†úÏïΩÏù¥ ÏûàÎäî Í≤ΩÏö∞ Ï∞∏Ï°∞ Î¨¥Í≤∞ÏÑ±ÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
        }

        // 6. JOIN Ï†à Í≥†Í∏â Í≤ÄÏ¶ù
        function validateJoinClauses(query, results) {
            const joins = query.match(/\b(INNER\s+JOIN|LEFT\s+(?:OUTER\s+)?JOIN|RIGHT\s+(?:OUTER\s+)?JOIN|FULL\s+(?:OUTER\s+)?JOIN|CROSS\s+JOIN|JOIN)\b/gi);
            
            if (!joins || joins.length === 0) return;

            // JOIN Ï°∞Í±¥ ÌôïÏù∏
            const ons = (query.match(/\bON\b/gi) || []).length;
            const usings = (query.match(/\bUSING\b/gi) || []).length;
            const totalConditions = ons + usings;

            if (totalConditions < joins.length) {
                // CROSS JOIN Ï†úÏô∏
                const crossJoins = (query.match(/\bCROSS\s+JOIN\b/gi) || []).length;
                if (totalConditions < joins.length - crossJoins) {
                    results.errors.push('ÏùºÎ∂Ä JOINÏóê ON ÎòêÎäî USING Ï°∞Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§. CROSS JOINÏù¥ ÏïÑÎãàÎùºÎ©¥ Ï°∞Ïù∏ Ï°∞Í±¥ÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.');
                    results.isValid = false;
                }
            }

            // JOIN ÏÑ±Îä• Í≤ΩÍ≥†
            if (joins.length > 5) {
                results.warnings.push(`${joins.length}Í∞úÏùò JOINÏù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§. ÏÑ±Îä• Ï†ÄÌïòÍ∞Ä Î∞úÏÉùÌï† Ïàò ÏûàÏúºÎãà Ïã§Ìñâ Í≥ÑÌöçÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.`);
            }

            // JOIN ÌÉÄÏûÖÎ≥Ñ Í∂åÏû•ÏÇ¨Ìï≠
            joins.forEach(join => {
                const joinType = join.trim().toUpperCase();
                
                if (joinType.includes('CROSS')) {
                    results.warnings.push('CROSS JOINÏùÄ Ïπ¥ÌÖåÏãúÏïà Í≥±ÏùÑ ÏÉùÏÑ±Ìï©ÎãàÎã§. ÏùòÎèÑÌïú Í≤ÉÏù¥ ÎßûÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
                }
                
                if (joinType.includes('RIGHT')) {
                    results.suggestions.push('RIGHT JOIN ÎåÄÏã† LEFT JOINÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ ÏøºÎ¶¨ Í∞ÄÎèÖÏÑ±Ïù¥ Ìñ•ÏÉÅÎê©ÎãàÎã§.');
                }
                
                if (joinType.includes('FULL')) {
                    results.suggestions.push('FULL OUTER JOINÏùÄ ÏÑ±Îä• ÎπÑÏö©Ïù¥ ÎÜíÏäµÎãàÎã§. Íº≠ ÌïÑÏöîÌïúÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
                }
            });

            // JOIN Ï°∞Í±¥ Î∂ÑÏÑù
            const onClauses = query.match(/ON\s+(.*?)(?:JOIN|WHERE|GROUP|ORDER|$)/gis);
            if (onClauses) {
                onClauses.forEach(onClause => {
                    // OR Ï°∞Í±¥ ÏÇ¨Ïö© Ïãú Í≤ΩÍ≥†
                    if (onClause.match(/\bOR\b/i)) {
                        results.warnings.push('JOIN Ï°∞Í±¥Ïóê ORÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ Ïù∏Îç±Ïä§ ÌôúÏö©Ïù¥ Ïñ¥Î†§Ïõå ÏÑ±Îä•Ïù¥ Ï†ÄÌïòÎê† Ïàò ÏûàÏäµÎãàÎã§.');
                    }

                    // Ìï®Ïàò ÏÇ¨Ïö© Ïãú Í≤ΩÍ≥†
                    if (onClause.match(/\b(UPPER|LOWER|SUBSTRING|CONCAT|TRIM)\s*\(/i)) {
                        results.warnings.push('JOIN Ï°∞Í±¥Ïóê Ìï®ÏàòÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÌôúÏö©ÌïòÏßÄ Î™ªÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                    }
                });
            }
        }

        // 7. WHERE Ï†à Í≥†Í∏â Í≤ÄÏ¶ù (ÎåÄÌè≠ Í∞ïÌôîÎê®)
        function validateWhereClause(query, results) {
            const whereMatch = query.match(/WHERE\s+(.*?)(?:GROUP|HAVING|ORDER|LIMIT|UNION|;|$)/is);
            if (!whereMatch) return;

            const whereClause = whereMatch[1];

            // WHERE 1=1 ÏïàÌã∞Ìå®ÌÑ¥
            if (whereClause.match(/\b1\s*=\s*1\b/)) {
                results.warnings.push('WHERE 1=1ÏùÄ Î∂àÌïÑÏöîÌïú Ï°∞Í±¥ÏûÖÎãàÎã§. ÎèôÏ†Å ÏøºÎ¶¨Í∞Ä ÏïÑÎãàÎùºÎ©¥ Ï†úÍ±∞ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: Ïã§Ï†ú Ï°∞Í±¥Îßå WHERE Ï†àÏóê ÏûëÏÑ±ÌïòÏÑ∏Ïöî.');
            }
            
            // WHERE 1=0 (ÌÖåÏù¥Î∏î Íµ¨Ï°∞Îßå Í∞ÄÏ†∏Ïò§Í∏∞)
            if (whereClause.match(/\b1\s*=\s*0\b/)) {
                results.suggestions.push('WHERE 1=0ÏùÄ ÌÖåÏù¥Î∏î Íµ¨Ï°∞Îßå Í∞ÄÏ†∏Ïò§Îäî Í∏∞Î≤ïÏûÖÎãàÎã§. ÏùòÎèÑÌïú Í≤ÉÏù¥ ÎßûÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
            }

            // LIKE '%value%' Ìå®ÌÑ¥ (Ïù∏Îç±Ïä§ ÎØ∏ÏÇ¨Ïö©)
            if (whereClause.match(/LIKE\s+['"]%/i)) {
                results.warnings.push("LIKE '%value%'Îäî Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©ÌïòÏßÄ Î™ªÌï©ÎãàÎã§. Ï†ÑÎ¨∏ Í≤ÄÏÉâ(Full-Text Search)ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: FULLTEXT INDEXÎ•º ÏÉùÏÑ±ÌïòÍ≥† MATCH AGAINSTÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.");
            }
            
            // LIKE '%value' (ÎÅùÎ∂ÄÎ∂Ñ Îß§Ïπ≠)
            if (whereClause.match(/LIKE\s+['"]%[^%]+['"]\s*$/i) && !whereClause.match(/LIKE\s+['"][^%]/i)) {
                results.warnings.push("LIKE '%value'Îäî Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©ÌïòÏßÄ Î™ªÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: LIKE 'value%'Î°ú Î≥ÄÍ≤ΩÌïòÍ±∞ÎÇò Ï†ÑÎ¨∏ Í≤ÄÏÉâÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.");
            }

            // NOT IN ÏÇ¨Ïö© Ïãú Í≤ΩÍ≥†
            if (whereClause.match(/\bNOT\s+IN\b/i)) {
                results.suggestions.push('NOT IN ÎåÄÏã† NOT EXISTSÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ NULL Ï≤òÎ¶¨Í∞Ä Îçî Î™ÖÌôïÌïòÍ≥† ÏÑ±Îä•Ïù¥ Ìñ•ÏÉÅÎê† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE col NOT IN (SELECT ...) ÎåÄÏã† WHERE NOT EXISTS (SELECT 1 FROM ... WHERE col = ...)Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
            
            // IN Ï†àÏóê NULL Ìè¨Ìï®
            if (whereClause.match(/\bIN\s*\([^)]*NULL[^)]*\)/i)) {
                results.warnings.push('IN Ï†àÏóê NULLÏù¥ Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏäµÎãàÎã§. INÏùÄ NULLÍ≥º Îß§Ïπ≠ÎêòÏßÄ ÏïäÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: OR IS NULLÏùÑ Î≥ÑÎèÑÎ°ú Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.');
            }

            // OR Ï°∞Í±¥ Í≥ºÎã§ ÏÇ¨Ïö©
            const orCount = (whereClause.match(/\bOR\b/gi) || []).length;
            if (orCount > 5) {
                results.warnings.push(`OR Ï°∞Í±¥Ïù¥ ${orCount}Í∞ú ÏûàÏäµÎãàÎã§. IN Ï†àÏù¥ÎÇò UNIONÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE a=1 OR a=2 OR a=3 ÎåÄÏã† WHERE a IN (1,2,3)ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.`);
            } else if (orCount > 10) {
                results.errors.push(`OR Ï°∞Í±¥Ïù¥ ${orCount}Í∞úÎ°ú ÎÑàÎ¨¥ ÎßéÏäµÎãàÎã§. ÏøºÎ¶¨ ÏµúÏ†ÅÌôîÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÏûÑÏãú ÌÖåÏù¥Î∏îÏùÑ ÏÉùÏÑ±ÌïòÍ≥† JOINÌïòÏÑ∏Ïöî.`);
            }

            // Ìï®ÏàòÎ•º Ïª¨ÎüºÏóê Ï†ÅÏö©
            const functionsOnColumns = whereClause.match(/\b(YEAR|MONTH|DAY|DATE|UPPER|LOWER|SUBSTRING|LEFT|RIGHT|TRIM|LENGTH|CONCAT)\s*\(\s*\w+\s*\)/gi);
            if (functionsOnColumns) {
                results.warnings.push(`WHERE Ï†àÏóêÏÑú Ïª¨ÎüºÏóê Ìï®ÏàòÎ•º Ï†ÅÏö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©ÌïòÏßÄ Î™ªÌï† Ïàò ÏûàÏäµÎãàÎã§. (${functionsOnColumns.length}Í∞ú Î∞úÍ≤¨)\nüí° ÏàòÏ†ï Ï†úÏïà: Ìï®Ïàò Í∏∞Î∞ò Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±ÌïòÍ±∞ÎÇò Ïª¨ÎüºÏùÑ ÏßÅÏ†ë ÎπÑÍµêÌïòÏÑ∏Ïöî.`);
            }
            
            // Ïª¨ÎüºÏóê Ïó∞ÏÇ∞ Ï†ÅÏö©
            if (whereClause.match(/\w+\s*[\+\-\*\/]\s*\d+\s*[=<>]/)) {
                results.warnings.push('WHERE Ï†àÏóêÏÑú Ïª¨ÎüºÏóê Ïó∞ÏÇ∞ÏùÑ Ï†ÅÏö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©ÌïòÏßÄ Î™ªÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE price * 1.1 > 100 ÎåÄÏã† WHERE price > 90.91ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }

            // != ÎåÄÏã† <> ÏÇ¨Ïö© Í∂åÏû•
            if (whereClause.match(/!=/)) {
                results.suggestions.push('!= ÎåÄÏã† SQL ÌëúÏ§ÄÏù∏ <>Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE col != value ÎåÄÏã† WHERE col <> valueÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }

            // = NULL (Ïò§Î•ò)
            if (whereClause.match(/[=<>]\s*NULL/i) && !whereClause.match(/IS\s+(NOT\s+)?NULL/i)) {
                results.errors.push('NULL ÎπÑÍµêÎäî =, <>, <, > ÎåÄÏã† IS NULL ÎòêÎäî IS NOT NULLÏùÑ ÏÇ¨Ïö©Ìï¥Ïïº Ìï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE col = NULL ÎåÄÏã† WHERE col IS NULLÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                results.isValid = false;
            }

            // ÎÇ†Ïßú ÎπÑÍµê Í≤ÄÏ¶ù
            if (whereClause.match(/\b(date|time|timestamp|created_at|updated_at)\b/i)) {
                if (!whereClause.match(/\b(BETWEEN|>=|<=|>|<|DATE)\b/i)) {
                    results.suggestions.push('ÎÇ†Ïßú Î≤îÏúÑ Í≤ÄÏÉâ Ïãú BETWEENÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ Îçî Î™ÖÌôïÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE date >= "2025-01-01" AND date <= "2025-12-31" ÎåÄÏã† WHERE date BETWEEN "2025-01-01" AND "2025-12-31"ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
            }
            
            // BETWEENÏùò ÏûòÎ™ªÎêú ÏÇ¨Ïö©
            if (whereClause.match(/BETWEEN\s+(\d+)\s+AND\s+(\d+)/i)) {
                const match = whereClause.match(/BETWEEN\s+(\d+)\s+AND\s+(\d+)/i);
                if (match && parseInt(match[1]) > parseInt(match[2])) {
                    results.errors.push(`BETWEENÏùò Î≤îÏúÑÍ∞Ä ÏûòÎ™ªÎêòÏóàÏäµÎãàÎã§. ÏãúÏûëÍ∞í(${match[1]})Ïù¥ ÎÅùÍ∞í(${match[2]})Î≥¥Îã§ ÌÅΩÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: BETWEEN ${match[2]} AND ${match[1]}Î°ú ÏàòÏ†ïÌïòÏÑ∏Ïöî.`);
                    results.isValid = false;
                }
            }
            
            // ÌÉÄÏûÖ Î∂àÏùºÏπò Í∞ÄÎä•ÏÑ±
            if (whereClause.match(/\b\w+\s*=\s*['"]\d+['"]/)) {
                results.warnings.push('Ïà´ÏûêÌòï Ïª¨ÎüºÏùÑ Î¨∏ÏûêÏó¥Í≥º ÎπÑÍµêÌïòÍ≥† ÏûàÏùÑ Ïàò ÏûàÏäµÎãàÎã§. ÌÉÄÏûÖÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE id = "123" ÎåÄÏã† WHERE id = 123ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
            
            // AND/OR Ïö∞ÏÑ†ÏàúÏúÑ Í¥ÑÌò∏ ÎàÑÎùΩ
            if (whereClause.match(/\bAND\b/i) && whereClause.match(/\bOR\b/i) && !whereClause.includes('(')) {
                results.warnings.push('ANDÏôÄ ORÎ•º Ìï®Íªò ÏÇ¨Ïö©Ìï† Îïå Í¥ÑÌò∏Î°ú Ïö∞ÏÑ†ÏàúÏúÑÎ•º Î™ÖÌôïÌûà ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE a=1 AND b=2 OR c=3 ÎåÄÏã† WHERE (a=1 AND b=2) OR c=3ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
            
            // Î∂ÄÏ†ï Ï°∞Í±¥ ÏµúÏ†ÅÌôî
            if (whereClause.match(/\bNOT\s+(LIKE|IN|EXISTS|BETWEEN)/i)) {
                results.suggestions.push('Î∂ÄÏ†ï Ï°∞Í±¥(NOT)ÏùÄ Ïù∏Îç±Ïä§ ÏµúÏ†ÅÌôîÎ•º Î∞©Ìï¥Ìï† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Í∞ÄÎä•ÌïòÎ©¥ Í∏çÏ†ï Ï°∞Í±¥ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏÑ∏Ïöî.');
            }
            
            // Î≥µÏû°Ìïú Ï°∞Í±¥Ïãù
            const conditionCount = (whereClause.match(/\b(AND|OR)\b/gi) || []).length;
            if (conditionCount > 10) {
                results.warnings.push(`WHERE Ï†àÏóê ${conditionCount}Í∞úÏùò Ï°∞Í±¥Ïù¥ ÏûàÏäµÎãàÎã§. Î≥µÏû°Ìïú Ï°∞Í±¥ÏùÄ Í∞ÄÎèÖÏÑ±Í≥º ÏÑ±Îä•ÏùÑ Ï†ÄÌïòÏãúÌÇµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: CTEÎÇò ÏÑúÎ∏åÏøºÎ¶¨Î°ú Ï°∞Í±¥ÏùÑ Î∂ÑÎ¶¨ÌïòÏÑ∏Ïöî.`);
            }
            
            // ÎåÄÏÜåÎ¨∏Ïûê Íµ¨Î∂Ñ ÏóÜÎäî ÎπÑÍµê
            if (whereClause.match(/UPPER\s*\([^)]+\)\s*=\s*UPPER\s*\(/i) || whereClause.match(/LOWER\s*\([^)]+\)\s*=\s*LOWER\s*\(/i)) {
                results.suggestions.push('ÎåÄÏÜåÎ¨∏Ïûê Íµ¨Î∂Ñ ÏóÜÎäî ÎπÑÍµêÎ•º ÏúÑÌï¥ UPPER/LOWERÎ•º ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: COLLATEÎ•º ÏÇ¨Ïö©ÌïòÍ±∞ÎÇò ÏºÄÏù¥Ïä§ Ïù∏ÏÑºÏÑúÌã∞Î∏å Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±ÌïòÏÑ∏Ïöî.');
            }
            
            // Îπà Î¨∏ÏûêÏó¥ ÎπÑÍµê
            if (whereClause.match(/=\s*['"]{2}/)) {
                results.suggestions.push("Îπà Î¨∏ÏûêÏó¥('')Í≥º ÎπÑÍµêÌïòÍ≥† ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: NULLÍ≥º Îπà Î¨∏ÏûêÏó¥ÏùÑ Íµ¨Î∂ÑÌï¥Ïïº ÌïúÎã§Î©¥ LENGTH(col) = 0 ÎòêÎäî col = '' OR col IS NULLÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.");
            }
        }

        // 8. Í¥ÑÌò∏/Îî∞Ïò¥Ìëú Í∑†Ìòï Í≤ÄÏ¶ù (Í∞ïÌôîÎê®)
        function validateBalancedDelimiters(query, results) {
            // Î¨∏ÏûêÏó¥ Î¶¨ÌÑ∞Îü¥ÏùÑ Ï†úÏô∏ÌïòÍ≥† Í¥ÑÌò∏ Îß§Ïπ≠ Í≤ÄÏÇ¨
            let parenDepth = 0;
            let maxParenDepth = 0;
            let inString = false;
            let stringChar = '';
            let escapeNext = false;
            let parenPositions = [];
            
            for (let i = 0; i < query.length; i++) {
                const char = query[i];
                
                // Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Ï≤òÎ¶¨
                if (escapeNext) {
                    escapeNext = false;
                    continue;
                }
                
                if (char === '\\') {
                    escapeNext = true;
                    continue;
                }
                
                // Î¨∏ÏûêÏó¥ Î¶¨ÌÑ∞Îü¥ Ï≤òÎ¶¨
                if ((char === "'" || char === '"' || char === '`') && !inString) {
                    inString = true;
                    stringChar = char;
                    continue;
                } else if (char === stringChar && inString) {
                    inString = false;
                    continue;
                }
                
                // Î¨∏ÏûêÏó¥ ÎÇ¥Î∂ÄÍ∞Ä ÏïÑÎãê ÎïåÎßå Í¥ÑÌò∏ Í≤ÄÏÇ¨
                if (!inString) {
                    if (char === '(') {
                        parenDepth++;
                        maxParenDepth = Math.max(maxParenDepth, parenDepth);
                        parenPositions.push({ type: 'open', pos: i });
                    }
                    else if (char === ')') {
                        parenDepth--;
                        if (parenDepth < 0) {
                            const context = query.substring(Math.max(0, i - 20), Math.min(query.length, i + 20));
                            results.errors.push(`ÏúÑÏπò ${i}: Îã´Îäî Í¥ÑÌò∏ ')'Ïóê ÎåÄÏùëÌïòÎäî Ïó¨Îäî Í¥ÑÌò∏Í∞Ä ÏóÜÏäµÎãàÎã§.\nÏª®ÌÖçÏä§Ìä∏: ...${context}...`);
                            results.isValid = false;
                            break;
                        }
                        parenPositions.push({ type: 'close', pos: i });
                    }
                }
            }
            
            if (parenDepth > 0) {
                results.errors.push(`Í¥ÑÌò∏Í∞Ä ${parenDepth}Í∞ú Îã´ÌûàÏßÄ ÏïäÏïòÏäµÎãàÎã§. Ïó¨Îäî Í¥ÑÌò∏Í∞Ä ${parenDepth}Í∞ú Îçî ÎßéÏäµÎãàÎã§.`);
                results.isValid = false;
            } else if (parenDepth < 0) {
                results.errors.push(`Í¥ÑÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. Îã´Îäî Í¥ÑÌò∏Í∞Ä ${Math.abs(parenDepth)}Í∞ú Îçî ÎßéÏäµÎãàÎã§.`);
                results.isValid = false;
            }
            
            if (maxParenDepth > 5) {
                results.warnings.push(`Í¥ÑÌò∏ Ï§ëÏ≤©Ïù¥ ${maxParenDepth}Îã®Í≥ÑÎ°ú ÍπäÏäµÎãàÎã§. ÏøºÎ¶¨ Í∞ÄÎèÖÏÑ±ÏùÑ ÏúÑÌï¥ CTE ÏÇ¨Ïö©ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.`);
            }

            // Îî∞Ïò¥Ìëú Îß§Ïπ≠ Í∞úÏÑ† (Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Ï≤òÎ¶¨)
            let singleQuoteCount = 0;
            let doubleQuoteCount = 0;
            let backtickCount = 0;
            escapeNext = false;
            
            for (let i = 0; i < query.length; i++) {
                const char = query[i];
                
                if (escapeNext) {
                    escapeNext = false;
                    continue;
                }
                
                if (char === '\\') {
                    escapeNext = true;
                    continue;
                }
                
                if (char === "'") singleQuoteCount++;
                if (char === '"') doubleQuoteCount++;
                if (char === '`') backtickCount++;
            }
            
            if (singleQuoteCount % 2 !== 0) {
                results.errors.push("ÏûëÏùÄÎî∞Ïò¥Ìëú(')Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. Î¨∏ÏûêÏó¥ Î¶¨ÌÑ∞Îü¥ÏùÑ Ï†úÎåÄÎ°ú Îã´ÏïòÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÎàÑÎùΩÎêú ÏûëÏùÄÎî∞Ïò¥ÌëúÎ•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.");
                results.isValid = false;
            }

            if (doubleQuoteCount % 2 !== 0) {
                results.errors.push('ÌÅ∞Îî∞Ïò¥Ìëú(")Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. ÏãùÎ≥ÑÏûêÎÇò Î¨∏ÏûêÏó¥ÏùÑ Ï†úÎåÄÎ°ú Îã´ÏïòÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÎàÑÎùΩÎêú ÌÅ∞Îî∞Ïò¥ÌëúÎ•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.');
                results.isValid = false;
            }

            if (backtickCount % 2 !== 0) {
                results.errors.push('Î∞±Ìã±(`)Ïù¥ ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. MySQL ÏãùÎ≥ÑÏûêÎ•º Ï†úÎåÄÎ°ú Îã´ÏïòÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÎàÑÎùΩÎêú Î∞±Ìã±ÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.');
                results.isValid = false;
            }

            // ÎåÄÍ¥ÑÌò∏ Îß§Ïπ≠ (SQL Server ÏãùÎ≥ÑÏûê)
            const openBrackets = (query.match(/\[/g) || []).length;
            const closeBrackets = (query.match(/\]/g) || []).length;
            if (openBrackets !== closeBrackets) {
                results.errors.push(`ÎåÄÍ¥ÑÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. (Ïó¨Îäî ÎåÄÍ¥ÑÌò∏: ${openBrackets}, Îã´Îäî ÎåÄÍ¥ÑÌò∏: ${closeBrackets})\nüí° ÏàòÏ†ï Ï†úÏïà: SQL Server ÏãùÎ≥ÑÏûêÏùò ÎåÄÍ¥ÑÌò∏ Í∞úÏàòÎ•º ÎßûÏ∂îÏÑ∏Ïöî.`);
                results.isValid = false;
            }
        }

        // 9. Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Î∞è Ìï®Ïàò Í≤ÄÏ¶ù
        function validateDataTypesAndFunctions(query, results) {
            // ÎÇ†Ïßú/ÏãúÍ∞Ñ Ìï®Ïàò Í≤ÄÏ¶ù
            const dateFunctions = ['NOW()', 'CURRENT_DATE', 'CURRENT_TIMESTAMP', 'GETDATE()', 'SYSDATE'];
            dateFunctions.forEach(func => {
                if (query.toUpperCase().includes(func)) {
                    results.suggestions.push(`${func} ÏÇ¨Ïö© Ïãú ÌÉÄÏûÑÏ°¥Ïóê Ï£ºÏùòÌïòÏÑ∏Ïöî.`);
                }
            });

            // Î¨∏ÏûêÏó¥ Ìï®Ïàò Í≤ÄÏ¶ù
            if (query.match(/\bCONCAT\s*\(/i)) {
                results.suggestions.push('CONCAT Ìï®ÏàòÎäî NULLÏùÑ Îπà Î¨∏ÏûêÏó¥Î°ú Ï≤òÎ¶¨Ìï©ÎãàÎã§. CONCAT_WS ÏÇ¨Ïö©ÎèÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.');
            }

            // ÌòïÎ≥ÄÌôò Ìï®Ïàò Í≤ÄÏ¶ù
            const castMatch = query.match(/\bCAST\s*\((.*?)\s+AS\s+(\w+)\)/gi);
            if (castMatch) {
                results.suggestions.push('ÌòïÎ≥ÄÌôò Ïãú Îç∞Ïù¥ÌÑ∞ ÏÜêÏã§Ïù¥ Î∞úÏÉùÌïòÏßÄ ÏïäÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
            }

            // COALESCE vs IFNULL
            if (query.match(/\bIFNULL\s*\(/i)) {
                results.suggestions.push('IFNULL ÎåÄÏã† ÌëúÏ§Ä SQLÏù∏ COALESCE ÏÇ¨Ïö©ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî (Îã§Ï§ë Ïù∏Ïûê ÏßÄÏõê).');
            }

            // ÏßëÍ≥Ñ Ìï®Ïàò NULL Ï≤òÎ¶¨
            if (query.match(/\b(SUM|AVG|COUNT)\s*\(/i)) {
                results.suggestions.push('ÏßëÍ≥Ñ Ìï®ÏàòÎäî NULLÏùÑ Î¨¥ÏãúÌï©ÎãàÎã§. COUNT(*)ÏôÄ COUNT(column)Ïùò Ï∞®Ïù¥Î•º Ïù¥Ìï¥ÌïòÏÑ∏Ïöî.');
            }

            // CASE WHEN Íµ¨Î¨∏ Í≤ÄÏ¶ù
            const caseStatements = query.match(/\bCASE\b/gi);
            const whenStatements = query.match(/\bWHEN\b/gi);
            const endStatements = query.match(/\bEND\b/gi);
            
            if (caseStatements && endStatements) {
                if (caseStatements.length !== endStatements.length) {
                    results.errors.push('CASE Î¨∏Í≥º END Î¨∏Ïùò Í∞úÏàòÍ∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                    results.isValid = false;
                }
            }

            if (caseStatements && !whenStatements) {
                results.errors.push('CASE Î¨∏Ïóê WHEN Ï†àÏù¥ ÏóÜÏäµÎãàÎã§.');
                results.isValid = false;
            }

            // ÏúàÎèÑÏö∞ Ìï®Ïàò Í≤ÄÏ¶ù
            const windowFunctions = ['ROW_NUMBER', 'RANK', 'DENSE_RANK', 'LAG', 'LEAD', 'FIRST_VALUE', 'LAST_VALUE'];
            windowFunctions.forEach(func => {
                const pattern = new RegExp(`\\b${func}\\s*\\(`, 'i');
                if (query.match(pattern)) {
                    if (!query.match(/\bOVER\s*\(/i)) {
                        results.errors.push(`${func} ÏúàÎèÑÏö∞ Ìï®ÏàòÎäî OVER Ï†àÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.`);
                        results.isValid = false;
                    } else {
                        results.suggestions.push(`${func} ÏúàÎèÑÏö∞ Ìï®Ïàò ÏÇ¨Ïö© Ïãú PARTITION BYÏôÄ ORDER BYÎ•º Ï†ÅÏ†àÌûà ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.`);
                    }
                }
            });

            // Ï†ïÍ∑úÌëúÌòÑÏãù Ìï®Ïàò (REGEXP, LIKE)
            if (query.match(/\bREGEXP\b/i) || query.match(/\bRLIKE\b/i)) {
                results.warnings.push('Ï†ïÍ∑úÌëúÌòÑÏãùÏùÄ ÏÑ±Îä• ÎπÑÏö©Ïù¥ ÎÜíÏäµÎãàÎã§. Í∞ÑÎã®Ìïú Ìå®ÌÑ¥ÏùÄ LIKEÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
        }

        // 10. ÏÑ±Îä• ÏµúÏ†ÅÌôî Ï†úÏïà (ÎåÄÌè≠ Í∞ïÌôîÎê®)
        function suggestPerformanceOptimizations(query, results) {
            // Ï†ÑÏ≤¥ ÌÖåÏù¥Î∏î Ïä§Ï∫î Í∞ÄÎä•ÏÑ±
            if (!query.match(/\bWHERE\b/i) && query.match(/^\s*SELECT/i)) {
                const hasJoin = query.match(/\bJOIN\b/i);
                const hasLimit = query.match(/\bLIMIT\b/i);
                if (!hasJoin && !hasLimit) {
                    results.warnings.push('WHERE Ï†àÏù¥ ÏóÜÏñ¥ Ï†ÑÏ≤¥ ÌÖåÏù¥Î∏î Ïä§Ï∫îÏù¥ Î∞úÏÉùÌï† Ïàò ÏûàÏäµÎãàÎã§. ÏÑ±Îä•Ïóê Ï£ºÏùòÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE Ï†àÏùÑ Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò LIMITÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
            }

            // Ïù∏Îç±Ïä§ ÌôúÏö© Ï†úÏïà
            if (query.match(/\bWHERE\b/i)) {
                results.suggestions.push('WHERE Ï†àÏùò Ï°∞Í±¥ Ïª¨ÎüºÏóê Ïù∏Îç±Ïä§Í∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
                
                // WHERE Ï†àÏóêÏÑú Ïª¨ÎüºÏóê Ïó∞ÏÇ∞/Ìï®Ïàò Ï†ÅÏö© (Ïù∏Îç±Ïä§ ÎØ∏ÏÇ¨Ïö©)
                if (query.match(/WHERE\s+.*?(\w+)\s*[\+\-\*\/]\s*\d+/i)) {
                    results.warnings.push('WHERE Ï†àÏóêÏÑú Ïª¨ÎüºÏóê Ïó∞ÏÇ∞ÏùÑ Ï†ÅÏö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE salary + 1000 > 50000 ÎåÄÏã† WHERE salary > 49000ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏÑ∏Ïöî.');
                }
                
                // WHERE Ï†àÏóêÏÑú Ìï®Ïàò Ï†ÅÏö©
                if (query.match(/WHERE\s+.*?(YEAR|MONTH|DAY|DATE|UPPER|LOWER|SUBSTRING|TRIM|LEFT|RIGHT)\s*\(/i)) {
                    results.warnings.push('WHERE Ï†àÏóêÏÑú Ïª¨ÎüºÏóê Ìï®ÏàòÎ•º Ï†ÅÏö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Ìï®Ïàò Í∏∞Î∞ò Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±ÌïòÍ±∞ÎÇò Ïª¨ÎüºÏùÑ ÏßÅÏ†ë ÎπÑÍµêÌïòÏÑ∏Ïöî.');
                }
                
                // NOT Ïó∞ÏÇ∞Ïûê ÏÇ¨Ïö©
                if (query.match(/WHERE\s+.*?\bNOT\s+(LIKE|IN|EXISTS|BETWEEN)/i)) {
                    results.warnings.push('NOT Ïó∞ÏÇ∞ÏûêÎäî Ïù∏Îç±Ïä§ ÏµúÏ†ÅÌôîÎ•º Î∞©Ìï¥Ìï† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Í∞ÄÎä•ÌïòÎ©¥ Í∏çÏ†ï Ï°∞Í±¥ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏÑ∏Ïöî.');
                }
            }

            // ORDER BY ÏÑ±Îä•
            if (query.match(/\bORDER\s+BY\b/i)) {
                if (!query.match(/\bLIMIT\b/i)) {
                    results.warnings.push('ORDER BYÎ•º LIMIT ÏóÜÏù¥ ÏÇ¨Ïö©ÌïòÎ©¥ Ï†ÑÏ≤¥ Í≤∞Í≥ºÎ•º Ï†ïÎ†¨Ìï¥Ïïº ÌïòÎØÄÎ°ú ÏÑ±Îä• Ï†ÄÌïòÍ∞Ä Î∞úÏÉùÌï† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: LIMITÎ•º Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò Ï†ïÎ†¨ Ïª¨ÎüºÏóê Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±ÌïòÏÑ∏Ïöî.');
                }
                
                // ORDER BYÏóêÏÑú Ìï®Ïàò ÏÇ¨Ïö©
                if (query.match(/ORDER\s+BY\s+.*?(UPPER|LOWER|SUBSTRING|CONCAT|DATE|YEAR)/i)) {
                    results.warnings.push('ORDER BYÏóêÏÑú Ìï®ÏàòÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ Ïù∏Îç±Ïä§Î•º ÌôúÏö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÎØ∏Î¶¨ Í≥ÑÏÇ∞Îêú Ïª¨ÎüºÏù¥ÎÇò Ìï®Ïàò Í∏∞Î∞ò Ïù∏Îç±Ïä§Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
                
                // Ïó¨Îü¨ Ïª¨Îüº Ï†ïÎ†¨
                const orderByColumns = (query.match(/ORDER\s+BY\s+(.*?)(?:LIMIT|OFFSET|UNION|;|$)/is) || [])[1];
                if (orderByColumns && orderByColumns.split(',').length > 3) {
                    results.warnings.push('Ïó¨Îü¨ Ïª¨ÎüºÏúºÎ°ú Ï†ïÎ†¨ÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ï†ÄÌïòÎê† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Î≥µÌï© Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±ÌïòÍ±∞ÎÇò Ï†ïÎ†¨ Ïª¨ÎüºÏùÑ ÏµúÏÜåÌôîÌïòÏÑ∏Ïöî.');
                }
            }

            // SELECT DISTINCT ÏµúÏ†ÅÌôî
            if (query.match(/SELECT\s+DISTINCT/i)) {
                if (!query.match(/\bGROUP\s+BY\b/i)) {
                    results.suggestions.push('GROUP BYÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ DISTINCTÎ≥¥Îã§ Ï†úÏñ¥Í∞Ä Ïö©Ïù¥ÌïòÍ≥† ÏßëÍ≥ÑÎèÑ Í∞ÄÎä•Ìï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: SELECT DISTINCT col1 ÎåÄÏã† SELECT col1 FROM table GROUP BY col1ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
                
                // DISTINCTÏôÄ ÎåÄÎüâ Îç∞Ïù¥ÌÑ∞
                if (!query.match(/\bLIMIT\b/i)) {
                    results.warnings.push('DISTINCTÎäî Ï†ÑÏ≤¥ Í≤∞Í≥ºÎ•º Î©îÎ™®Î¶¨ÏóêÏÑú Ï§ëÎ≥µ Ï†úÍ±∞ÌïòÎØÄÎ°ú ÏÑ±Îä• ÎπÑÏö©Ïù¥ ÎÜíÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: LIMITÎ•º Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò Ïù∏Îç±Ïä§Î•º ÌôúÏö©ÌïòÏÑ∏Ïöî.');
                }
            }

            // ÎßéÏùÄ Ïª¨Îüº ÏÑ†ÌÉù
            const selectMatch = query.match(/SELECT\s+(.*?)\s+FROM/is);
            if (selectMatch && !selectMatch[1].includes('*')) {
                const columns = selectMatch[1].split(',');
                if (columns.length > 20) {
                    results.warnings.push(`${columns.length}Í∞úÏùò Ïª¨ÎüºÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§. Ï†ïÎßê ÌïÑÏöîÌïú Ïª¨ÎüºÎßå ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÎäî Ïª¨ÎüºÏùÑ Ï†úÍ±∞ÌïòÏó¨ Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°ÎüâÏùÑ Ï§ÑÏù¥ÏÑ∏Ïöî.`);
                }
            }

            // ÎåÄÏö©Îüâ IN Ï†à
            const inMatch = query.match(/\bIN\s*\(([^)]+)\)/gi);
            if (inMatch) {
                inMatch.forEach(inClause => {
                    const content = inClause.match(/\(([^)]+)\)/)[1];
                    const values = content.split(',');
                    if (values.length > 100) {
                        results.warnings.push(`IN Ï†àÏóê ${values.length}Í∞úÏùò Í∞íÏù¥ ÏûàÏäµÎãàÎã§. ÎåÄÎüâ Îç∞Ïù¥ÌÑ∞Îäî ÏûÑÏãú ÌÖåÏù¥Î∏îÏù¥ÎÇò JOINÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.\nüí° ÏàòÏ†ï Ï†úÏïà: ÏûÑÏãú ÌÖåÏù¥Î∏îÏùÑ ÏÉùÏÑ±ÌïòÍ≥† JOINÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏÑ∏Ïöî.`);
                    } else if (values.length > 1000) {
                        results.errors.push(`IN Ï†àÏóê ${values.length}Í∞úÏùò Í∞íÏù¥ ÏûàÏäµÎãàÎã§. ÎßéÏùÄ DBÏóêÏÑú IN Ï†à Ï†úÌïúÏùÑ Ï¥àÍ≥ºÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Î∞òÎìúÏãú ÏûÑÏãú ÌÖåÏù¥Î∏îÎ°ú Î≥ÄÍ≤ΩÌïòÏÑ∏Ïöî.`);
                        results.isValid = false;
                    }
                });
            }

            // Î≥µÏû°Ìïú ÏÑúÎ∏åÏøºÎ¶¨
            const subqueryDepth = calculateSubqueryDepth(query);
            if (subqueryDepth > 3) {
                results.warnings.push(`ÏÑúÎ∏åÏøºÎ¶¨ Ï§ëÏ≤© ÍπäÏù¥Í∞Ä ${subqueryDepth}Îã®Í≥ÑÏûÖÎãàÎã§. Í∞ÄÎèÖÏÑ±Í≥º ÏÑ±Îä•Ïù¥ Ï†ÄÌïòÎê©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: CTE(WITH Ï†à)ÎÇò ÏûÑÏãú ÌÖåÏù¥Î∏îÎ°ú Î∂ÑÎ¶¨ÌïòÏÑ∏Ïöî.`);
            } else if (subqueryDepth > 2) {
                results.suggestions.push('Ï§ëÏ≤©Îêú ÏÑúÎ∏åÏøºÎ¶¨Îäî ÏûÑÏãú ÌÖåÏù¥Î∏îÏù¥ÎÇò CTEÎ°ú Î∂ÑÎ¶¨ÌïòÎ©¥ ÏÑ±Îä•Í≥º Í∞ÄÎèÖÏÑ±Ïù¥ Ìñ•ÏÉÅÎê©ÎãàÎã§.');
            }
            
            // Ïä§ÏπºÎùº ÏÑúÎ∏åÏøºÎ¶¨ (SELECT Ï†àÏùò ÏÑúÎ∏åÏøºÎ¶¨)
            const scalarSubqueries = (query.match(/SELECT\s+[^,]*\(\s*SELECT[^)]*\)\s*/gi) || []).length;
            if (scalarSubqueries > 0) {
                results.warnings.push(`${scalarSubqueries}Í∞úÏùò Ïä§ÏπºÎùº ÏÑúÎ∏åÏøºÎ¶¨Í∞Ä Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§. Í∞Å ÌñâÎßàÎã§ Ïã§ÌñâÎêòÎØÄÎ°ú N+1 Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: LEFT JOINÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏó¨ Ìïú Î≤àÏóê Ï°∞ÌöåÌïòÏÑ∏Ïöî.`);
            }
            
            // IN Ï†àÏùò ÏÑúÎ∏åÏøºÎ¶¨ ÏµúÏ†ÅÌôî
            if (query.match(/\bIN\s*\(\s*SELECT/i)) {
                results.suggestions.push('IN (SELECT ...)Îäî EXISTSÎ°ú Î≥ÄÍ≤ΩÌïòÎ©¥ ÏÑ±Îä•Ïù¥ Ìñ•ÏÉÅÎê† Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE col IN (SELECT ...) ÎåÄÏã† WHERE EXISTS (SELECT 1 FROM ... WHERE ...)Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }
            
            // Ïπ¥ÌÖåÏãúÏïà Í≥± ÏúÑÌóò
            const fromMatch = query.match(/FROM\s+(.*?)(?:WHERE|JOIN|GROUP|ORDER|LIMIT|UNION|;|$)/is);
            if (fromMatch) {
                const tables = fromMatch[1].split(',').map(t => t.trim()).filter(t => t);
                if (tables.length > 1 && !query.match(/\bWHERE\b/i) && !query.match(/\bJOIN\b/i)) {
                    results.errors.push(`${tables.length}Í∞úÏùò ÌÖåÏù¥Î∏îÏùÑ Ï°∞Ïù∏ Ï°∞Í±¥ ÏóÜÏù¥ ÏÇ¨Ïö©ÌïòÎ©¥ Ïπ¥ÌÖåÏãúÏïà Í≥±Ïù¥ Î∞úÏÉùÌï©ÎãàÎã§!\nüí° ÏàòÏ†ï Ï†úÏïà: WHERE Ï†àÏóê Ï°∞Ïù∏ Ï°∞Í±¥ÏùÑ Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò Î™ÖÏãúÏ†Å JOINÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.`);
                    results.isValid = false;
                }
            }
            
            // COUNT(*) vs COUNT(column)
            if (query.match(/COUNT\s*\(\s*\*\s*\)/i) && query.match(/WHERE/i)) {
                results.suggestions.push('COUNT(*)Îäî Î™®Îì† ÌñâÏùÑ ÏÑ∏ÏßÄÎßå, NULLÏù¥ ÏóÜÎäî Ïª¨ÎüºÏùò COUNT(column)Í∞Ä Îçî Îπ†Î•º Ïàò ÏûàÏäµÎãàÎã§.');
            }
            
            // GROUP BY ÏóÜÏù¥ ÏßëÍ≥Ñ Ìï®Ïàò
            const aggregates = ['COUNT', 'SUM', 'AVG', 'MIN', 'MAX'];
            const hasAggregate = aggregates.some(agg => query.match(new RegExp(`\\b${agg}\\s*\\(`, 'i')));
            if (hasAggregate && !query.match(/\bGROUP\s+BY\b/i)) {
                const selectCols = (query.match(/SELECT\s+(.*?)\s+FROM/is) || [])[1];
                if (selectCols && selectCols.split(',').length > 1) {
                    results.warnings.push('ÏßëÍ≥Ñ Ìï®ÏàòÏôÄ ÏùºÎ∞ò Ïª¨ÎüºÏùÑ Ìï®Íªò SELECTÌïòÎ©¥ GROUP BYÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: GROUP BY Ï†àÏùÑ Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò ÏßëÍ≥Ñ Ìï®ÏàòÎßå ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
            }
            
            // LIKE Ìå®ÌÑ¥ ÏµúÏ†ÅÌôî
            if (query.match(/LIKE\s+['"]%.*%['"]/i)) {
                results.warnings.push("LIKE '%Í∞í%'Îäî Ï†ÑÏ≤¥ ÌÖåÏù¥Î∏î Ïä§Ï∫îÏùÑ Ïú†Î∞úÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Ï†ÑÎ¨∏ Í≤ÄÏÉâ(FULLTEXT INDEX) ÎòêÎäî LIKE 'Í∞í%'Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.");
            }
            
            // OFFSET ÎåÄÏã† ÌÇ§ÏÖã ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò
            const offsetMatch = query.match(/OFFSET\s+(\d+)/i);
            if (offsetMatch && parseInt(offsetMatch[1]) > 10000) {
                results.warnings.push(`OFFSET ${offsetMatch[1]}Îäî Îß§Ïö∞ ÌÅ∞ Í∞íÏûÖÎãàÎã§. ÏïûÏùò Î™®Îì† ÌñâÏùÑ Í±¥ÎÑàÎõ∞ÎØÄÎ°ú ÏÑ±Îä•Ïù¥ Îß§Ïö∞ ÎÇòÏÅ©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÌÇ§ÏÖã ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò(WHERE id > last_id LIMIT n)ÏùÑ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.`);
            }
            
            // Î∂àÌïÑÏöîÌïú DISTINCT
            if (query.match(/SELECT\s+DISTINCT/i) && query.match(/\bGROUP\s+BY\b/i)) {
                results.warnings.push('GROUP BYÎ•º ÏÇ¨Ïö©ÌïòÎ©¥ Ïù¥ÎØ∏ Ï§ëÎ≥µÏù¥ Ï†úÍ±∞ÎêòÎØÄÎ°ú DISTINCTÍ∞Ä Î∂àÌïÑÏöîÌï©ÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: DISTINCTÎ•º Ï†úÍ±∞ÌïòÏÑ∏Ïöî.');
            }
        }
        
        // ÏÑúÎ∏åÏøºÎ¶¨ ÍπäÏù¥ Í≥ÑÏÇ∞ (Ï†ïÍµêÌïú Î≤ÑÏ†Ñ)
        function calculateSubqueryDepth(query) {
            let maxDepth = 0;
            let currentDepth = 0;
            let inString = false;
            let stringChar = '';
            
            for (let i = 0; i < query.length; i++) {
                const char = query[i];
                
                // Î¨∏ÏûêÏó¥ Ï≤òÎ¶¨
                if ((char === "'" || char === '"') && !inString) {
                    inString = true;
                    stringChar = char;
                } else if (char === stringChar && inString) {
                    inString = false;
                }
                
                if (!inString) {
                    if (char === '(') {
                        // Îã§Ïùå Î™á Í∏ÄÏûêÎ•º ÌôïÏù∏ÌïòÏó¨ SELECTÍ∞Ä ÏûàÎäîÏßÄ Ï≤¥ÌÅ¨
                        const nextChars = query.substring(i, i + 50).toUpperCase().trim();
                        if (nextChars.match(/^\(\s*SELECT/)) {
                            currentDepth++;
                            maxDepth = Math.max(maxDepth, currentDepth);
                        }
                    } else if (char === ')') {
                        // SELECT ÏÑúÎ∏åÏøºÎ¶¨Ïùò ÎÅùÏù∏ÏßÄ ÌôïÏù∏
                        if (currentDepth > 0) {
                            currentDepth--;
                        }
                    }
                }
            }
            
            return maxDepth;
        }

        // 11. Î≥¥Ïïà Ï∑®ÏïΩÏ†ê Í≤ÄÏÇ¨ (ÎåÄÌè≠ Í∞ïÌôîÎê®)
        function checkSecurityVulnerabilities(query, results) {
            // SQL Ïù∏Ï†ùÏÖò Ìå®ÌÑ¥ (ÌôïÏû•Îê®)
            const injectionPatterns = [
                { pattern: /['"]\s*OR\s+['"]?\d+['"]?\s*=\s*['"]?\d+/i, desc: "OR '1'='1' Ìå®ÌÑ¥" },
                { pattern: /['"]\s*OR\s+['"]\w+['"]\s*=\s*['"]\w+/i, desc: "OR 'a'='a' Ìå®ÌÑ¥" },
                { pattern: /['"]\s*;\s*DROP\s+TABLE/i, desc: "DROP TABLE ÏãúÎèÑ" },
                { pattern: /['"]\s*;\s*DELETE\s+FROM/i, desc: "DELETE FROM ÏãúÎèÑ" },
                { pattern: /['"]\s*;\s*UPDATE\s+/i, desc: "UPDATE ÏãúÎèÑ" },
                { pattern: /['"]\s*UNION\s+SELECT/i, desc: "UNION SELECT ÏãúÎèÑ" },
                { pattern: /['"]\s*UNION\s+ALL\s+SELECT/i, desc: "UNION ALL SELECT ÏãúÎèÑ" },
                { pattern: /--\s*$/m, desc: "Ï£ºÏÑùÏùÑ Ïù¥Ïö©Ìïú Ïö∞Ìöå" },
                { pattern: /\/\*.*?\*\//s, desc: "Î∏îÎ°ù Ï£ºÏÑù ÏÇ¨Ïö©" },
                { pattern: /\bEXEC\s*\(/i, desc: "EXEC ÎèôÏ†Å Ïã§Ìñâ" },
                { pattern: /\bEXECUTE\s*\(/i, desc: "EXECUTE ÎèôÏ†Å Ïã§Ìñâ" },
                { pattern: /['"]\s*AND\s+['"]?\d+['"]?\s*=\s*['"]?\d+/i, desc: "AND '1'='1' Ìå®ÌÑ¥" },
                { pattern: /['"]\s*\|\|/i, desc: "Î¨∏ÏûêÏó¥ Ïó∞Í≤∞ÏùÑ ÌÜµÌïú Ïù∏Ï†ùÏÖò" },
                { pattern: /\bSLEEP\s*\(/i, desc: "Time-based SQL Injection" },
                { pattern: /\bBENCHMARK\s*\(/i, desc: "BENCHMARKÎ•º Ïù¥Ïö©Ìïú Í≥µÍ≤©" },
                { pattern: /\bLOAD_FILE\s*\(/i, desc: "ÌååÏùº ÏãúÏä§ÌÖú Ï†ëÍ∑º ÏãúÎèÑ" },
                { pattern: /\bINTO\s+OUTFILE/i, desc: "ÌååÏùº Ïì∞Í∏∞ ÏãúÎèÑ" },
                { pattern: /\bINTO\s+DUMPFILE/i, desc: "Îç§ÌîÑ ÌååÏùº ÏÉùÏÑ± ÏãúÎèÑ" },
                { pattern: /['"]\s*XOR\s+/i, desc: "XOR Ïó∞ÏÇ∞ÏûêÎ•º Ïù¥Ïö©Ìïú Ïö∞Ìöå" },
                { pattern: /CHAR\s*\(\s*\d+/i, desc: "CHAR Ìï®ÏàòÎ•º Ïù¥Ïö©Ìïú Ïù∏ÏΩîÎî© Ïö∞Ìöå" },
                { pattern: /CONCAT\s*\(.*?CHAR\s*\(/i, desc: "CONCAT+CHARÎ•º Ïù¥Ïö©Ìïú Ïù∏Ï†ùÏÖò" }
            ];

            let injectionFound = false;
            injectionPatterns.forEach(({ pattern, desc }) => {
                if (query.match(pattern)) {
                    results.warnings.push(`‚ö†Ô∏è SQL Ïù∏Ï†ùÏÖò ÏúÑÌóò: ${desc}Ïù¥(Í∞Ä) Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÌååÎùºÎØ∏ÌÑ∞ÌôîÎêú ÏøºÎ¶¨(Prepared Statement)Î•º ÏÇ¨Ïö©ÌïòÍ≥† ÏûÖÎ†•Í∞íÏùÑ Í≤ÄÏ¶ùÌïòÏÑ∏Ïöî.`);
                    injectionFound = true;
                }
            });

            // ÎèôÏ†Å SQL ÏúÑÌóò
            if (query.match(/CONCAT\s*\(.*?WHERE/is)) {
                results.warnings.push('‚ö†Ô∏è ÎèôÏ†Å SQL: WHERE Ï†àÏóêÏÑú CONCATÏùÑ ÏÇ¨Ïö©Ìïú ÎèôÏ†Å ÏøºÎ¶¨ ÏÉùÏÑ±Ïù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Îß§Í∞úÎ≥ÄÏàòÌôîÎêú ÏøºÎ¶¨Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
            }

            // ÏúÑÌóòÌïú Î™ÖÎ†πÏñ¥
            const dangerousCommands = [
                { cmd: 'DROP', level: 'critical', desc: 'ÌÖåÏù¥Î∏î/Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÇ≠Ï†ú' },
                { cmd: 'TRUNCATE', level: 'critical', desc: 'ÌÖåÏù¥Î∏î Ï†ÑÏ≤¥ ÏÇ≠Ï†ú' },
                { cmd: 'ALTER', level: 'warning', desc: 'ÌÖåÏù¥Î∏î Íµ¨Ï°∞ Î≥ÄÍ≤Ω' },
                { cmd: 'GRANT', level: 'warning', desc: 'Í∂åÌïú Î∂ÄÏó¨' },
                { cmd: 'REVOKE', level: 'warning', desc: 'Í∂åÌïú ÌöåÏàò' },
                { cmd: 'SHUTDOWN', level: 'critical', desc: 'ÏÑúÎ≤Ñ Ï¢ÖÎ£å' }
            ];
            
            dangerousCommands.forEach(({ cmd, level, desc }) => {
                if (query.match(new RegExp(`\\b${cmd}\\b`, 'i'))) {
                    if (level === 'critical') {
                        results.errors.push(`‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Îß§Ïö∞ ÏúÑÌóò: ${cmd} Î™ÖÎ†πÏñ¥(${desc})Í∞Ä Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§!\nüí° Í≤ΩÍ≥†: Ïù¥ Î™ÖÎ†πÏùÄ ÎèåÏù¥ÌÇ¨ Ïàò ÏóÜÎäî Î≥ÄÍ≤ΩÏùÑ Î∞úÏÉùÏãúÌÇµÎãàÎã§. Îß§Ïö∞ Ïã†Ï§ëÌïòÍ≤å Ïã§ÌñâÌïòÏÑ∏Ïöî.`);
                    } else {
                        results.warnings.push(`‚ö†Ô∏è ÏúÑÌóò: ${cmd} Î™ÖÎ†πÏñ¥(${desc})Í∞Ä Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.\nüí° Ï£ºÏùò: Ïù¥ Î™ÖÎ†πÏùÄ Ïã†Ï§ëÌïòÍ≤å Ïã§ÌñâÌï¥Ïïº Ìï©ÎãàÎã§.`);
                    }
                }
            });

            // Í∂åÌïú Í¥ÄÎ†®
            if (query.match(/\bGRANT\b/i) || query.match(/\bREVOKE\b/i)) {
                results.warnings.push('Í∂åÌïú Í¥ÄÎ†® Î™ÖÎ†πÏñ¥Îäî DBA Í∂åÌïúÏù¥ ÌïÑÏöîÌïòÎ©∞, Î≥¥ÏïàÏóê ÏòÅÌñ•ÏùÑ Ï§Ñ Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Í∂åÌïú Î≥ÄÍ≤Ω ÎÇ¥Ïó≠ÏùÑ Î°úÍ∑∏Î°ú ÎÇ®Í∏∞ÏÑ∏Ïöî.');
            }
            
            // ÌÅ¨Î¶¨Îç¥ÏÖú ÌïòÎìúÏΩîÎî© Í∞êÏßÄ
            const credentialPatterns = [
                /password\s*=\s*['"][^'"]+['"]/i,
                /pwd\s*=\s*['"][^'"]+['"]/i,
                /api[_-]?key\s*=\s*['"][^'"]+['"]/i,
                /secret\s*=\s*['"][^'"]+['"]/i,
                /token\s*=\s*['"][^'"]+['"]/i
            ];
            
            credentialPatterns.forEach(pattern => {
                if (query.match(pattern)) {
                    results.warnings.push('‚ö†Ô∏è Î≥¥Ïïà: ÏøºÎ¶¨Ïóê ÎπÑÎ∞ÄÎ≤àÌò∏ÎÇò Ïù∏Ï¶ù Ï†ïÎ≥¥Í∞Ä ÌïòÎìúÏΩîÎî©ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÌôòÍ≤Ω Î≥ÄÏàòÎÇò Î≥¥Ïïà Ï†ÄÏû•ÏÜåÎ•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.');
                }
            });
            
            // Ï£ºÏÑù ÎÇ¥ ÎØºÍ∞ê Ï†ïÎ≥¥
            const commentMatch = query.match(/--.*?(password|pwd|secret|key|token)/i);
            if (commentMatch) {
                results.warnings.push('‚ö†Ô∏è Î≥¥Ïïà: Ï£ºÏÑùÏóê ÎØºÍ∞êÌïú Ï†ïÎ≥¥Í∞Ä Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏùÑ Ïàò ÏûàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: Ï£ºÏÑùÏóêÏÑú ÎØºÍ∞ê Ï†ïÎ≥¥Î•º Ï†úÍ±∞ÌïòÏÑ∏Ïöî.');
            }
            
            // Î¨¥Ï°∞Í±¥ Ï∞∏Ïù∏ Ï°∞Í±¥ (Ïù∏Ï†ùÏÖò ÌùîÏ†Å)
            if (query.match(/WHERE\s+.*?['"]?1['"]?\s*=\s*['"]?1['"]?/i) && !query.match(/AND|OR/i)) {
                results.warnings.push('‚ö†Ô∏è ÏùòÏã¨Ïä§Îü¨Ïö¥ Ìå®ÌÑ¥: WHERE 1=1 Ï°∞Í±¥Ïù¥ Îã®ÎèÖÏúºÎ°ú ÏÇ¨Ïö©ÎêòÏóàÏäµÎãàÎã§.\nüí° ÏàòÏ†ï Ï†úÏïà: ÏùòÎèÑÌïú Í≤ÉÏù¥ ÏïÑÎãàÎùºÎ©¥ Ï†úÍ±∞ÌïòÍ≥†, ÎèôÏ†Å ÏøºÎ¶¨ÎùºÎ©¥ ÌååÎùºÎØ∏ÌÑ∞ÌôîÌïòÏÑ∏Ïöî.');
            }
            
            // INFORMATION_SCHEMA Ï†ëÍ∑º (Ï†ïÎ≥¥ ÏàòÏßë ÏãúÎèÑ)
            if (query.match(/INFORMATION_SCHEMA/i)) {
                results.warnings.push('‚ö†Ô∏è Î≥¥Ïïà: INFORMATION_SCHEMAÏóê Ï†ëÍ∑ºÌïòÍ≥† ÏûàÏäµÎãàÎã§.\nüí° Ï£ºÏùò: Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Íµ¨Ï°∞ Ï†ïÎ≥¥ ÎÖ∏Ï∂úÏóê Ï£ºÏùòÌïòÏÑ∏Ïöî.');
            }
            
            // ÏãúÏä§ÌÖú ÌîÑÎ°úÏãúÏ†Ä/Ìï®Ïàò (MySQL/SQL Server)
            const systemFunctions = [
                'xp_cmdshell', 'sp_executesql', 'sp_OACreate', 'USER_NAME', 
                'SYSTEM_USER', 'SESSION_USER', 'DATABASE()', 'VERSION()'
            ];
            
            systemFunctions.forEach(func => {
                if (query.match(new RegExp(`\\b${func.replace(/[()]/g, '\\$&')}`, 'i'))) {
                    results.warnings.push(`‚ö†Ô∏è Î≥¥Ïïà: ÏãúÏä§ÌÖú Ìï®Ïàò ${func}Í∞Ä Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.\nüí° Ï£ºÏùò: ÏãúÏä§ÌÖú Ï†ïÎ≥¥ ÎÖ∏Ï∂úÏóê Ï£ºÏùòÌïòÏÑ∏Ïöî.`);
                }
            });
            
            // Î∞±ÎèÑÏñ¥ Ìå®ÌÑ¥
            if (query.match(/WHERE\s+.*?['"]admin['"].*?['"]admin['"]/i)) {
                results.warnings.push('‚ö†Ô∏è ÏùòÏã¨Ïä§Îü¨Ïö¥ Ìå®ÌÑ¥: Í¥ÄÎ¶¨Ïûê Í≥ÑÏ†ï Í¥ÄÎ†® ÏùòÏã¨Ïä§Îü¨Ïö¥ Ìå®ÌÑ¥Ïù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.\nüí° Í≤ΩÍ≥†: Î∞±ÎèÑÏñ¥ ÏÇΩÏûÖ ÏãúÎèÑÏùº Ïàò ÏûàÏäµÎãàÎã§.');
            }
        }

        // 12. ÏòàÏïΩÏñ¥ Î∞è ÏãùÎ≥ÑÏûê Í≤ÄÏ¶ù
        function validateReservedWordsAndIdentifiers(query, tokens, results) {
            // SQL ÏòàÏïΩÏñ¥ Î™©Î°ù (Ï£ºÏöî ÏòàÏïΩÏñ¥Îßå)
            const reservedWords = [
                'SELECT', 'FROM', 'WHERE', 'JOIN', 'ON', 'AS', 'AND', 'OR', 'NOT', 'IN', 'LIKE',
                'BETWEEN', 'IS', 'NULL', 'EXISTS', 'ALL', 'ANY', 'SOME', 'UNION', 'INTERSECT',
                'EXCEPT', 'ORDER', 'BY', 'GROUP', 'HAVING', 'LIMIT', 'OFFSET', 'DISTINCT',
                'INSERT', 'INTO', 'VALUES', 'UPDATE', 'SET', 'DELETE', 'CREATE', 'TABLE',
                'ALTER', 'DROP', 'INDEX', 'VIEW', 'DATABASE', 'SCHEMA', 'CONSTRAINT', 'PRIMARY',
                'FOREIGN', 'KEY', 'UNIQUE', 'CHECK', 'DEFAULT', 'AUTO_INCREMENT', 'IDENTITY',
                'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'IF', 'BEGIN', 'COMMIT', 'ROLLBACK'
            ];

            // ÏòàÏïΩÏñ¥Î•º ÌÖåÏù¥Î∏î/Ïª¨ÎüºÎ™ÖÏúºÎ°ú ÏÇ¨Ïö©ÌïòÎäîÏßÄ Ï≤¥ÌÅ¨
            const identifierPattern = /(?:FROM|JOIN|UPDATE|INTO)\s+(\w+)|(?:SELECT|SET)\s+(\w+)/gi;
            let match;
            while ((match = identifierPattern.exec(query)) !== null) {
                const identifier = (match[1] || match[2]).toUpperCase();
                if (reservedWords.includes(identifier)) {
                    results.warnings.push(`"${identifier}"Îäî SQL ÏòàÏïΩÏñ¥ÏûÖÎãàÎã§. ÏãùÎ≥ÑÏûêÎ°ú ÏÇ¨Ïö© Ïãú Î∞±Ìã±(\`)Ïù¥ÎÇò ÎåÄÍ¥ÑÌò∏([])Î°ú Í∞êÏã∏ÏÑ∏Ïöî.`);
                }
            }

            // ÌÖåÏù¥Î∏î/Ïª¨ÎüºÎ™ÖÏóê Í≥µÎ∞±Ïù¥ ÏûàÎäî Í≤ΩÏö∞
            if (query.match(/\b(?:FROM|JOIN|UPDATE|INTO)\s+[a-z0-9]+\s+[a-z0-9]+\b/i)) {
                results.warnings.push('ÌÖåÏù¥Î∏îÎ™ÖÏù¥ÎÇò Ïª¨ÎüºÎ™ÖÏóê Í≥µÎ∞±Ïù¥ Ìè¨Ìï®Îêú Í≤ÉÏúºÎ°ú Î≥¥ÏûÖÎãàÎã§. Î≥ÑÏπ≠(AS)ÏùÑ Î™ÖÏãúÌïòÍ±∞ÎÇò ÏãùÎ≥ÑÏûêÎ•º Îî∞Ïò¥ÌëúÎ°ú Í∞êÏã∏ÏÑ∏Ïöî.');
            }

            // ÌïúÍ∏Ä ÏãùÎ≥ÑÏûê ÏÇ¨Ïö©
            if (query.match(/[Í∞Ä-Ìû£]/)) {
                results.suggestions.push('ÌïúÍ∏Ä ÏãùÎ≥ÑÏûêÎäî ÏùºÎ∂Ä DBÏóêÏÑú Ï†úÎåÄÎ°ú ÏûëÎèôÌïòÏßÄ ÏïäÏùÑ Ïàò ÏûàÏäµÎãàÎã§. ÏòÅÎ¨∏ ÏÇ¨Ïö©ÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.');
            }
        }

        function showValidationResults(validation) {
            if (!activeTabId) return;
            
            const panel = document.getElementById(`validation-${activeTabId}`);
            if (!panel) return;
            
            let html = '<div class="validation-result">';
            
            if (validation.errors.length > 0) {
                validation.errors.forEach(error => {
                    html += `<div class="validation-item error">
                        <span class="material-icons" style="font-size: 14px;">error</span>
                        <span>${error}</span>
                    </div>`;
                });
            }
            
            if (validation.warnings.length > 0) {
                validation.warnings.forEach(warning => {
                    html += `<div class="validation-item warning">
                        <span class="material-icons" style="font-size: 14px;">warning</span>
                        <span>${warning}</span>
                    </div>`;
                });
            }
            
            if (validation.suggestions.length > 0) {
                validation.suggestions.forEach(suggestion => {
                    html += `<div class="validation-item info">
                        <span class="material-icons" style="font-size: 14px;">lightbulb</span>
                        <span>${suggestion}</span>
                    </div>`;
                });
            }
            
            if (validation.errors.length === 0 && validation.warnings.length === 0 && validation.suggestions.length === 0) {
                html += `<div class="validation-item success">
                    <span class="material-icons" style="font-size: 14px;">check_circle</span>
                    <span>ÏøºÎ¶¨ Í≤ÄÏ¶ù ÌÜµÍ≥º! Î¨∏Î≤ïÏ†ÅÏúºÎ°ú Ïò¨Î∞îÎ•∏ ÏøºÎ¶¨ÏûÖÎãàÎã§.</span>
                </div>`;
            }
            
            html += '</div>';
            
            panel.innerHTML = html;
            panel.style.display = 'block';
            
            if (validation.isValid && validation.warnings.length === 0) {
                setTimeout(() => {
                    panel.style.display = 'none';
                }, 5000);
            }
        }

        // ===== ÏøºÎ¶¨ Ïã§Ìñâ =====
        function executeQuery() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            const sql = editor.value.trim();
            
            if (!sql) {
                alert('Ïã§ÌñâÌï† ÏøºÎ¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            
            const validation = performAdvancedValidation(sql);
            
            if (!validation.isValid) {
                alert('ÏøºÎ¶¨Ïóê Ïò§Î•òÍ∞Ä ÏûàÏäµÎãàÎã§:\n\n' + validation.errors.join('\n'));
                showValidationResults(validation);
                return;
            }
            
            updateStatus('statusMessage', 'ÏøºÎ¶¨ Ïã§Ìñâ Ï§ë...');
            
            const startTime = Date.now();
            
            setTimeout(() => {
                const executionTime = Date.now() - startTime;
                
                const sampleData = [
                    { id: 1, name: 'John Doe', email: 'john@example.com', department: 'IT', salary: 75000 },
                    { id: 2, name: 'Jane Smith', email: 'jane@example.com', department: 'HR', salary: 65000 },
                    { id: 3, name: 'Mike Johnson', email: 'mike@example.com', department: 'Sales', salary: 70000 },
                    { id: 4, name: 'Sarah Williams', email: 'sarah@example.com', department: 'IT', salary: 80000 },
                    { id: 5, name: 'Tom Brown', email: 'tom@example.com', department: 'Finance', salary: 72000 }
                ];
                
                displayResults(sampleData, executionTime);
                
                queryHistory.push({
                    query: sql,
                    timestamp: new Date().toLocaleString('ko-KR'),
                    rowCount: sampleData.length,
                    executionTime: executionTime
                });
                
                if (validation.warnings.length > 0 || validation.suggestions.length > 0) {
                    showValidationResults(validation);
                }
                
                updateStatus('statusMessage', `ÏøºÎ¶¨ Ïã§Ìñâ ÏôÑÎ£å (${executionTime}ms, ${sampleData.length}Ìñâ)`);
            }, 100 + Math.random() * 400);
        }

        function displayResults(data, executionTime) {
            const resultGrid = document.getElementById('resultGrid');
            const resultInfo = document.getElementById('resultInfo');
            
            if (!data || data.length === 0) {
                resultGrid.innerHTML = '<p style="color: #a0aec0; text-align: center; margin-top: 50px;">Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                resultInfo.classList.remove('show');
                return;
            }
            
            // Í≤∞Í≥º Ï†ïÎ≥¥ ÌëúÏãú
            const rowCount = data.length;
            const columnCount = Object.keys(data[0]).length;
            const memoryUsage = ((JSON.stringify(data).length / 1024).toFixed(2)) + ' KB';
            
            document.getElementById('infoRowCount').textContent = rowCount.toLocaleString();
            document.getElementById('infoColumnCount').textContent = columnCount;
            document.getElementById('infoExecutionTime').textContent = executionTime + ' ms';
            document.getElementById('infoMemoryUsage').textContent = memoryUsage;
            
            resultInfo.classList.add('show');
            
            // ÌÖåÏù¥Î∏î ÏÉùÏÑ±
            const columns = Object.keys(data[0]);
            
            let html = '<table class="result-grid"><thead><tr>';
            columns.forEach(col => {
                html += `<th>${col}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            data.forEach(row => {
                html += '<tr>';
                columns.forEach(col => {
                    html += `<td>${row[col] !== null && row[col] !== undefined ? row[col] : 'NULL'}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            resultGrid.innerHTML = html;
            
            switchResultTab('data');
        }

        function switchResultTab(tab) {
            document.querySelectorAll('.result-tab').forEach(t => t.classList.remove('active'));
            const activeTab = document.querySelector(`.result-tab[data-tab="${tab}"]`);
            if (activeTab) activeTab.classList.add('active');
            
            const resultGrid = document.getElementById('resultGrid');
            const resultInfo = document.getElementById('resultInfo');
            
            if (tab === 'data') {
                // Îç∞Ïù¥ÌÑ∞ ÌÉ≠ÏùÄ ÌòÑÏû¨ ÏÉÅÌÉú Ïú†ÏßÄ
            } else if (tab === 'messages') {
                resultInfo.classList.remove('show');
                resultGrid.innerHTML = `
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #2d3748;">ÏãúÏä§ÌÖú Î©îÏãúÏßÄ</h3>
                        <div style="color: #16a34a; margin: 10px 0;">‚úì Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïó∞Í≤∞ ÏÑ±Í≥µ</div>
                        <div style="color: #16a34a; margin: 10px 0;">‚úì ÏøºÎ¶¨ Ïã§Ìñâ Ï§ÄÎπÑ ÏôÑÎ£å</div>
                    </div>
                `;
            } else if (tab === 'history') {
                resultInfo.classList.remove('show');
                let html = '<div style="padding: 20px;"><h3 style="margin-bottom: 15px; color: #2d3748;">ÏøºÎ¶¨ ÌûàÏä§ÌÜ†Î¶¨</h3>';
                
                if (queryHistory.length === 0) {
                    html += '<p style="color: #718096;">Ïã§ÌñâÎêú ÏøºÎ¶¨Í∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                } else {
                    html += '<table class="result-grid"><thead><tr>';
                    html += '<th>Ïã§Ìñâ ÏãúÍ∞Ñ</th><th>ÏøºÎ¶¨</th><th>Ìñâ Ïàò</th><th>ÏÜåÏöî ÏãúÍ∞Ñ</th>';
                    html += '</tr></thead><tbody>';
                    
                    queryHistory.slice().reverse().forEach(item => {
                        const shortQuery = item.query.length > 50 ? item.query.substring(0, 50) + '...' : item.query;
                        html += `<tr>
                            <td>${item.timestamp}</td>
                            <td>${shortQuery}</td>
                            <td>${item.rowCount}</td>
                            <td>${item.executionTime}ms</td>
                        </tr>`;
                    });
                    
                    html += '</tbody></table>';
                }
                html += '</div>';
                resultGrid.innerHTML = html;
            }
        }

        // ===== SQL Ìè¨Îß∑ÌåÖ =====
        function formatSQL() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            let query = editor.value;
            
            if (!query.trim()) {
                alert('Ìè¨Îß∑ÌåÖÌï† ÏøºÎ¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            
            query = query
                .replace(/\s+/g, ' ')
                .replace(/\s*,\s*/g, ',\n    ')
                .replace(/\bSELECT\b/gi, '\nSELECT\n    ')
                .replace(/\bFROM\b/gi, '\nFROM\n    ')
                .replace(/\bWHERE\b/gi, '\nWHERE\n    ')
                .replace(/\bAND\b/gi, '\n    AND ')
                .replace(/\bOR\b/gi, '\n    OR ')
                .replace(/\bJOIN\b/gi, '\nJOIN\n    ')
                .replace(/\bLEFT JOIN\b/gi, '\nLEFT JOIN\n    ')
                .replace(/\bRIGHT JOIN\b/gi, '\nRIGHT JOIN\n    ')
                .replace(/\bINNER JOIN\b/gi, '\nINNER JOIN\n    ')
                .replace(/\bON\b/gi, '\nON ')
                .replace(/\bGROUP BY\b/gi, '\nGROUP BY\n    ')
                .replace(/\bHAVING\b/gi, '\nHAVING\n    ')
                .replace(/\bORDER BY\b/gi, '\nORDER BY\n    ')
                .replace(/\bLIMIT\b/gi, '\nLIMIT ')
                .replace(/\bOFFSET\b/gi, '\nOFFSET ')
                .trim();
            
            editor.value = query;
            syncLineNumbers(activeTabId);
            updateCursorPosition();
            markTabAsUnsaved(activeTabId);
            
            updateStatus('statusMessage', 'ÏøºÎ¶¨Í∞Ä Ìè¨Îß∑ÌåÖÎêòÏóàÏäµÎãàÎã§.');
        }

        // ===== ÌååÏùº ÏûëÏóÖ =====
        function openQuery() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.sql,.txt';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        newQuery();
                        const editor = document.getElementById(`editor-${activeTabId}`);
                        editor.value = event.target.result;
                        tabs[activeTabId].name = file.name;
                        const tab = document.querySelector(`[data-tab-id="${activeTabId}"]`);
                        const nameSpan = tab.querySelector('.tab-name');
                        nameSpan.textContent = file.name;
                        syncLineNumbers(activeTabId);
                        updateCursorPosition();
                        // Ïä§ÌÅ¨Î°§ Í∞ïÏ†ú Ïû¨Í≥ÑÏÇ∞
                        forceEditorReflow(editor);
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function saveQuery() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            const content = editor.value;
            const fileName = tabs[activeTabId].name + '.sql';
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
            
            tabs[activeTabId].saved = true;
            const tab = document.querySelector(`[data-tab-id="${activeTabId}"]`);
            const nameSpan = tab.querySelector('.tab-name');
            nameSpan.textContent = nameSpan.textContent.replace(' *', '');
            
            updateStatus('statusMessage', 'ÌååÏùºÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
        }

        function exportResults() {
            const resultGrid = document.querySelector('.result-grid');
            
            if (!resultGrid) {
                alert('ÎÇ¥Î≥¥ÎÇº Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§. Î®ºÏ†Ä ÏøºÎ¶¨Î•º Ïã§ÌñâÌïòÏÑ∏Ïöî.');
                return;
            }
            
            let csv = '';
            
            const headers = Array.from(resultGrid.querySelectorAll('thead th')).map(th => th.textContent);
            csv += headers.join(',') + '\n';
            
            const rows = resultGrid.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const cells = Array.from(row.querySelectorAll('td')).map(td => {
                    let value = td.textContent;
                    if (value.includes(',') || value.includes('"') || value.includes('\n')) {
                        value = '"' + value.replace(/"/g, '""') + '"';
                    }
                    return value;
                });
                csv += cells.join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'query_results.csv';
            a.click();
            URL.revokeObjectURL(url);
            
            updateStatus('statusMessage', 'Í≤∞Í≥ºÍ∞Ä CSV ÌååÏùºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§.');
        }

        // ===== UI Ï†úÏñ¥ =====
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            const icon = document.getElementById('darkModeIcon');
            icon.textContent = isDarkMode ? 'light_mode' : 'dark_mode';
            updateStatus('statusMessage', isDarkMode ? 'Îã§ÌÅ¨Î™®Îìú ÌôúÏÑ±Ìôî' : 'ÎùºÏù¥Ìä∏Î™®Îìú ÌôúÏÑ±Ìôî');
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.style.display = sidebar.style.display === 'none' ? 'flex' : 'none';
        }

        function toggleProperties() {
            const properties = document.getElementById('propertiesPanel');
            properties.style.display = properties.style.display === 'none' ? 'flex' : 'none';
        }

        // ===== Ìä∏Î¶¨ Î∑∞ =====
        function toggleTreeItem(element) {
            element.classList.toggle('expanded');
            element.classList.toggle('collapsed');
            
            const children = element.nextElementSibling;
            if (children && children.classList.contains('tree-children')) {
                children.classList.toggle('show');
            }
        }

        function selectItem(element, itemName) {
            document.querySelectorAll('.tree-item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            
            updateStatus('statusMessage', `ÏÑ†ÌÉùÎê®: ${itemName}`);
        }

        function filterDatabaseTree(searchTerm) {
            const treeView = document.querySelector('.tree-view');
            if (!treeView) return;
            
            const items = treeView.querySelectorAll('.tree-item');
            
            searchTerm = searchTerm.toLowerCase().trim();
            
            if (!searchTerm) {
                items.forEach(item => {
                    item.style.display = '';
                });
                return;
            }
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const matches = text.includes(searchTerm);
                
                if (matches) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function clearSearch() {
            const searchInput = document.getElementById('dbSearchInput');
            if (searchInput) {
                searchInput.value = '';
                filterDatabaseTree('');
                searchInput.focus();
            }
        }

        // ===== ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà =====
        function showTableDesigner() {
            document.getElementById('tableDesignerModal').classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function addColumn() {
            const tbody = document.getElementById('columnDesigner');
            const newRow = tbody.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="column_name"></td>
                <td>
                    <select>
                        <option>INT</option>
                        <option>BIGINT</option>
                        <option>SMALLINT</option>
                        <option>TINYINT</option>
                        <option>VARCHAR</option>
                        <option>CHAR</option>
                        <option>TEXT</option>
                        <option>MEDIUMTEXT</option>
                        <option>LONGTEXT</option>
                        <option>DATE</option>
                        <option>DATETIME</option>
                        <option>TIMESTAMP</option>
                        <option>TIME</option>
                        <option>BOOLEAN</option>
                        <option>DECIMAL</option>
                        <option>FLOAT</option>
                        <option>DOUBLE</option>
                        <option>BLOB</option>
                        <option>JSON</option>
                    </select>
                </td>
                <td><input type="text" placeholder=""></td>
                <td style="text-align: center;"><input type="checkbox"></td>
                <td><input type="text" placeholder=""></td>
                <td style="text-align: center;"><input type="checkbox"></td>
            `;
        }

        function generateCreateTable() {
            const tableName = document.getElementById('tableName').value.trim();
            if (!tableName) {
                alert('ÌÖåÏù¥Î∏î Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                return;
            }
            
            const rows = document.getElementById('columnDesigner').rows;
            let columns = [];
            let primaryKeys = [];
            
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].cells;
                const colName = cells[0].querySelector('input').value.trim();
                const colType = cells[1].querySelector('select').value;
                const colLength = cells[2].querySelector('input').value.trim();
                const nullable = cells[3].querySelector('input').checked;
                const defaultVal = cells[4].querySelector('input').value.trim();
                const isPK = cells[5].querySelector('input').checked;
                
                if (!colName) continue;
                
                let columnDef = `    ${colName} ${colType}`;
                
                // Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖÎ≥Ñ Í∏∏Ïù¥ Ï≤òÎ¶¨
                if (colLength) {
                    if (colType === 'VARCHAR' || colType === 'CHAR') {
                        columnDef += `(${colLength})`;
                    } else if (colType === 'INT' || colType === 'BIGINT' || colType === 'SMALLINT' || colType === 'TINYINT') {
                        columnDef += `(${colLength})`;
                    } else if (colType === 'DECIMAL' || colType === 'NUMERIC' || colType === 'FLOAT' || colType === 'DOUBLE') {
                        columnDef += `(${colLength})`;
                    }
                }
                
                // NULL ÌóàÏö© Ïó¨Î∂Ä
                if (!nullable) {
                    columnDef += ' NOT NULL';
                }
                
                // Í∏∞Î≥∏Í∞í Ï≤òÎ¶¨ - Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖÏóê Îî∞Îùº Îî∞Ïò¥Ìëú Ï≤òÎ¶¨
                if (defaultVal) {
                    const numericTypes = ['INT', 'BIGINT', 'SMALLINT', 'TINYINT', 'DECIMAL', 'NUMERIC', 'FLOAT', 'DOUBLE'];
                    const booleanTypes = ['BOOLEAN', 'BOOL'];
                    
                    if (numericTypes.includes(colType)) {
                        // Ïà´Ïûê ÌÉÄÏûÖÏùÄ Îî∞Ïò¥Ìëú ÏóÜÏù¥
                        columnDef += ` DEFAULT ${defaultVal}`;
                    } else if (booleanTypes.includes(colType)) {
                        // BOOLEAN ÌÉÄÏûÖ Ï≤òÎ¶¨
                        const boolVal = defaultVal.toLowerCase();
                        if (boolVal === 'true' || boolVal === '1') {
                            columnDef += ' DEFAULT TRUE';
                        } else if (boolVal === 'false' || boolVal === '0') {
                            columnDef += ' DEFAULT FALSE';
                        } else {
                            columnDef += ` DEFAULT ${defaultVal}`;
                        }
                    } else if (defaultVal.toUpperCase() === 'NULL') {
                        // NULL Í∞í Ï≤òÎ¶¨
                        columnDef += ' DEFAULT NULL';
                    } else if (defaultVal.toUpperCase() === 'CURRENT_TIMESTAMP') {
                        // CURRENT_TIMESTAMP Ï≤òÎ¶¨
                        columnDef += ' DEFAULT CURRENT_TIMESTAMP';
                    } else {
                        // Î¨∏ÏûêÏó¥ ÌÉÄÏûÖÏùÄ Îî∞Ïò¥ÌëúÎ°ú Í∞êÏã∏Í∏∞
                        columnDef += ` DEFAULT '${defaultVal}'`;
                    }
                }
                
                // PRIMARY KEYÎäî ÏûêÎèôÏúºÎ°ú AUTO_INCREMENT Ï∂îÍ∞Ä (INT ÌÉÄÏûÖÏù∏ Í≤ΩÏö∞)
                if (isPK && (colType === 'INT' || colType === 'BIGINT')) {
                    columnDef += ' AUTO_INCREMENT';
                }
                
                columns.push(columnDef);
                
                if (isPK) {
                    primaryKeys.push(colName);
                }
            }
            
            if (columns.length === 0) {
                alert('ÏµúÏÜå ÌïòÎÇòÏùò Ïª¨ÎüºÏùÑ Ï†ïÏùòÌïòÏÑ∏Ïöî.');
                return;
            }
            
            let sql = `CREATE TABLE ${tableName} (\n`;
            sql += columns.join(',\n');
            
            if (primaryKeys.length > 0) {
                sql += `,\n    PRIMARY KEY (${primaryKeys.join(', ')})`;
            }
            
            sql += '\n);';
            
            if (!activeTabId) {
                newQuery();
            }
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            editor.value = sql;
            syncLineNumbers(activeTabId);
            updateCursorPosition();
            markTabAsUnsaved(activeTabId);
            
            closeModal('tableDesignerModal');
            updateStatus('statusMessage', 'CREATE TABLE Î¨∏Ïù¥ ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.');
        }

        // ===== Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ =====
        function showContextMenu(event) {
            event.preventDefault();
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = event.pageX + 'px';
            contextMenu.style.top = event.pageY + 'px';
        }

        document.addEventListener('click', function() {
            document.getElementById('contextMenu').style.display = 'none';
        });

        function commentCode() {
            if (!activeTabId) return;
            
            const editor = document.getElementById(`editor-${activeTabId}`);
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            
            if (start === end) {
                // ÌòÑÏû¨ ÎùºÏù∏ Ï£ºÏÑù Ï≤òÎ¶¨
                const text = editor.value;
                const lineStart = text.lastIndexOf('\n', start - 1) + 1;
                const lineEnd = text.indexOf('\n', start);
                const currentLine = text.substring(lineStart, lineEnd === -1 ? text.length : lineEnd);
                
                if (currentLine.trim().startsWith('--')) {
                    // Ï£ºÏÑù Ìï¥Ï†ú
                    const newLine = currentLine.replace(/^\s*--\s?/, '');
                    editor.value = text.substring(0, lineStart) + newLine + text.substring(lineEnd === -1 ? text.length : lineEnd);
                } else {
                    // Ï£ºÏÑù Ï∂îÍ∞Ä
                    editor.value = text.substring(0, lineStart) + '-- ' + currentLine + text.substring(lineEnd === -1 ? text.length : lineEnd);
                }
            } else {
                // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏ Ï£ºÏÑù Ï≤òÎ¶¨
                const selectedText = editor.value.substring(start, end);
                editor.value = editor.value.substring(0, start) + '/* ' + selectedText + ' */' + editor.value.substring(end);
            }
            
            syncLineNumbers(activeTabId);
            updateCursorPosition();
            markTabAsUnsaved(activeTabId);
        }

        // ===== ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ =====
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    newQuery();
                }
                else if (e.ctrlKey && e.key === 'o') {
                    e.preventDefault();
                    openQuery();
                }
                else if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    saveQuery();
                }
                else if (e.key === 'F5') {
                    e.preventDefault();
                    executeQuery();
                }
                else if (e.ctrlKey && e.shiftKey && e.key === 'F') {
                    e.preventDefault();
                    formatSQL();
                }
                else if (e.ctrlKey && e.shiftKey && e.key === 'V') {
                    e.preventDefault();
                    validateQuery();
                }
                else if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                    e.preventDefault();
                    clearEditor();
                }
                else if (e.ctrlKey && e.shiftKey && e.key === 'E') {
                    e.preventDefault();
                    exportResults();
                }
                else if (e.ctrlKey && e.key === '/') {
                    e.preventDefault();
                    commentCode();
                }
            });
        }

        // ===== ÎèÑÏõÄÎßê =====
        function showAbout() {
            alert('DateEye SQL Professional v1.0 Advanced Validation Engine\n\nÍ≥†Í∏â Í∏∞Îä•:\n‚Ä¢ SQL Gate/DBeaver ÏàòÏ§ÄÏùò Ï†ÑÎ¨∏Í∞ÄÍ∏â ÏøºÎ¶¨ Í≤ÄÏ¶ù\n‚Ä¢ ÌÜ†ÌÅ∞ Í∏∞Î∞ò Íµ¨Î¨∏ Î∂ÑÏÑù (Lexical Analysis)\n‚Ä¢ 12Í∞ú Ïπ¥ÌÖåÍ≥†Î¶¨, 50+ Í≤ÄÏ¶ù Í∑úÏπô\n‚Ä¢ ÏÑ±Îä• ÏµúÏ†ÅÌôî Ï†úÏïà (Ïù∏Îç±Ïä§, Ï°∞Ïù∏, ÏÑúÎ∏åÏøºÎ¶¨)\n‚Ä¢ Î≥¥Ïïà Ï∑®ÏïΩÏ†ê ÏûêÎèô ÌÉêÏßÄ (SQL Injection)\n‚Ä¢ Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Î∞è Ìï®Ïàò Ìò∏ÌôòÏÑ± Í≤ÄÏÇ¨\n‚Ä¢ ÎùºÏù∏ Î≤àÌò∏ ÌëúÏãú Î∞è Îã§ÌÅ¨Î™®Îìú ÏßÄÏõê\n\nÏ†úÏûë: DateEye Development Team');
        }

        // ===== ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ =====
        function updateStatus(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
            }
        }

        console.log('DateEye SQL Professional v1.0 - Advanced Validation Engine (SQL Gate/DBeaver Level)');
    
        // ===== Easy/Default UI Mode Toggle =====
        function applyUIMode(mode) {
            const body = document.body;
            const label = document.getElementById('modeToggleLabel');
            if (mode === 'easy') {
                body.classList.add('easy-mode');
                if (label) label.textContent = 'default mode';
            } else {
                body.classList.remove('easy-mode');
                if (label) label.textContent = 'easy mode';
            }
        }
        function toggleUIMode() {
            const current = localStorage.getItem('uiMode') || 'default';
            const next = current === 'easy' ? 'default' : 'easy';
            localStorage.setItem('uiMode', next);
            applyUIMode(next);
        }
        function markEasyHideTargets() {
            // 1) Menu-bar: hide Ìé∏Ïßë, ÎèÑÍµ¨, Î≥¥Í∏∞, ÎèÑÏõÄÎßê in Easy mode
            const menuItems = document.querySelectorAll('.menu-bar .menu-item');
            menuItems.forEach(mi => {
                const text = (mi.childNodes[0]?.textContent || mi.textContent || '').trim();
                if (['Ìé∏Ïßë', 'ÎèÑÍµ¨', 'Î≥¥Í∏∞', 'ÎèÑÏõÄÎßê'].includes(text)) {
                    mi.classList.add('easy-hide');
                }
            });
            // 2) Toolbar buttons: keep New/Open/Save/Execute visible; hide Format/Validate/Clear/Table Designer
            const toolbarButtons = document.querySelectorAll('.toolbar .toolbar-btn');
            toolbarButtons.forEach(btn => {
                const labelEl = btn.querySelector('span:nth-of-type(2)');
                const label = (labelEl ? labelEl.textContent : '').trim();
                if (['Ìè¨Îß∑','Í≤ÄÏ¶ù','ÏßÄÏö∞Í∏∞','ÌÖåÏù¥Î∏î ÎîîÏûêÏù¥ÎÑà'].includes(label)) {
                    btn.classList.add('easy-hide');
                }
                // tag execute for emphasis
                if (label === 'Ïã§Ìñâ') {
                    btn.id = 'executeBtn';
                }
            });
            // 3) Result tabs: hide messages/history in Easy mode
            document.querySelectorAll('.result-tab').forEach(tab => {
                const t = tab.textContent.trim();
                if (['Î©îÏãúÏßÄ','Ïã§Ìñâ Í∏∞Î°ù'].includes(t)) {
                    tab.classList.add('easy-hide');
                }
            });
            // 4) Properties panel (right): hide in Easy mode to declutter, but keep DOM for functionality
            const props = document.getElementById('propertiesPanel');
            if (props) props.classList.add('easy-hide');
        }
        // Hook into window.onload extension
        (function() {
            const _origOnLoad = window.onload;
            window.onload = function() {
                if (typeof _origOnLoad === 'function') { _origOnLoad(); }
                markEasyHideTargets();
                const saved = localStorage.getItem('uiMode') || 'default';
                applyUIMode(saved);
            };
        })();

    </script>
</body>
</html>
